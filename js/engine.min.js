var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(q){var e=0;return function(){return e<q.length?{done:!1,value:q[e++]}:{done:!0}}};$jscomp.arrayIterator=function(q){return{next:$jscomp.arrayIteratorImpl(q)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(q,e,Q){q!=Array.prototype&&q!=Object.prototype&&(q[e]=Q.value)};$jscomp.getGlobal=function(q){return"undefined"!=typeof window&&window===q?q:"undefined"!=typeof global&&null!=global?global:q};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(q,e){this.$jscomp$symbol$id_=q;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:e})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function q(Q){if(this instanceof q)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(Q||"")+"_"+e++,Q)}var e=0;return q}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var q=$jscomp.global.Symbol.iterator;q||(q=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[q]&&$jscomp.defineProperty(Array.prototype,q,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var q=$jscomp.global.Symbol.asyncIterator;q||(q=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(q){$jscomp.initSymbolIterator();q={next:q};q[$jscomp.global.Symbol.iterator]=function(){return this};return q};
(function(q,e){"object"===typeof exports&&"undefined"!==typeof module?e(exports,require("three"),require("hls.js")):"function"===typeof define&&define.amd?define(["exports","three","hls.js"],e):(q=q||self,e(q.PANOLENS={},q.THREE,q.Hls))})(this,function(q,e,Q){function Ba(g,d){var e=Object.keys(g);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(g);d&&(a=a.filter(function(a){return Object.getOwnPropertyDescriptor(g,a).enumerable}));e.push.apply(e,a)}return e}function u(g){for(var d=
1;d<arguments.length;d++){var e=null!=arguments[d]?arguments[d]:{};d%2?Ba(Object(e),!0).forEach(function(a){var b=e[a];a in g?Object.defineProperty(g,a,{value:b,enumerable:!0,configurable:!0,writable:!0}):g[a]=b}):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(e)):Ba(Object(e)).forEach(function(a){Object.defineProperty(g,a,Object.getOwnPropertyDescriptor(e,a))})}return g}function Ca(g,d,e,a,b,c,f){try{var h=g[c](f),B=h.value}catch(l){e(l);return}h.done?
d(B):Promise.resolve(B).then(a,b)}function Ua(g){return function(){var d=this,e=arguments;return new Promise(function(a,b){function c(d){Ca(h,a,b,c,f,"next",d)}function f(d){Ca(h,a,b,c,f,"throw",d)}var h=g.apply(d,e);c(void 0)})}}function C(g,d){if(!(g instanceof d))throw new TypeError("Cannot call a class as a function");}function Da(g,d){for(var e=0;e<d.length;e++){var a=d[e];a.enumerable=a.enumerable||!1;a.configurable=!0;"value"in a&&(a.writable=!0);Object.defineProperty(g,a.key,a)}}function F(g,
d,e){d&&Da(g.prototype,d);e&&Da(g,e);return g}function D(g,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function");g.prototype=Object.create(d&&d.prototype,{constructor:{value:g,writable:!0,configurable:!0}});d&&na(g,d)}function w(g){w=Object.setPrototypeOf?Object.getPrototypeOf:function(d){return d.__proto__||Object.getPrototypeOf(d)};return w(g)}function na(g,d){na=Object.setPrototypeOf||function(d,a){d.__proto__=a;return d};return na(g,d)}
function Va(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(g){return!1}}function r(g){if(void 0===g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g}function Ea(g,d){if(d&&("object"===typeof d||"function"===typeof d))return d;if(void 0!==d)throw new TypeError("Derived constructors may only return object or undefined");
return r(g)}function E(g){var d=Va();return function(){var e=w(g);if(d){var a=w(this).constructor;e=Reflect.construct(e,arguments,a)}else e=e.apply(this,arguments);return Ea(this,e)}}function A(g,d,e){A="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(a,b,c){for(;!Object.prototype.hasOwnProperty.call(a,b)&&(a=w(a),null!==a););if(a)return b=Object.getOwnPropertyDescriptor(a,b),b.get?b.get.call(c):b.value};return A(g,d,e||g)}function Wa(g,d){if(g){if("string"===typeof g)return Fa(g,d);
var e=Object.prototype.toString.call(g).slice(8,-1);"Object"===e&&g.constructor&&(e=g.constructor.name);if("Map"===e||"Set"===e)return Array.from(g);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Fa(g,d)}}function Fa(e,d){if(null==d||d>e.length)d=e.length;for(var g=0,a=Array(d);g<d;g++)a[g]=e[g];return a}function da(e,d){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var g="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!g){if(Array.isArray(e)||
(g=Wa(e))||d&&e&&"number"===typeof e.length){g&&(e=g);var a=0;d=function(){};return{s:d,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(a){throw a;},f:d}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var b=!0,c=!1,f;return{s:function(){g=g.call(e)},n:function(){var a=g.next();b=a.done;return a},e:function(a){c=!0;f=a},f:function(){try{b||null==g.return||g.return()}finally{if(c)throw f;
}}}}function oa(g,d){ea.uniforms.threshold.value=g.threshold;ea.uniforms.useTexture.value=g.useTexture;ea.uniforms.tMixTexture.value=d;return new e.ShaderMaterial(ea)}function pa(e,d,k,a,b){var c;function f(a,b){if(1<b.length)for(var c=0;c<b.length;c++)f(a,b[c]);else b.rotation.x+=Math.sign(a.y)*q}function h(a,c){if(1<c.length)for(var f=0;f<c.length;f++)h(a,c[f]);else t+=-Math.sign(a.x),t=t===b?0:t,t=0>t?b-1:t,C.dispatchEvent({type:"rotation",data:{currentSide:t}}),c.rotation.y+=-(Math.sign(a.x)*
Math.PI*2)/b}function g(a,c){if(1<c.length)for(var f=0;f<c.length;f++)g(a,c[f]);else t+=-Math.sign(a.x),t=t===b?0:t,t=0>t?b-1:t,C.dispatchEvent({type:"rotation",data:{currentSide:t}}),c.rotation.y+=-(Math.sign(a.x)*Math.PI*2)/b}function l(a,b){return a/b}function G(a,b,c,f,h,d){var e=6<arguments.length&&void 0!==arguments[6]?arguments[6]:!1,g=0;setTimeout(function Xa(){qa||(g++,t=(b+g)%f,y.rotation.y+=-(Math.sign(a)*Math.PI*2)/f,C.dispatchEvent({type:"rotation",data:{currentSide:t}}),e&&(g%=f),g===
c?C.dispatchEvent({type:"initial-auto-rotate-finished"}):setTimeout(Xa,d(h,c)))},d(h,c))}function n(a,b){if(I[b].enabled){if(1<y.length){for(var c=!0,f=0;f<y.length;f++){if(!c)return!1;I[b].enabled&&(c=!!(-1*I[b].from<y[f].rotation[b]+a&&y[f].rotation[b]+a<I[b].to))}return c}return!!(-1*I[b].from<y.rotation[b]+a&&y.rotation[b]+a<I[b].to)}return!0}function U(){r=!1;A=c=0}var p=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;this.setObjectToMove=function(a){y=a};this.setZoomSpeed=function(a){m=
a};this.setDistance=function(a,b){H=a;P=b};this.setRotationSpeed=function(a){};this.setRotationSpeedTouchDevices=function(a){q=a};this.enableVerticalRotation=function(){v=!0};this.disableVerticalRotation=function(){v=!1};this.enableHorizontalRotation=function(){x=!0};this.disableHorizontalRotation=function(){x=!1};this.setMaxVerticalRotationAngle=function(a,b){I.x.from=a;I.x.to=b;I.x.enabled=!0};this.setMaxHorizontalRotationAngle=function(a,b){I.y.from=a;I.y.to=b;I.y.enabled=!0};this.disableMaxHorizontalAngleRotation=
function(){I.y.enabled=!1};this.disableMaxVerticalAngleRotation=function(){I.x.enabled=!1};this.disableZoom=function(){w=!1};this.enableZoom=function(){w=!0};this.setIsZoomed=function(a){};d=void 0!==d?d:document;var I={x:{enabled:!1,from:Math.PI/8,to:Math.PI/8},y:{enabled:!1,from:Math.PI/4,to:Math.PI/4}},y=k,P=300,H=300,m=.5,q=2E-4,r=!1,qa=!1,v=!1,x=!0,w=!1;var A=c=0;var u=[],t=p,z={X:null,Y:null},C=this;this.animate=function(a){G(-1,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,b,b,3E3,
l,a)};d.addEventListener("mousedown",function(a){r=qa=!0;c=a.offsetX;A=a.offsetY},!1);d.addEventListener("mousemove",function(a){r&&x&&(h({x:a.offsetX-c,y:a.offsetY-A},y),c=a.offsetX,A=a.offsetY)},!1);d.addEventListener("mouseup",U,!1);d.addEventListener("mouseout",U,!1);d.addEventListener("touchstart",function(a){a.preventDefault();qa=!0;2===a.touches.length?(z.X=Math.abs(a.touches[0].clientX-a.touches[1].clientX),z.Y=Math.abs(a.touches[0].clientY-a.touches[1].clientY),u=Array(2)):(c=a.touches[0].pageX,
A=a.touches[0].pageY)},!1);d.addEventListener("touchmove",function(a){a.preventDefault();if(2===a.touches.length&&w){u=Array(2);var b=Math.abs(a.touches[0].clientX-a.touches[1].clientX);a=Math.abs(a.touches[0].clientY-a.touches[1].clientY);z&&0<z.X&&0<z.Y&&(b>z.X&&a>z.Y&&e.position.z>H?e.position.z-=m:b<z.X&&e.position.z<P&&a<z.Y&&(e.position.z+=m));z.X=b;z.Y=a}else if(0===u.length){z.X=null;z.Y=null;b={x:a.touches[0].pageX-c,y:a.touches[0].pageY-A};c=a.touches[0].pageX;A=a.touches[0].pageY;if(x&&
0!=b.x){if(!n(Math.sign(b.x)*q,"y"))return;g(b,y)}v&&0!=b.y&&n(Math.sign(b.y)*q,"x")&&f(b,y)}},!1);d.addEventListener("touchend",function(a){z.X=null;z.Y=null;0<u.length?u.pop():u=[];a.preventDefault();A=c=0},!1)}function fa(g,d,k){function a(){k.addEventListener("mousemove",c,!1);k.addEventListener("mousedown",f,!1);k.addEventListener("mouseup",h,!1);k.addEventListener("mouseleave",h,!1);k.addEventListener("touchmove",B,!1);k.addEventListener("touchstart",l,!1);k.addEventListener("touchend",G,!1)}
function b(){k.removeEventListener("mousemove",c,!1);k.removeEventListener("mousedown",f,!1);k.removeEventListener("mouseup",h,!1);k.removeEventListener("mouseleave",h,!1);k.removeEventListener("touchmove",B,!1);k.removeEventListener("touchstart",l,!1);k.removeEventListener("touchend",G,!1)}function c(a){a.preventDefault();var b=k.getBoundingClientRect();y.x=(a.clientX-b.left)/b.width*2-1;y.y=2*-((a.clientY-b.top)/b.height)+1;I.setFromCamera(y,d);m&&r.enabled?(I.ray.intersectPlane(p,H)&&m.position.copy(H.sub(P)),
r.dispatchEvent({type:"drag",object:m})):(I.setFromCamera(y,d),a=I.intersectObjects(g),0<a.length?(a=a[0].object,p.setFromNormalAndCoplanarPoint(d.getWorldDirection(p.normal),a.position),q!==a&&(r.dispatchEvent({type:"hoveron",object:a}),k.style.cursor="pointer",q=a)):null!==q&&(r.dispatchEvent({type:"hoveroff",object:q}),k.style.cursor="auto",q=null))}function f(a){a.preventDefault();I.setFromCamera(y,d);a=I.intersectObjects(g,n);0<a.length&&(m=a[0].object,I.ray.intersectPlane(p,H)&&P.copy(H).sub(m.position),
k.style.cursor="move",r.dispatchEvent({type:"dragstart",object:m}))}function h(a){a.preventDefault();m&&(r.dispatchEvent({type:"dragend",object:m}),m=null);k.style.cursor="auto"}function B(a){a.preventDefault();a=a.changedTouches[0];var b=k.getBoundingClientRect();y.x=(a.clientX-b.left)/b.width*2-1;y.y=2*-((a.clientY-b.top)/b.height)+1;I.setFromCamera(y,d);m&&r.enabled&&(I.ray.intersectPlane(p,H)&&m.position.copy(H.sub(P)),r.dispatchEvent({type:"drag",object:m}))}function l(a){a.preventDefault();
a=a.changedTouches[0];var b=k.getBoundingClientRect();y.x=(a.clientX-b.left)/b.width*2-1;y.y=2*-((a.clientY-b.top)/b.height)+1;I.setFromCamera(y,d);a=I.intersectObjects(g,n);0<a.length&&(m=a[0].object,p.setFromNormalAndCoplanarPoint(d.getWorldDirection(p.normal),m.position),I.ray.intersectPlane(p,H)&&P.copy(H).sub(m.position),k.style.cursor="move",r.dispatchEvent({type:"dragstart",object:m}))}function G(a){a.preventDefault();m&&(r.dispatchEvent({type:"dragend",object:m}),m=null);k.style.cursor="auto"}
var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:!1;if(g.isCamera){console.warn("THREE.DragControls: Constructor now expects ( objects, camera, domElement )");var U=g;g=d;d=U}var p=new e.Plane,I=new e.Raycaster,y=new e.Vector2,P=new e.Vector3,H=new e.Vector3,m=null,q=null,r=this;a();this.enabled=!0;this.activate=a;this.deactivate=b;this.dispose=function(){b()};this.setObjects=function(){console.error("THREE.DragControls: setObjects() has been removed.")};this.on=function(a,b){console.warn("THREE.DragControls: on() has been deprecated. Use addEventListener() instead.");
r.addEventListener(a,b)};this.off=function(a,b){console.warn("THREE.DragControls: off() has been deprecated. Use removeEventListener() instead.");r.removeEventListener(a,b)};this.notify=function(a){console.error("THREE.DragControls: notify() has been deprecated. Use dispatchEvent() instead.");r.dispatchEvent({type:a})}}function Y(g,d){function k(){return 2*Math.PI/60/60*p.autoRotateSpeed}function a(a){if(!1!==p.enabled){a.preventDefault();if(a.button===p.mouseButtons.ORBIT){if(!0===p.noRotate)return;
M=K.ROTATE;m.set(a.clientX,a.clientY)}else if(a.button===p.mouseButtons.ZOOM){if(!0===p.noZoom)return;M=K.DOLLY;z.set(a.clientX,a.clientY)}else if(a.button===p.mouseButtons.PAN){if(!0===p.noPan)return;M=K.PAN;H.set(a.clientX,a.clientY)}M!==K.NONE&&(document.addEventListener("mousemove",b,!1),document.addEventListener("mouseup",c,!1),p.dispatchEvent(R))}}function b(a){if(!1!==p.enabled){a.preventDefault();var b=p.domElement===document?p.domElement.body:p.domElement;M===K.ROTATE?!0!==p.noRotate&&(y.set(a.clientX,
a.clientY),P.subVectors(y,m),0==m.x&&0==m.y?(m.set(y.x,y.y),P.subVectors(y,m)):(p.rotateLeft(2*Math.PI*P.x/b.clientHeight*p.rotateSpeed),p.rotateUp(2*Math.PI*P.y/b.clientHeight*p.rotateSpeed),m.copy(y))):M===K.DOLLY?!0!==p.noZoom&&(x.set(a.clientX,a.clientY),A.subVectors(x,z),0<A.y?p.dollyIn():0>A.y&&p.dollyOut(),z.copy(x)):M===K.PAN&&!0!==p.noPan&&(q.set(a.clientX,a.clientY),r.subVectors(q,H),p.pan(r.x,r.y),H.copy(q))}}function c(){!1!==p.enabled&&(document.removeEventListener("mousemove",b,!1),
document.removeEventListener("mouseup",c,!1),p.dispatchEvent(S),M=K.NONE)}function f(a){if(!1!==p.enabled&&!0!==p.noZoom&&M===K.NONE){a.preventDefault();a.stopPropagation();var b=0;void 0!==a.wheelDelta?b=a.wheelDelta:void 0!==a.detail&&(b=-a.detail);0<b?(p.object.fov=p.object.fov<p.maxFov?p.object.fov+1:p.maxFov,p.object.updateProjectionMatrix()):0>b&&(p.object.fov=p.object.fov>p.minFov?p.object.fov-1:p.minFov,p.object.updateProjectionMatrix());p.object.fov<=p.maxFov&&(p.dispatchEvent(N),p.dispatchEvent(R),
p.dispatchEvent(S),p.dispatchEvent(T))}}function h(a){}function B(a){if(!1!==p.enabled&&!0!==p.noKeys&&!0!==p.noRotate){p.autoRotate&&(clearTimeout(this.autoRotateRequestId),p.autoRotate=!1,this.autoRotateRequestId=window.setTimeout(function(){p.autoRotate=!0},5E3));var b=p.momentum&&!p.autoRotate?p.momentumKeydownFactor*p.momentumFactor:p.momentumKeydownFactor;switch(a.keyCode){case p.keys.UP:p.rotateUp(p.rotateSpeed*b);break;case p.keys.BOTTOM:p.rotateUp(-p.rotateSpeed*b);break;case p.keys.LEFT:p.rotateLeft(p.rotateSpeed*
b);break;case p.keys.RIGHT:p.rotateLeft(-p.rotateSpeed*b)}}}function l(a){if(!1!==p.enabled){switch(a.touches.length){case 1:if(!0===p.noRotate)return;M=K.TOUCH_ROTATE;m.set(a.touches[0].pageX,a.touches[0].pageY);break;case 2:if(!0===p.noZoom)return;M=K.TOUCH_DOLLY;var b=a.touches[0].pageX-a.touches[1].pageX;a=a.touches[0].pageY-a.touches[1].pageY;z.set(0,Math.sqrt(b*b+a*a));break;case 3:if(!0===p.noPan)return;M=K.TOUCH_PAN;H.set(a.touches[0].pageX,a.touches[0].pageY);break;default:M=K.NONE}M!==K.NONE&&
p.dispatchEvent(R)}}function G(a){if(!1!==p.enabled){a.preventDefault();a.stopPropagation();var b=p.domElement===document?p.domElement.body:p.domElement;switch(a.touches.length){case 1:var c=.38*p.rotateSpeed;if(!0===p.noRotate)break;if(M!==K.TOUCH_ROTATE)break;y.set(a.touches[0].pageX,a.touches[0].pageY);P.subVectors(y,m);p.rotateLeft(2*Math.PI*P.x/b.clientHeight*c);p.rotateUp(2*Math.PI*P.y/b.clientHeight*c);m.copy(y);break;case 2:if(!0===p.noZoom)break;if(M!==K.TOUCH_DOLLY)break;b=a.touches[0].pageX-
a.touches[1].pageX;a=a.touches[0].pageY-a.touches[1].pageY;x.set(0,Math.sqrt(b*b+a*a));A.subVectors(x,z);0>A.y?(p.object.fov=p.object.fov<p.maxFov?p.object.fov+1:p.maxFov,p.object.updateProjectionMatrix()):0<A.y&&(p.object.fov=p.object.fov>p.minFov?p.object.fov-1:p.minFov,p.object.updateProjectionMatrix());z.copy(x);p.dispatchEvent(N);p.dispatchEvent(T);break;case 3:if(!0===p.noPan)break;if(M!==K.TOUCH_PAN)break;q.set(a.touches[0].pageX,a.touches[0].pageY);r.subVectors(q,H);p.pan(r.x,r.y);H.copy(q);
break;default:M=K.NONE}}}function n(){!1!==p.enabled&&(p.dispatchEvent(S),M=K.NONE)}var U=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{panSpeed:1};this.object=g;this.domElement=void 0!==d?d:document;this.panSpeed=U.panSpeed;this.frameId=null;this.enabled=!0;this.center=this.target=new e.Vector3;this.noZoom=!1;this.zoomSpeed=1;this.minDistance=0;this.maxDistance=Infinity;this.minZoom=0;this.maxZoom=Infinity;this.noRotate=!1;this.rotateSpeed=-.15;this.noPan=!0;this.keyPanSpeed=7;this.autoRotate=
!1;this.autoRotateSpeed=2;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.momentumKeydownFactor=.05;this.speedLimit=.04;this.publicSphericalDelta=new e.Spherical;this.momentum=!0;this.momentumFactor=7.5;this.enableDamping=!0;this.dampingFactor=.03;this.minFov=30;this.maxFov=120;this.minAzimuthAngle=-Infinity;this.maxAzimuthAngle=Infinity;this.noKeys=!1;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};this.mouseButtons={ORBIT:e.MOUSE.LEFT,ZOOM:e.MOUSE.MIDDLE,PAN:e.MOUSE.RIGHT};var p=this,m=new e.Vector2,
y=new e.Vector2,P=new e.Vector2,H=new e.Vector2,q=new e.Vector2,r=new e.Vector2,v=new e.Vector3,t=new e.Vector3,z=new e.Vector2,x=new e.Vector2,A=new e.Vector2,w=0,u=0,C=0,D=0,E=1,F=new e.Vector3,J=new e.Vector3,L=new e.Quaternion,K={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},M=K.NONE;this.target0=this.target.clone();this.position0=this.object.position.clone();this.zoom0=this.object.zoom;var O=(new e.Quaternion).setFromUnitVectors(g.up,new e.Vector3(0,1,0)),Q=O.clone().invert(),
N={type:"change"},R={type:"start"},S={type:"end"},T={type:"fov"};this.setLastQuaternion=function(a){L.copy(a);p.object.quaternion.copy(a)};this.getLastPosition=function(){return J};this.rotateLeft=function(a){void 0===a&&(a=k());a=this.momentum&&!this.autoRotate?a/=this.momentumFactor:a;D-=a};this.rotateUp=function(a){void 0===a&&(a=k());a=this.momentum&&!this.autoRotate?a/=this.momentumFactor:a;C-=a};this.rotateLeftStatic=function(a){this.enableDamping=!1;D-=a;this.update();this.enableDamping=!0};
this.rotateUpStatic=function(a){this.enableDamping=!1;C-=a;this.update();this.enableDamping=!0};this.centerTo=function(a,b){var c=p.enableDamping;p.enableDamping=!1;var f=this.object.position;t.copy(f).sub(this.target);t.applyQuaternion(O);w=Math.atan2(t.x,t.z);u=Math.atan2(Math.sqrt(t.x*t.x+t.z*t.z),t.y);this.autoRotate&&M===K.NONE&&this.rotateLeft(k());w=a;u=b;p.publicSphericalDelta.data={theta:w};w=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,w));u=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,
u));u=Math.max(1E-7,Math.min(Math.PI-1E-7,u));a=t.length()*E;a=Math.max(this.minDistance,Math.min(this.maxDistance,a));this.target.add(F);t.x=a*Math.sin(u)*Math.sin(w);t.y=a*Math.cos(u);t.z=a*Math.sin(u)*Math.cos(w);t.applyQuaternion(Q);f.copy(this.target).add(t);this.object.lookAt(this.target);E=1;F.set(0,0,0);if(1E-7<J.distanceToSquared(this.object.position)||1E-7<8*(1-L.dot(this.object.quaternion)))this.dispatchEvent(N),J.copy(this.object.position),L.copy(this.object.quaternion);p.enableDamping=
c};this.getRotations=function(){return{h:w,v:u}};this.panLeft=function(a){var b=this.object.matrix.elements;v.set(b[0],b[1],b[2]);v.multiplyScalar(-a);F.add(v)};this.panUp=function(a){var b=this.object.matrix.elements;v.set(b[4],b[5],b[6]);v.multiplyScalar(a);F.add(v)};this.pan=function(a,b){var c=p.domElement===document?p.domElement.body:p.domElement;if(p.object instanceof e.PerspectiveCamera){var f=p.object.position.clone().sub(p.target).length();f*=Math.tan(p.object.fov/2*Math.PI/180);p.panLeft(2*
this.panSpeed*a*f/c.clientHeight);p.panUp(2*this.panSpeed*b*f/c.clientHeight)}else p.object instanceof e.OrthographicCamera?(p.panLeft(a*(p.object.right-p.object.left)/c.clientWidth),p.panUp(b*(p.object.top-p.object.bottom)/c.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")};this.dollyIn=function(a){void 0===a&&(a=Math.pow(.95,p.zoomSpeed));p.object instanceof e.PerspectiveCamera?E/=a:p.object instanceof e.OrthographicCamera?(p.object.zoom=
Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*a)),p.object.updateProjectionMatrix(),p.dispatchEvent(N)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")};this.dollyOut=function(a){void 0===a&&(a=Math.pow(.95,p.zoomSpeed));p.object instanceof e.PerspectiveCamera?E*=a:p.object instanceof e.OrthographicCamera?(p.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/a)),p.object.updateProjectionMatrix(),p.dispatchEvent(N)):
console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")};this.update=function(a){var b=this.object.position;t.copy(b).sub(this.target);t.applyQuaternion(O);w=Math.atan2(t.x,t.z);u=Math.atan2(Math.sqrt(t.x*t.x+t.z*t.z),t.y);this.autoRotate&&M===K.NONE&&this.rotateLeft(k());!0===this.enableDamping&&(D=e.Math.clamp(D,-this.speedLimit,this.speedLimit),C=e.Math.clamp(C,-this.speedLimit,this.speedLimit));w+=D;u+=C;p.publicSphericalDelta.data={theta:w};w=Math.max(this.minAzimuthAngle,
Math.min(this.maxAzimuthAngle,w));u=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,u));u=Math.max(1E-7,Math.min(Math.PI-1E-7,u));var c=t.length()*E;c=Math.max(this.minDistance,Math.min(this.maxDistance,c));this.target.add(F);t.x=c*Math.sin(u)*Math.sin(w);t.y=c*Math.cos(u);t.z=c*Math.sin(u)*Math.cos(w);t.applyQuaternion(Q);b.copy(this.target).add(t);this.object.lookAt(this.target);this.autoRotate||!0!==this.enableDamping||(!this.momentum||M!==K.ROTATE&&M!==K.TOUCH_ROTATE)&&M!==K.NONE?C=D=
0:(D*=1-this.dampingFactor,C*=1-this.dampingFactor);E=1;F.set(0,0,0);if(1E-7<J.distanceToSquared(this.object.position)||1E-7<8*(1-L.dot(this.object.quaternion)))!0!==a&&this.dispatchEvent(N),J.copy(this.object.position),L.copy(this.object.quaternion)};this.reset=function(){M=K.NONE;this.target.copy(this.target0);this.object.position.copy(this.position0);this.object.zoom=this.zoom0;this.object.updateProjectionMatrix();this.dispatchEvent(N);this.update()};this.getPolarAngle=function(){return u};this.getAzimuthalAngle=
function(){return w};this.dispose=function(){this.domElement.removeEventListener("mousedown",a,{passive:!1});this.domElement.removeEventListener("mousewheel",f,{passive:!1});this.domElement.removeEventListener("DOMMouseScroll",f,{passive:!1});this.domElement.removeEventListener("touchstart",l,{passive:!1});this.domElement.removeEventListener("touchend",n,{passive:!1});this.domElement.removeEventListener("touchmove",G,{passive:!1});window.removeEventListener("keyup",h,{passive:!1});window.removeEventListener("keydown",
B,{passive:!1});document.removeEventListener("mousemove",b,{passive:!1});document.removeEventListener("mouseup",c,{passive:!1})};this.domElement.addEventListener("mousedown",a,{passive:!1});this.domElement.addEventListener("mousewheel",f,{passive:!1});this.domElement.addEventListener("DOMMouseScroll",f,{passive:!1});this.domElement.addEventListener("touchstart",l,{passive:!1});this.domElement.addEventListener("touchend",n,{passive:!1});this.domElement.addEventListener("touchmove",G,{passive:!1});
window.addEventListener("keyup",h,{passive:!1});window.addEventListener("keydown",B,{passive:!1});this.update()}function ra(g,d){var k=this,a=0,b=0,c=0,f=0;this.camera=g;this.camera.rotation.reorder("YXZ");this.domElement=void 0!==d?d:document;this.enabled=!0;this.deviceOrientation={alpha:null,beta:null,gamma:null};this.initialViewOffsetAngle=this.alphaOffsetAngle=this.alpha=this.screenOrientation=0;var h=function(a){null==k.deviceOrientation.alpha&&a&&a.alpha&&(k.initialViewOffsetAngle=e.Math.degToRad(a.alpha));
k.enabled&&(k.deviceOrientation=a)},B=function(){k.screenOrientation=window.orientation||0},l=function(a){k.enabled&&(a.preventDefault(),a.stopPropagation(),c=a.touches[0].pageX,f=a.touches[0].pageY)},G=function(h){k.enabled&&(h.preventDefault(),h.stopPropagation(),a+=e.Math.degToRad((h.touches[0].pageX-c)/4),b+=e.Math.degToRad((f-h.touches[0].pageY)/4),k.updateAlphaOffsetAngle(a),c=h.touches[0].pageX,f=h.touches[0].pageY)};this.connect=function(){B();window.addEventListener("orientationchange",B,
{passive:!0});window.addEventListener("deviceorientation",h,{passive:!0});window.addEventListener("deviceorientation",this.update.bind(this),{passive:!0});k.domElement.addEventListener("touchstart",l,{passive:!1});k.domElement.addEventListener("touchmove",G,{passive:!1});k.enabled=!0};this.disconnect=function(){window.removeEventListener("orientationchange",B,{passive:!0});window.removeEventListener("deviceorientation",h,{passive:!0});window.removeEventListener("deviceorientation",this.update.bind(this),
{passive:!0});k.domElement.removeEventListener("touchstart",l,{passive:!1});k.domElement.removeEventListener("touchmove",G,{passive:!1});k.enabled=!1};this.update=function(a){if(!1!==k.enabled){a=null!=k.deviceOrientation.alpha?e.Math.degToRad(k.deviceOrientation.alpha)+k.alphaOffsetAngle-k.initialViewOffsetAngle:k.alphaOffsetAngle;var c=null!=k.deviceOrientation.beta?e.Math.degToRad(k.deviceOrientation.beta):1.6,f=null!=k.deviceOrientation.gamma?e.Math.degToRad(k.deviceOrientation.gamma):0,h=k.screenOrientation?
e.Math.degToRad(k.screenOrientation):0,d=k.camera.quaternion,g=new e.Vector3(0,0,1),B=new e.Euler,l=new e.Quaternion,n=new e.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),G=new e.Quaternion,m=new e.Quaternion;if(0==k.screenOrientation){var q=new e.Vector3(1,0,0);G.setFromAxisAngle(q,-b)}else 180==k.screenOrientation?(q=new e.Vector3(1,0,0),G.setFromAxisAngle(q,b)):90==k.screenOrientation?(q=new e.Vector3(0,1,0),G.setFromAxisAngle(q,b)):-90==k.screenOrientation&&(q=new e.Vector3(0,1,0),G.setFromAxisAngle(q,
-b));n.multiply(G);n.multiply(m);B.set(c,a,-f,"YXZ");d.setFromEuler(B);d.multiply(n);d.multiply(l.setFromAxisAngle(g,-h));k.alpha=a}};this.updateAlphaOffsetAngle=function(b){this.alphaOffsetAngle=b;0==a&&(a=b);this.update()};this.getRotations=function(){return{h:k.alpha,v:0}};this.dispose=function(){this.disconnect()};this.connect()}function ha(){var g=0<arguments.length&&void 0!==arguments[0]?arguments[0]:.064;this.format=null;this.eyeSep=g;this.loffset=new e.Vector2;this.roffset=new e.Vector2}function Ya(g){var d=
new e.OrthographicCamera(-1,1,1,-1,0,1),k=new e.Scene,a=new e.StereoCamera;a.aspect=.5;var b=new e.WebGLRenderTarget(512,512,{minFilter:e.LinearFilter,magFilter:e.NearestFilter,format:e.RGBAFormat});b.scissorTest=!0;b.texture.generateMipmaps=!1;var c=new e.Vector2(.441,.156),f=(new e.PlaneBufferGeometry(1,1,10,20)).deleteAttribute("normal").toNonIndexed(),h=f.attributes.position.array,B=f.attributes.uv.array;f.attributes.position.count*=2;f.attributes.uv.count*=2;var l=new Float32Array(2*h.length);
l.set(h);l.set(h,h.length);var G=new Float32Array(2*B.length);G.set(B);G.set(B,B.length);B=new e.Vector2;h=h.length/3;for(var n=0,U=l.length/3;n<U;n++){B.x=l[3*n];B.y=l[3*n+1];var p=B.dot(B);p=1.5+(c.x+c.y*p)*p;var m=n<h?0:1;l[3*n]=B.x/p*1.5-.5+m;l[3*n+1]=B.y/p*3;G[2*n]=.5*(G[2*n]+m)}f.attributes.position.array=l;f.attributes.uv.array=G;c=new e.MeshBasicMaterial({map:b.texture});f=new e.Mesh(f,c);k.add(f);this.setEyeSeparation=function(b){a.eyeSep=b};this.setSize=function(a,c){g.setSize(a,c);var f=
g.getPixelRatio();b.setSize(a*f,c*f)};this.render=function(c,f,h,e,B){var l=h instanceof Za||h instanceof $a;c.updateMatrixWorld();l&&this.setEyeSeparation(h.stereo.eyeSep);null===f.parent&&f.updateMatrixWorld();a.update(f);f=b.width/2;var n=b.height;g.autoClear&&g.clear();l&&h.updateTextureToLeft();b.scissor.set(0,0,f,n);b.viewport.set(0,0,f,n);g.setRenderTarget(b);g.render(c,a.cameraL);g.clearDepth();l&&h.updateTextureToRight();b.scissor.set(f,0,f,n);b.viewport.set(f,0,f,n);g.setRenderTarget(b);
g.render(c,a.cameraR);g.clearDepth();g.setRenderTarget(e?B:null);g.render(k,d)}}function ab(g){this.render=function(d,k,a,b){var c=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null;if(a.material){var f=(5<arguments.length?arguments[5]:void 0).scissorX;b?(c.scissorTest=!0,c.scissor=new e.Vector4(f,0,window.innerWidth,window.innerHeight),a.material.uniforms.mixRatio.value=0,g.render(d,k),g.clear(),g.render(d,k),g.setRenderTarget(c),c.scissorTest=!0,c.scissor=new e.Vector4(0,0,f,window.innerHeight),
a.material.uniforms.mixRatio.value=1,g.clear(),g.render(d,k),c.scissorTest=!1,g.setScissorTest(!1)):(g.setRenderTarget(null),g.setScissorTest(!0),g.setScissor(new e.Vector4(f,0,window.innerWidth,window.innerHeight)),a.material.uniforms.mixRatio.value=1,g.clear(),g.render(d,k),g.setScissorTest(!0),g.setScissor(new e.Vector4(0,0,f,window.innerHeight)),a.material.uniforms.mixRatio.value=0,g.clear(),g.render(d,k))}};this.setSize=function(d,e){return null}}var x="default"in e?e["default"]:e;Q=Q&&Object.prototype.hasOwnProperty.call(Q,
"default")?Q["default"]:Q;var bb="^0.134.0".replace(/[^0-9.]/g,""),N={ORBIT:0,DEVICEORIENTATION:1,OBJECT:2,DRAG:3},z={UNKNOWN:0,NORMAL:1,CARDBOARD:2,STEREO:3,SIDE_BY_SIDE:4},X={TAB:0,SBS:1},Z={X:0,Y:-200,Z:0},R={DEFAULT:"default",POINTER:"pointer",GRAB:"-webkit-grab",CROSSHAIR:"crosshair"},sa={FLOOR:"floor_ring_cursor"},T={DEFAULT:"default",COLOR:"color",BLUR:"blur"},m={BASIC:"basic_panorama",CUBE:"cube_panorama",DOLLHOUSE:"dollhouse",IMAGE_LITTLE_PLANET:"image_little_planet",IMAGE:"image_panorama",
LITTLE_PLANET:"little_planet",PANORAMA:"panorama",SLIDER:"slider_panorama",SPIN:"spin_panorama",STEREO_IMAGE:"stereo_image",STEREO_VIDEO_PANORAMA:"stereo_video_panorama",VIDEO:"video_panorama",VIDEO_2D:"video_2d_panorama",PROGRESSVIE_IMAGE:"progressive_image_panorama",SIDE_BY_SIDE:"side_by_side",SIDE_BY_SIDE_2D:"side_by_side_2d"},t={DOLLSPOT:"dollspot",FLOOR_RING_INFOSPOT:"floor_ring_infospot",INFOSPOT:"infospot",HOTSPOT:"toScene",NADIR:"nadir",SPOT_MODEL:"spot_model"},V={FLOOR_PLANE:"floor_plane",
SPOT_SPHERE:"spot_sphere"},ta={VIDEO_SOUND_BUTTON:"video-sound__button"},L={Info:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAABAAAAAQADq8/hgAAADBklEQVR42u2bP08UQRiHnzFaSYCI/xoksdBIqGwIiYWRUBISExpCQ0ej38FWOmlIKKhoMPEbaCxsrrHiYrQgOSlQEaICrT+LHSPZzNzt3s3c3Hn7lHvLzvv82L2dm30XKioqKgYY062BJF0HpoA7wARwBbhsPz4DjoEG8AnYNcZ8Sx1Op8IXJM1KWpdUV3nq9m9nJV1I7VNGfEzSM0mNNqR9NOwxx1L7NRMflbQm6SSgeJ4TO8Zoat+8/LKkg4jieQ4kLaf2RtKwpJ0uiufZkTScSn5S0l5C+b/sSZrstvyMpKPU5uc4kjTTjkvpeYCkaeA1/+7hvcIZMGuMqUULQNIU8Aa4ltrWwyHwyBizGzwASSPAe+B2assW7AH3jTE/i+xcZoa12Qfy2Bo3i+5cKABl99zF1GYlWFTBeULLS0DZrOsDcDNggTXgc27bLWA64BhfgHvGmB8dHUXZ1DM0S45xliKMs9bKr+klIOkqsBrwv9JtVq1DewEAT4Ch1BYdMGQdygeg7Df4SmqDAKyoyXpCszPgITCeuvoAjFuX0gE8jljUdv7bCtiOOJ7XpdUZ8L/gdXHOA5QtYH5NXXVgbrgWWn1nwFTqaiPgdPIFcDd1tRFwOl307DwRuZgXwLvctgfA04hjOp18AcReZ6sZY16e3yDpUuQxnU6+S2AkcjEpcDr1zxOXSPgCKLSa0mc4nXwB/EpdbQScTr4AGqmrjYDTyRfAx9TVRsDp5Aug8LJyH+F0cgZg58z11BUHpO5ruGh2G3ybuuqAeF2aBfAqddUB8bq0OgP2U1cegH3aOQOMMb+BrdTVB2DLupQLwLIOnKY26IBT6+ClaQDGmO/ARmqLDtiwDn7HVkcY+EdjNoTlCI+tYhO2iUppm6HKslPUq2qQKHpUe8AFsjaUXuUQWCgqXyoAG8IuME/WkNRrnAHzZfqDSgdgQ6gBc2Td3b3CMTBXtkOsIzTIjZLnQhjcVtlcEIPZLJ0LoVvt8s/Va+3yuSAG84UJRxB98cpM9dJURUVFxSDzBxKde4Lk3/h2AAAAAElFTkSuQmCC",
Check:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTIxLDdMOSwxOUwzLjUsMTMuNUw0LjkxLDEyLjA5TDksMTYuMTdMMTkuNTksNS41OUwyMSw3WiIgLz48L3N2Zz4=",
WhiteTile:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIABAMAAAAGVsnJAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAB1WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOkNvbXByZXNzaW9uPjE8L3RpZmY6Q29tcHJlc3Npb24+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOlBob3RvbWV0cmljSW50ZXJwcmV0YXRpb24+MjwvdGlmZjpQaG90b21ldHJpY0ludGVycHJldGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KAtiABQAAACRQTFRFAAAAAAAABgYGBwcHHh4eKysrx8fHy8vLzMzM7OzsAAAABgYG+q7SZgAAAAp0Uk5TAP7+/v7+/v7+/iJx/a8AAAOwSURBVHja7d0hbsNAEAVQo6SFI6XEcALDcgNLvUBvEBQVhpkWVYWlhSsVFS7t5QIshRt695lEASZP+8c7a1kzDL1fz+/zyuvzp6FbvoddrL6uDd1yGZ5eXldeb18N3fIx7A+58prmhm65DfvDcd0952lu6JabFbD/zVprZj1lzcys+fj9z8xTZtbT8rv8yWlu6BYAIgAAAAAAAAAAAABAM6QXEAEAAAAAAAAAgJ2gnaAIiIA3Q2qAGgAAAAAAAAAAAAAAAAAAAAAAAAAAQJsADkVFAAAAAAA8Bj0GRUAEREAEREAEREAEREAEAAAAAAAAAAB2gnaCIiACPplRA9QANUAERAAAAEVQERQBERCBVlfAcZ3aeZobusUKMGBhV6KUElHGKBERJR6/fxExRkQZl9/lT8S1oVsuhqyYMmPKjCkzvfcCpsxohrwY0Q06EAEAAAAAAAAAAACgGdILiAAAAAAAAAAAwE7QTlAERMCbITVADQAAAAAAAAAAAAAAAAAAAAAAAAAAwKmwQ1ERAAAAAACPQY9BERABERABERABERABERABAAAAAAAAAICdoJ2gCIiAT2bUADVADRABEQAAQBFUBEVABERgEyvAlJm+V4ApM6bMmDJjyowpM6bMdN0LmDKjGfJiRDfoQAQAAAAAAAAAAACAZkgvIAIAAAAAAAAAADtBO0EREAFvhtQANQAAAAAAAAAAAAAAAAAAAAAAAAAAAKfCDkVFAAAAAAA8Bj0GRUAEREAEREAEREAEREAEAAAAAAAAAAB2gnaCIiACPplRA9QANUAERAAAAEVQERQBERCBTawAU2b6XgGmzJgyY8qMKTOmzJgy03UvYMqMZsiLEd2gAxEAAAAAAAAAAAAAmiG9gAgAAAAAAAAAAOwE7QRFQAS8GVID1AAAAAAAAAAAAAAAAAAAAAAAAAAAAJwKOxQVAQAAAADwGPQYFAEREAEREAEREAEREAERAAAAAAAAAADYCdoJioAI+GRGDVAD1AAREAEAABRBRVAEREAENrECTJnpewWYMmPKjCkzpsyYMmPKTNe9gCkzmiEvRnSDDkQAAAAAAAAAAAAAaIb0AiIAAAAAAAAAALATtBMUARHwZkgNUAMAAAAAAAAAAAAAAAAAAAAAAAAAAHAq7FBUBAAAAADAY9BjUAREQAREQAREQAREQAREAAAAAAAAAABgJ2gnKAIi4JMZNUANUANEQAQAAFAEFUEREAER2MQKMGWm7xVgyowpM50PWen9ugNGXz1XaocAFgAAAABJRU5ErkJggg==",
ViewIndicator:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBpZD0idmlldy1pbmRpY2F0b3IiIGhlaWdodD0iMzAiIHdpZHRoPSIzMCIgdmlld0JveD0iLTIuNSAtMSAzMCAzMCI+Cgk8c3R5bGUgdHlwZT0idGV4dC9jc3MiPi5zdDB7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLW1pdGVybGltaXQ6MTA7ZmlsbDpub25lO30uc3Qxe3N0cm9rZS13aWR0aDo2O3N0cm9rZS1taXRlcmxpbWl0OjEwO30KCTwvc3R5bGU+Cgk8Zz4KCQk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNIDEyLjUgMCBBIDEyLjUgMTIuNSAwIDAgMCAtMTIuNSAwIEEgMTIuNSAxMi41IDAgMCAwIDEyLjUgMCIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSwxMywxNS41KSI+PC9wYXRoPgoJCTxwYXRoIGNsYXNzPSJzdDIiIGQ9Ik0gMTMgMCBMIDEwIDIgTCAxNiAyIFoiPjwvcGF0aD4KCQk8cGF0aCBjbGFzcz0ic3QyIiBkPSJNIDIgMCBBIDIgMiAwIDAgMCAtMiAwIEEgMiAyIDAgMCAwIDIgMCIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSwxMywxNS41KSI+PC9wYXRoPgoJCTxwYXRoIGNsYXNzPSJzdDEiIGlkPSJpbmRpY2F0b3IiIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsMTMsMTUuNSkiPjwvcGF0aD4KCTwvZz4KPC9zdmc+",
VideoPlay:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggc3R5bGU9ImZpbGw6I2ZmZiIgZD0iTTgsNS4xNFYxOS4xNEwxOSwxMi4xNEw4LDUuMTRaIiAvPjwvc3ZnPg==",VideoPause:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggc3R5bGU9ImZpbGw6I2ZmZiIgZD0iTTE0LDE5LjE0SDE4VjUuMTRIMTRNNiwxOS4xNEgxMFY1LjE0SDZWMTkuMTRaIiAvPjwvc3ZnPg==",
VideoUnmute:"data:image/svg+xml;base64,PHN2ZyBpZD0iU3ZnanNTdmcxMDAxIiB3aWR0aD0iMjg4IiBoZWlnaHQ9IjI4OCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2ZXJzaW9uPSIxLjEiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4bWxuczpzdmdqcz0iaHR0cDovL3N2Z2pzLmNvbS9zdmdqcyI+PGRlZnMgaWQ9IlN2Z2pzRGVmczEwMDIiPjwvZGVmcz48ZyBpZD0iU3ZnanNHMTAwOCIgdHJhbnNmb3JtPSJtYXRyaXgoMC45MTY3LDAsMCwwLjkxNjcsMTIuMTc5NDIyNTcxNTYzNzIsMTIuMjM4MTQzMTg2NTY5MjMyKSI+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyODgiIGhlaWdodD0iMjg4IiB2ZXJzaW9uPSIxLjAiIHZpZXdCb3g9IjAgMCA3NSA3NSI+PHBhdGggZmlsbD0iI2ZmZmZmZiIgc3Ryb2tlPSIjZmZmZmZmIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjUiIGQ9Ik0zOS4zODksMTMuNzY5IEwyMi4yMzUsMjguNjA2IEw2LDI4LjYwNiBMNiw0Ny42OTkgTDIxLjk4OSw0Ny42OTkgTDM5LjM4OSw2Mi43NSBMMzkuMzg5LDEzLjc2OXoiIGNsYXNzPSJjb2xvcjExMSBzdmdTaGFwZSBjb2xvclN0cm9rZTExMSBzdmdTdHJva2UiPjwvcGF0aD48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmZmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNNDgsMjcuNmExOS41LDE5LjUgMCAwIDEgMCwyMS40TTU1LjEsMjAuNWEzMCwzMCAwIDAgMSAwLDM1LjZNNjEuNiwxNGEzOC44LDM4LjggMCAwIDEgMCw0OC42IiBjbGFzcz0iY29sb3JTdHJva2UxMTEgc3ZnU3Ryb2tlIj48L3BhdGg+PC9zdmc+PC9nPjwvc3ZnPg==",
VideoMute:"data:image/svg+xml;base64,PHN2ZyBzdHJva2Utd2lkdGg9IjUiIHN0cm9rZT0id2hpdGUiIHZpZXdCb3g9IjAgMCA3NSA3NSIgaGVpZ2h0PSI1MDAiIHdpZHRoPSI1MDAiIHZlcnNpb249IjEuMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZmlsbD0id2hpdGUiIGQ9Im0zOSwxNC0xNywxNUg2VjQ4SDIybDE3LDE1eiI+PC9wYXRoPgo8cGF0aCBzdHJva2UtbGluZWNhcD0icm91bmQiIGZpbGw9Im5vbmUiIGQ9Im00OSwyNiAyMCwyNG0wLTI0LTIwLDI0Ij48L3BhdGg+Cjwvc3ZnPg=="},ia={load:function(g){var d=1<arguments.length&&void 0!==arguments[1]?
arguments[1]:function(){},k=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(){};e.Cache.enabled=!0;var b,c,f;for(n in L)L.hasOwnProperty(n)&&g===L[n]&&(f=n);var h=e.Cache.get(f?f:g);if(void 0!==h)return d&&setTimeout(function(){k({loaded:1,total:1,progress:1});d(h,!1)},0),h;var B=window.URL||window.webkitURL;var l=document.createElementNS("http://www.w3.org/1999/xhtml","img");var G=function(){var a=0<arguments.length&&
void 0!==arguments[0]?arguments[0]:!1;B.revokeObjectURL(l.src);void 0==h&&e.Cache.add(f?f:g,l);d(l,a)};if(0===(null===g||void 0===g?void 0:g.indexOf("data:")))return l.addEventListener("load",G,!1),l.src=g,l;l.crossOrigin=void 0!==this.crossOrigin?this.crossOrigin:"";var n=new window.XMLHttpRequest;n.open("GET",g,!0);n.responseType="arraybuffer";n.addEventListener("error",a);n.addEventListener("progress",function(a){if(a){var b=a.loaded,c=a.total;a.lengthComputable&&k({loaded:b,total:c,progress:b/
c})}});n.addEventListener("loadend",function(a){if(a){a=a.currentTarget;var f=a.status;b=new Uint8Array(a.response);c=new window.Blob([b]);l.addEventListener("load",function(){G(400<=f)},!1);l.addEventListener("error",function(){G(400<=f)},!1);l.src=B.createObjectURL(c)}});n.send(null)}},cb=function(e){try{return"string"===typeof e&&!!e.length}catch(d){return!1}},db=function(e){try{var d=e.toLowerCase();return d.endsWith(".mp4")||d.endsWith(".mov")}catch(k){return!1}},Ga={load:function(){var e=0<
arguments.length&&void 0!==arguments[0]?arguments[0]:[],d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},k=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(){},b=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{};try{var c=e.filter(cb),f=1/c.length,h={loaded:0,total:1,relativeProgress:0},B=[],l=new Map,G=function(){var a=0,b=0,f=0;c.forEach(function(c){l.has(c)&&(c=l.get(c),a+=c.loaded,
b+=c.total,f+=c.relativeProgress)});if(1>h.relativeProgress){var d={loaded:a,total:b,relativeProgress:f};k(u(u({},d),{},{progress:d.relativeProgress}));h=d}};c.forEach(function(a,c){var h=function(b){l.set(a,{url:a,index:c,loaded:b.loaded,total:b.total,relativeProgress:f*b.progress});G()};l.set(a,{url:a,index:c,loaded:.1,total:1,relativeProgress:0});var d=new Promise(function(f,d){if(db(a))return f({url:a,image:null,isBadUrl:!1,error:null});ia.load(a,function(b,c){return f({url:a,image:b,isBadUrl:c,
error:null})},h,function(h){return"only-first-url"===b.errorMode&&0===c?d(h):f({url:a,image:null,isBadUrl:!0,error:h})})});B.push(d)});return Promise.all(B).then(function(a){1>h.relativeProgress&&k({loaded:h.loaded,total:h.total,progress:1});d(a);return a})["catch"](function(b){console.log(b);a(b)})}catch(n){console.log(n),a(n)}}},W={load:function(g){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},k=2<arguments.length?arguments[2]:void 0,a=3<arguments.length?arguments[3]:
void 0,b=new e.Texture;ia.load(g,function(a,f){b.image=a;a=0<g.search(/\.(jpg|jpeg)$/)||0===g.search(/^data:image\/jpeg/);b.format=a?e.RGBFormat:e.RGBAFormat;b.magFilter=e.LinearFilter;b.minFilter=e.LinearFilter;b.needsUpdate=!0;b.isBadUrl=f;d(b)},k,a);return b}},ja={load:function(e){var d=this,g=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};Ga.load(e,function(a){a=a.map(function(a){return d.createAndSetupTexture(a)});g(a)},2<arguments.length?arguments[2]:void 0,3<arguments.length?
arguments[3]:void 0);return[]},createAndSetupTexture:function(g){var d=new e.Texture(g.image),k="string"===typeof(null===g||void 0===g?void 0:g.url)&&(0<(null===g||void 0===g?void 0:g.url.search(/\.(jpg|jpeg)$/))||0===g.url.search(/^data:image\/jpeg/));d.format=k&&e.RGBFormat?e.RGBFormat:e.RGBAFormat;d.magFilter=e.LinearFilter;d.minFilter=e.LinearFilter;d.needsUpdate=!0;d.isBadUrl=g.isBadUrl;return d}};x.MTLLoader=function(e){this.manager=void 0!==e?e:x.DefaultLoadingManager};x.MTLLoader.prototype=
{constructor:x.MTLLoader,load:function(e,d,k,a){var b=this,c=new x.FileLoader(this.manager);c.setPath(this.path);c.load(e,function(a){d(b.parse(a))},k,a)},setPath:function(e){this.path=e;return this},setTexturePath:function(e){this.texturePath=e;return this},setBaseUrl:function(e){console.warn("THREE.MTLLoader: .setBaseUrl() is deprecated. Use .setTexturePath( path ) for texture path or .setPath( path ) for general base path instead.");return this.setTexturePath(e)},setCrossOrigin:function(e){this.crossOrigin=
e;return this},setMaterialOptions:function(e){this.materialOptions=e;return this},parse:function(e){var d=e.split("\n"),g={},a=/\s+/;e={};for(var b=0;b<d.length;b++){var c=d[b];c=c.trim();if(0!==c.length&&"#"!==c.charAt(0)){var f=c.indexOf(" "),h=0<=f?c.substring(0,f):c;h=h.toLowerCase();c=0<=f?c.substring(f+1):"";c=c.trim();"newmtl"===h?(g={name:c},e[c]=g):g&&("ka"===h||"kd"===h||"ks"===h?(c=c.split(a,3),g[h]=[parseFloat(c[0]),parseFloat(c[1]),parseFloat(c[2])]):g[h]=c)}}d=new x.MTLLoader.MaterialCreator(this.texturePath||
this.path,this.materialOptions);d.setCrossOrigin(this.crossOrigin);d.setManager(this.manager);d.setMaterials(e);return d}};x.MTLLoader.MaterialCreator=function(e,d){this.baseUrl=e||"";this.options=d;this.materialsInfo={};this.materials={};this.materialsArray=[];this.nameLookup={};this.side=this.options&&this.options.side?this.options.side:x.FrontSide;this.wrap=this.options&&this.options.wrap?this.options.wrap:x.RepeatWrapping};x.MTLLoader.MaterialCreator.prototype={constructor:x.MTLLoader.MaterialCreator,
crossOrigin:"Anonymous",setCrossOrigin:function(e){this.crossOrigin=e},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e);this.materials={};this.materialsArray=[];this.nameLookup={}},convert:function(e){if(!this.options)return e;var d={},g;for(g in e){var a=e[g],b={};d[g]=b;for(var c in a){var f=!0,h=a[c],B=c.toLowerCase();switch(B){case "kd":case "ka":case "ks":this.options&&this.options.normalizeRGB&&(h=[h[0]/255,h[1]/255,h[2]/255]),this.options&&
this.options.ignoreZeroRGBs&&0===h[0]&&0===h[1]&&0===h[2]&&(f=!1)}f&&(b[B]=h)}}return d},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0,d;for(d in this.materialsInfo)this.materialsArray[e]=this.create(d),this.nameLookup[d]=e,e++;return this.materialsArray},create:function(e){void 0===this.materials[e]&&this.createMaterial_(e);return this.materials[e]},createMaterial_:function(e){function d(a,b){return"string"!==
typeof b||""===b?"":/^https?:\/\//i.test(b)?b:a+b}function g(b,f){if(!c[b]){f=a.getTextureParams(f,c);var h=a.loadTexture(d(a.baseUrl,f.url));h.repeat.copy(f.scale);h.offset.copy(f.offset);h.wrapS=a.wrap;h.wrapT=a.wrap;c[b]=h}}var a=this,b=this.materialsInfo[e],c={name:e,side:this.side},f;for(f in b){var h=b[f];if(""!==h)switch(f.toLowerCase()){case "kd":c.color=(new x.Color).fromArray(h);break;case "ks":c.specular=(new x.Color).fromArray(h);break;case "map_kd":g("map",h);break;case "map_ks":g("specularMap",
h);break;case "norm":g("normalMap",h);break;case "map_bump":case "bump":g("bumpMap",h);break;case "ns":c.shininess=parseFloat(h);break;case "d":h=parseFloat(h);1>h&&(c.opacity=h,c.transparent=!0);break;case "tr":h=parseFloat(h),this.options&&this.options.invertTrProperty&&(h=1-h),0<h&&(c.opacity=1-h,c.transparent=!0)}}this.materials[e]=new x.MeshPhongMaterial(c);return this.materials[e]},getTextureParams:function(e,d){var g={scale:new x.Vector2(1,1),offset:new x.Vector2(0,0)};e=e.split(/\s+/);var a=
e.indexOf("-bm");0<=a&&(d.bumpScale=parseFloat(e[a+1]),e.splice(a,2));a=e.indexOf("-s");0<=a&&(g.scale.set(parseFloat(e[a+1]),parseFloat(e[a+2])),e.splice(a,4));a=e.indexOf("-o");0<=a&&(g.offset.set(parseFloat(e[a+1]),parseFloat(e[a+2])),e.splice(a,4));g.url=e.join(" ").trim();return g},loadTexture:function(e,d,k,a,b){var c=void 0!==this.manager?this.manager:x.DefaultLoadingManager,f=c.getHandler(e);null===f&&(f=new x.TextureLoader(c));f.setCrossOrigin&&f.setCrossOrigin(this.crossOrigin);e=f.load(e,
k,a,b);void 0!==d&&(e.mapping=d);return e}};x.OBJLoader=function(){function e(){var a={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function(a,b){if(this.object&&!1===this.object.fromDeclaration)this.object.name=a,this.object.fromDeclaration=!1!==b;else{var c=this.object&&"function"===typeof this.object.currentMaterial?this.object.currentMaterial():void 0;this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0);this.object=
{name:a||"",fromDeclaration:!1!==b,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(a,b){var c=this._finalize(!1);c&&(c.inherited||0>=c.groupCount)&&this.materials.splice(c.index,1);a={index:this.materials.length,name:a||"",mtllib:Array.isArray(b)&&0<b.length?b[b.length-1]:"",smooth:void 0!==c?c.smooth:this.smooth,groupStart:void 0!==c?c.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(a){a={index:"number"===typeof a?a:this.index,name:this.name,
mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};a.clone=this.clone.bind(a);return a}};this.materials.push(a);return a},currentMaterial:function(){if(0<this.materials.length)return this.materials[this.materials.length-1]},_finalize:function(a){var b=this.currentMaterial();b&&-1===b.groupEnd&&(b.groupEnd=this.geometry.vertices.length/3,b.groupCount=b.groupEnd-b.groupStart,b.inherited=!1);if(a&&1<this.materials.length)for(var c=this.materials.length-1;0<=c;c--)0>=
this.materials[c].groupCount&&this.materials.splice(c,1);a&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth});return b}};c&&c.name&&"function"===typeof c.clone&&(a=c.clone(0),a.inherited=!0,this.object.materials.push(a));this.objects.push(this.object)}},finalize:function(){this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(a,b){a=parseInt(a,10);return 3*(0<=a?a-1:a+b/3)},parseNormalIndex:function(a,b){a=parseInt(a,
10);return 3*(0<=a?a-1:a+b/3)},parseUVIndex:function(a,b){a=parseInt(a,10);return 2*(0<=a?a-1:a+b/2)},addVertex:function(a,b,c){var f=this.vertices,h=this.object.geometry.vertices;h.push(f[a+0],f[a+1],f[a+2]);h.push(f[b+0],f[b+1],f[b+2]);h.push(f[c+0],f[c+1],f[c+2])},addVertexPoint:function(a){var b=this.vertices;this.object.geometry.vertices.push(b[a+0],b[a+1],b[a+2])},addVertexLine:function(a){var b=this.vertices;this.object.geometry.vertices.push(b[a+0],b[a+1],b[a+2])},addNormal:function(a,b,c){var f=
this.normals,h=this.object.geometry.normals;h.push(f[a+0],f[a+1],f[a+2]);h.push(f[b+0],f[b+1],f[b+2]);h.push(f[c+0],f[c+1],f[c+2])},addColor:function(a,b,c){var f=this.colors,h=this.object.geometry.colors;h.push(f[a+0],f[a+1],f[a+2]);h.push(f[b+0],f[b+1],f[b+2]);h.push(f[c+0],f[c+1],f[c+2])},addUV:function(a,b,c){var f=this.uvs,h=this.object.geometry.uvs;h.push(f[a+0],f[a+1]);h.push(f[b+0],f[b+1]);h.push(f[c+0],f[c+1])},addUVLine:function(a){var b=this.uvs;this.object.geometry.uvs.push(b[a+0],b[a+
1])},addFace:function(a,b,c,d,e,g,k,p,m){var f=this.vertices.length;a=this.parseVertexIndex(a,f);b=this.parseVertexIndex(b,f);c=this.parseVertexIndex(c,f);this.addVertex(a,b,c);void 0!==d&&""!==d&&(c=this.uvs.length,a=this.parseUVIndex(d,c),b=this.parseUVIndex(e,c),c=this.parseUVIndex(g,c),this.addUV(a,b,c));void 0!==k&&""!==k&&(d=this.normals.length,a=this.parseNormalIndex(k,d),b=k===p?a:this.parseNormalIndex(p,d),c=k===m?a:this.parseNormalIndex(m,d),this.addNormal(a,b,c));0<this.colors.length&&
this.addColor(a,b,c)},addPointGeometry:function(a){this.object.geometry.type="Points";for(var b=this.vertices.length,c=0,f=a.length;c<f;c++)this.addVertexPoint(this.parseVertexIndex(a[c],b))},addLineGeometry:function(a,b){this.object.geometry.type="Line";for(var c=this.vertices.length,f=this.uvs.length,h=0,d=a.length;h<d;h++)this.addVertexLine(this.parseVertexIndex(a[h],c));a=0;for(d=b.length;a<d;a++)this.addUVLine(this.parseUVIndex(b[a],f))}};a.startObject("",!1);return a}function d(a){this.manager=
void 0!==a?a:x.DefaultLoadingManager;this.materials=null}var k=/^[og]\s*(.+)?/,a=/^mtllib /,b=/^usemtl /;d.prototype={constructor:d,load:function(a,b,h,d){var c=this,f=new x.FileLoader(c.manager);f.setPath(this.path);f.load(a,function(a){b(c.parse(a))},h,d)},setPath:function(a){this.path=a;return this},setMaterials:function(a){this.materials=a;return this},parse:function(c){console.time("OBJLoader r117");var f=new e;-1!==c.indexOf("\r\n")&&(c=c.replace(/\r\n/g,"\n"));-1!==c.indexOf("\\\n")&&(c=c.replace(/\\\n/g,
""));var h=c.split("\n"),d,g="function"===typeof"".trimLeft;c=0;for(var G=h.length;c<G;c++){var n=h[c];n=g?n.trimLeft():n.trim();var m=n.length;if(0!==m&&(m=n.charAt(0),"#"!==m))if("v"===m)switch(n=n.split(/\s+/),n[0]){case "v":f.vertices.push(parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3]));8===n.length&&f.colors.push(parseFloat(n[4]),parseFloat(n[5]),parseFloat(n[6]));break;case "vn":f.normals.push(parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3]));break;case "vt":f.uvs.push(parseFloat(n[1]),
parseFloat(n[2]))}else if("f"===m){n=n.substr(1).trim();var p=n.split(/\s+/);n=[];m=0;for(d=p.length;m<d;m++){var q=p[m];0<q.length&&(q=q.split("/"),n.push(q))}p=n[0];m=1;for(d=n.length-1;m<d;m++){q=n[m];var y=n[m+1];f.addFace(p[0],q[0],y[0],p[1],q[1],y[1],p[2],q[2],y[2])}}else if("l"===m){m=n.substring(1).trim().split(" ");d=[];p=[];if(-1===n.indexOf("/"))d=m;else for(n=0,q=m.length;n<q;n++)y=m[n].split("/"),""!==y[0]&&d.push(y[0]),""!==y[1]&&p.push(y[1]);f.addLineGeometry(d,p)}else if("p"===m)n=
n.substr(1).trim(),n=n.split(" "),f.addPointGeometry(n);else if(null!==(d=k.exec(n)))n=(" "+d[0].substr(1).trim()).substr(1),f.startObject(n);else if(b.test(n))f.object.startMaterial(n.substring(7).trim(),f.materialLibraries);else if(a.test(n))f.materialLibraries.push(n.substring(7).trim());else if("s"===m){if(d=n.split(" "),1<d.length?(n=d[1].trim().toLowerCase(),f.object.smooth="0"!==n&&"off"!==n):f.object.smooth=!0,n=f.object.currentMaterial())n.smooth=f.object.smooth}else if("\x00"!==n)throw Error('THREE.OBJLoader: Unexpected line: "'+
n+'"');}f.finalize();h=new x.Group;h.materialLibraries=[].concat(f.materialLibraries);c=0;for(G=f.objects.length;c<G;c++)if(g=f.objects[c],n=g.geometry,m=g.materials,d="Line"===n.type,p="Points"===n.type,q=!1,0!==n.vertices.length){y=new x.BufferGeometry;y.setAttribute("position",new x.Float32BufferAttribute(n.vertices,3));0<n.normals.length?y.setAttribute("normal",new x.Float32BufferAttribute(n.normals,3)):y.computeVertexNormals();0<n.colors.length&&(q=!0,y.setAttribute("color",new x.Float32BufferAttribute(n.colors,
3)));0<n.uvs.length&&y.setAttribute("uv",new x.Float32BufferAttribute(n.uvs,2));for(var r=[],H=0,t=m.length;H<t;H++){var u=m[H];n=void 0;if(null!==this.materials)if(n=this.materials.create(u.name),d&&n&&!(n instanceof x.LineBasicMaterial)){var v=new x.LineBasicMaterial;v.copy(n);v.lights=!1;n=v}else if(p&&n&&!(n instanceof x.PointsMaterial)){var w=new x.PointsMaterial({size:10,sizeAttenuation:!1});v.copy(n);n=w}n||(n=d?new x.LineBasicMaterial:p?new x.PointsMaterial({size:1,sizeAttenuation:!1}):new x.MeshPhongMaterial,
n.name=u.name);n.flatShading=u.smooth?!1:!0;n.vertexColors=q?x.VertexColors:x.NoColors;r.push(n)}if(1<r.length){H=0;for(t=m.length;H<t;H++)u=m[H],y.addGroup(u.groupStart,u.groupCount,H);n=d?new x.LineSegments(y,r):p?new x.Points(y,r):new x.Mesh(y,r)}else n=d?new x.LineSegments(y,r[0]):p?new x.Points(y,r[0]):new x.Mesh(y,r[0]);n.name=g.name;h.add(n)}console.timeEnd("OBJLoader r117");return h}};return d}();var eb=x.MTLLoader,fb=x.OBJLoader,aa=function(e){function d(){var a=0<arguments.length&&void 0!==
arguments[0]?arguments[0]:{};C(this,d);var b=g.call(this);b.options=u({},a);b.shortId=b.options.shortId;b.element=b.createElement();b.container=null;b.isSelected=!1;b.type=t.DOLLSPOT;b.addEventListener("panolens-container",b.setContainer.bind(r(b)));return b}D(d,e);var g=E(d);F(d,[{key:"updateTitle",value:function(a){this.element.innerHTML='\n      <div class="panolens-dollspot-container">\n        <div class="panolens-dollspot-title">'.concat(a,'</div>\n        <svg class="panolens-dollspot-icon" width="16" height="10" viewBox="0 0 16 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M8 8L15 1V0H1V1L8 8Z" fill="currentColor"/>\n        </svg>\n\n    <div class="panolens-dollspot__wrapper-spot">\n      <svg width="9" height="5" viewBox="0 0 9 5" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <ellipse cx="4.50013" cy="2.13327" rx="3.53846" ry="1.88718" fill="white"/>\n      </svg>\n    </div>\n  </div>\n    ')}},
{key:"select",value:function(){this.isSelected=!0}},{key:"unselect",value:function(){this.isSelected=!1}},{key:"createElement",value:function(){var a=document.createElement("div");a.innerHTML='\n      <div class="panolens-dollspot-container">\n        <div class="panolens-dollspot-title">'.concat(this.options.title||". . .",'</div>\n        <svg class="panolens-dollspot-icon" width="16" height="10" viewBox="0 0 16 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M8 8L15 1V0H1V1L8 8Z" fill="currentColor"/>\n        </svg>\n\n        <div class="panolens-dollspot__wrapper-spot">\n          <svg width="9" height="5" viewBox="0 0 9 5" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <ellipse cx="4.50013" cy="2.13327" rx="3.53846" ry="1.88718" fill="white"/>\n          </svg>\n        </div>\n      </div>\n  ');
var b=document.createElement("style");b.type="text/css";b.textContent="\n    @supports (filter: drop-shadow(0 1px #00000020) drop-shadow(0 3px 4px #00000020)) or (-webkit-filter: drop-shadow(0 1px #00000020) drop-shadow(0 3px 4px #00000020)) {\n      .panolens-dollspot-container {\n        filter: drop-shadow(0 1px #00000020) drop-shadow(0 3px 4px #00000020);\n        -webkit-filter: drop-shadow(0 1px #00000020) drop-shadow(0 3px 4px #00000020);\n      }\n    }\n\n    .panolens-dollspot-container {\n      position: absolute;\n      bottom: 0;\n      left: 50%;\n      display: flex;\n      overflow: visible;\n      align-items: center;\n      flex-direction: column;\n      justify-content: flex-end;\n      transform: translate(-50%, 0);\n      cursor: pointer;\n    }\n\n    .panolens-dollspot-title {\n      position: relative;\n      z-index: -1;\n      bottom: 0px;\n      overflow: hidden;\n      max-width: 128px;\n      padding: 2px 12px 4px;\n      text-align: center;\n      text-overflow: ellipsis;\n      color: #FFF;\n      border-radius: 6px;\n      background-color: rgba(0, 0, 0, 0.75);\n      font-size: 12px;\n      white-space: nowrap;\n    }\n\n    .panolens-dollspot-container:hover .panolens-dollspot-title {\n      background: #000000;\n    }\n\n    .panolens-dollspot-icon {\n      color: rgba(0, 0, 0, 0.75);\n      position: relative;\n      width: 16px;\n      height: 10px;\n      margin: 0 auto;\n    }\n\n    .panolens-dollspot-container:hover .panolens-dollspot-icon {\n      color: #000000;\n    }\n  ";
a.append(b);document.head.append(b);a.style.display="none";a.style.position="absolute";a.style.width=0;a.style.height=0;a.style.top=0;a.style.left=0;a.classList.add("panolens-infospot");a.addEventListener("mousedown",this.onClick.bind(this));return a}},{key:"translateElement",value:function(a,b){this.element&&this.container&&(b-=this.element.clientHeight,a="translate(".concat(a-this.element.clientWidth,"px, ").concat(b,"px)"),this.element.style.transform=a,this.element.style.webkitTransform=a,this.element.style.msTransform=
a,this.element.style.display="flex")}},{key:"onClick",value:function(){this.dispatchEvent({type:"select-dollspot",dollspot:this})}},{key:"destroy",value:function(){this.element.remove()}},{key:"setContainer",value:function(a){if(a instanceof HTMLElement)var b=a;else a&&a.container&&(b=a.container);b&&this.element&&b.append(this.element);this.container=b}}]);return d}(e.Object3D),Ha=function(g){function d(a,b,c){C(this,d);var f=k.call(this);f.loaded=!1;e.ImageUtils.crossOrigin="";f.mtlLoader=new eb;
f.objLoader=new fb;f.loadMtlObj(a,b,c);f.name=m.DOLLHOUSE;f.type=m.DOLLHOUSE;f.isInfospotVisible=!1;f.container=null;f.addEventListener("click",f.onClick.bind(r(f)));f.addEventListener("panolens-container",f.setContainer.bind(r(f)));return f}D(d,g);var k=E(d);F(d,[{key:"add",value:function(a){var b=this;if(a instanceof aa){var c=this.container;a.addEventListener("select-dollspot",function(a){b.dispatchEvent({type:"dollhouse-select-dollspot",dollspot:a.dollspot})});c&&a.dispatchEvent({type:"panolens-container",
container:c});a.dispatchEvent({type:"panolens-infospot-focus",method:function(a,b,c){this.dispatchEvent({type:"panolens-viewer-handler",method:"tweenControlCenter",data:[a,b,c]})}})}A(w(d.prototype),"add",this).call(this,a);this.dispatchEvent({type:"addChild"})}},{key:"toggleInfospotVisibility",value:function(a,b){b=void 0!==b?b:0;var c=void 0!==a?a:!this.isInfospotVisible;this.traverse(function(a){a instanceof aa&&(c?a.show(b):a.hide(b))});this.isInfospotVisible=c}},{key:"onClick",value:function(a){a.intersects&&
0===a.intersects.length&&this.traverse(function(a){a.dispatchEvent({type:"dismiss"})})}},{key:"setContainer",value:function(a){if(a instanceof HTMLElement)var b=a;else a&&a.container&&(b=a.container);b&&(this.children.forEach(function(a){a instanceof aa&&a.dispatchEvent&&a.dispatchEvent({type:"panolens-container",container:b})}),this.container=b)}},{key:"loadMtlObj",value:function(a,b,c){var f=this;this.dispatchEvent({type:"load-start"});this.mtlLoader.crossOrigin="";this.mtlLoader.setPath(a);this.mtlLoader.load(b,
function(a){a.preload();f.objLoader.setMaterials(a);f.objLoader.load(c,f.onObjLoadSuccess.bind(f),f.onObjLoadProgress.bind(f),f.onObjLoadError.bind(f))})}},{key:"onObjLoadSuccess",value:function(a){this.loaded=!0;a.position.set(0,0,0);a.name="dollhouseObject";var b=new window.THREE.AmbientLight(16777215,.8);b.name="dollhouseLight";a.add(b);this.add(a);this.dispatchEvent({type:"loaded"});this.dispatchEvent({type:"ready"})}},{key:"addLight",value:function(a){var b=new window.THREE.AmbientLight(16777215,
.8);b.name="dollhouseLight";a.add(b)}},{key:"onObjLoadProgress",value:function(a){this.dispatchEvent({type:"loading",percentDownloaded:"".concat(Math.trunc(100*a.loaded/a.total))})}},{key:"onObjLoadError",value:function(a){this.dispatchEvent({type:"error"});console.error("An error happened",a.message)}},{key:"dispose",value:function(){function a(b){for(var c=b.geometry,h=b.material,d=b.children.length-1;0<=d;d--)a(b.children[d]),b.remove(b.children[d]);c&&(c.dispose(),b.geometry=null);h&&(Array.isArray(h)?
h.forEach(function(a){return a.dispose()}):h.dispose(),b.material=null)}var b=this.material;b&&b.uniforms&&b.uniforms.tEquirect&&b.uniforms.tEquirect.value.dispose();this.dispatchEvent({type:"panolens-viewer-handler",method:"onDollhouseDispose",data:this});a(this);this.parent&&this.parent.remove(this)}}]);return d}(e.Mesh),Ia={load:function(g){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},k=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},a=3<arguments.length?
arguments[3]:void 0,b;var c=new e.CubeTexture([]);var f=0;var h={};var B={};g.map(function(e,g){ia.load(e,function(a){c.images[g]=a;f++;6===f&&(c.needsUpdate=!0,d(c))},function(a){h[g]={loaded:a.loaded,total:a.total};B.loaded=0;b=B.total=0;for(var c in h)b++,B.loaded+=h[c].loaded,B.total+=h[c].total;6>b&&(B.total=B.total/b*6);k(B)},a)});return c}},Ja=function(e){function d(a){C(this,d);a||console.warn("PANOLENS.Widget: No container specified");var b=g.call(this);b.DEFAULT_TRANSITION="all 0.27s ease";
b.TOUCH_ENABLED=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch);b.PREVENT_EVENT_HANDLER=function(a){a.preventDefault();a.stopPropagation()};b.container=a;b.barElement=null;b.fullscreenElement=null;b.videoElement=null;b.settingElement=null;b.mainMenu=null;b.activeMainItem=null;b.activeSubMenu=null;b.mask=null;return b}D(d,e);var g=E(d);F(d,[{key:"addControlBar",value:function(){if(this.container){var a=this,b,c;var f=document.createElement("div");f.classList.add("videoWidgetBar");
f.style.width="200px";f.style.height="44px";f.style.left="50%";f.style.transform=f.style.webkitTransform=f.style.msTransform="translate(-100px, -100%)";f.style.bottom="120px";f.style.background="-webkit-".concat("linear-gradient(bottom, rgba(0,0,0,0.2), rgba(0,0,0,0))");f.style.background="-moz-".concat("linear-gradient(bottom, rgba(0,0,0,0.2), rgba(0,0,0,0))");f.style.background="-o-".concat("linear-gradient(bottom, rgba(0,0,0,0.2), rgba(0,0,0,0))");f.style.background="-ms-".concat("linear-gradient(bottom, rgba(0,0,0,0.2), rgba(0,0,0,0))");
f.style.background="linear-gradient(bottom, rgba(0,0,0,0.2), rgba(0,0,0,0))";f.style.transition=this.DEFAULT_TRANSITION;f.style.pointerEvents="none";f.style.position="absolute";f.isHidden=!1;f.toggle=function(){f.isHidden=!f.isHidden;b=f.isHidden?"translate(-100px, 0)":"translate(-100px, -100%)";c=f.isHidden?0:1;f.style.transform=f.style.webkitTransform=f.style.msTransform=b;f.style.opacity=c};var h=this.createDefaultMenu();this.mainMenu=this.createMainMenu(h);f.append(this.mainMenu);this.mask=h=
this.createMask();this.container.append(h);f.dispose=function(){a.fullscreenElement&&(a.fullscreenElement.remove(),a.fullscreenElement.dispose(),a.fullscreenElement=null);a.settingElement&&(a.settingElement.remove(),a.settingElement.dispose(),a.settingElement=null);a.videoElement&&(a.videoElement.remove(),a.videoElement.dispose(),a.videoElement=null)};this.container.append(f);this.mask.addEventListener("mousemove",this.PREVENT_EVENT_HANDLER,!0);this.mask.addEventListener("mouseup",this.PREVENT_EVENT_HANDLER,
!0);this.mask.addEventListener("mousedown",this.PREVENT_EVENT_HANDLER,!0);this.mask.addEventListener(a.TOUCH_ENABLED?"touchend":"click",function(b){b.preventDefault();b.stopPropagation();a.mask.hide();a.settingElement.deactivate()},!1);this.addEventListener("control-bar-toggle",f.toggle);this.barElement=f}else console.warn("Widget container not set")}},{key:"createDefaultMenu",value:function(){var a=this;var b=function(b,f){return function(){a.dispatchEvent({type:"panolens-viewer-handler",method:b,
data:f})}};return[{title:"Control",subMenu:[{title:this.TOUCH_ENABLED?"Touch":"Mouse",handler:b("enableControl",N.ORBIT)},{title:"Sensor",handler:b("enableControl",N.DEVICEORIENTATION)}]},{title:"Mode",subMenu:[{title:"Normal",handler:b("disableEffect")},{title:"Cardboard",handler:b("enableEffect",z.CARDBOARD)},{title:"Stereoscopic",handler:b("enableEffect",z.STEREO)}]}]}},{key:"addControlButton",value:function(a){switch(a){case "fullscreen":this.fullscreenElement=a=this.createFullscreenButton();
break;case "setting":this.settingElement=a=this.createSettingButton();break;case "video":this.videoElement=a=this.createVideoControl();break;default:return}a&&this.barElement.append(a)}},{key:"createMask",value:function(){var a=document.createElement("div");a.classList.add("videoWidgetMask");a.style.position="absolute";a.style.top=0;a.style.left=0;a.style.width="100%";a.style.height="100%";a.style.background="transparent";a.style.display="none";a.show=function(){this.style.display="block"};a.hide=
function(){this.style.display="none"};return a}},{key:"createSettingButton",value:function(){var a=this;var b=this.createCustomItem({style:{backgroundImage:'url("'.concat(L.Setting,'")'),webkitTransition:this.DEFAULT_TRANSITION,transition:this.DEFAULT_TRANSITION},onTap:function(b){b.preventDefault();b.stopPropagation();a.mainMenu.toggle();this.activated?this.deactivate():this.activate()}});b.activate=function(){this.style.transform="rotate3d(0,0,1,90deg)";this.activated=!0;a.mask.show()};b.deactivate=
function(){this.style.transform="rotate3d(0,0,0,0)";this.activated=!1;a.mask.hide();a.mainMenu&&a.mainMenu.visible&&a.mainMenu.hide();a.activeSubMenu&&a.activeSubMenu.visible&&a.activeSubMenu.hide();a.mainMenu&&a.mainMenu._width&&(a.mainMenu.changeSize(a.mainMenu._width),a.mainMenu.unslideAll())};b.activated=!1;return b}},{key:"createFullscreenButton",value:function(){function a(){f&&(c=!c,d.style.backgroundImage=c?'url("'.concat(L.FullscreenLeave,'")'):'url("'.concat(L.FullscreenEnter,'")'));b.dispatchEvent({type:"panolens-viewer-handler",
method:"onWindowResize"});f=!0}var b=this,c=!1,f=!0,h=this.container;if(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled){document.addEventListener("fullscreenchange",a,!1);document.addEventListener("webkitfullscreenchange",a,!1);document.addEventListener("mozfullscreenchange",a,!1);document.addEventListener("MSFullscreenChange",a,!1);var d=this.createCustomItem({style:{backgroundImage:'url("'.concat(L.FullscreenEnter,'")')},
onTap:function(a){a.preventDefault();a.stopPropagation();f=!1;c?(document.exitFullscreen&&document.exitFullscreen(),document.msExitFullscreen&&document.msExitFullscreen(),document.mozCancelFullScreen&&document.mozCancelFullScreen(),document.webkitExitFullscreen&&document.webkitExitFullscreen(),c=!1):(h.requestFullscreen&&h.requestFullscreen(),h.msRequestFullscreen&&h.msRequestFullscreen(),h.mozRequestFullScreen&&h.mozRequestFullScreen(),h.webkitRequestFullscreen&&h.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT),
c=!0);this.style.backgroundImage=c?'url("'.concat(L.FullscreenLeave,'")'):'url("'.concat(L.FullscreenEnter,'")')}});if(!document.querySelector("panolens-style-addon")){var e=document.createElement("style");e.id="panolens-style-addon";e.innerHTML=":-webkit-full-screen { width: 100% !important; height: 100% !important }";document.body.append(e)}return d}}},{key:"createVideoControl",value:function(){var a=document.createElement("span");a.style.display="none";a.show=function(){a.style.display=""};a.hide=
function(){a.style.display="none";a.controlButton.paused=!0;a.controlButton.update()};a.controlButton=this.createVideoControlButton();a.soundButton=this.createVideoSoundButton();a.seekBar=this.createVideoControlSeekbar();a.append(a.controlButton);a.append(a.seekBar);a.append(a.soundButton);a.dispose=function(){a.controlButton.remove();a.seekBar.remove();a.controlButton.dispose();a.controlButton=null;a.seekBar.dispose();a.seekBar=null};this.addEventListener("video-control-show",a.show);this.addEventListener("video-control-hide",
a.hide);return a}},{key:"createVideoControlButton",value:function(){var a=this,b=this.createCustomItem({style:{"float":"left",backgroundImage:'url("'.concat(L.VideoPlay,'")')},onTap:function(c){c.preventDefault();c.stopPropagation();a.dispatchEvent({type:"panolens-viewer-handler",method:"toggleVideoPlay",data:!this.paused});this.paused=!this.paused;b.update()}});b.paused=!0;b.update=function(a){this.paused=void 0!==a?a:this.paused;this.style.backgroundImage='url("'.concat(this.paused?L.VideoPlay:
L.VideoPause,'")')};return b}},{key:"createVideoSoundButton",value:function(){var a=this,b=this.createCustomItem({style:{"float":"left",backgroundImage:'url("'.concat(L.VideoMute,'")')},id:ta.VIDEO_SOUND_BUTTON,onTap:function(c){c.preventDefault();c.stopPropagation();b.isDisabled||(a.dispatchEvent({type:"panolens-viewer-handler",method:"toggleVideoSound"}),this.muted=!this.muted,b.update())}});this.muted=!0;b.update=function(a){this.muted=void 0!==a?a:this.muted;this.style.backgroundImage='url("'.concat(this.muted?
L.VideoUnmute:L.VideoMute,'")')};return b}},{key:"createVideoControlSeekbar",value:function(){function a(a){a.stopPropagation();d=!0;e=a.clientX||a.changedTouches&&a.changedTouches[0].clientX;g=Number.parseInt(k.style.width)/100;h.container.addEventListener("mousemove",b,{passive:!0});h.container.addEventListener("mouseup",c,{passive:!0});h.container.addEventListener("touchmove",b,{passive:!0});h.container.addEventListener("touchend",c,{passive:!0})}function b(a){d&&(n=((a.clientX||a.changedTouches&&
a.changedTouches[0].clientX)-e)/m.clientWidth,n=g+n,n=1<n?1:0>n?0:n,m.setProgress(n),h.dispatchEvent({type:"panolens-viewer-handler",method:"setVideoCurrentTime",data:n}))}function c(a){a.stopPropagation();d=!1;f()}function f(){h.container.removeEventListener("mousemove",b,!1);h.container.removeEventListener("mouseup",c,!1);h.container.removeEventListener("touchmove",b,!1);h.container.removeEventListener("touchend",c,!1)}var h=this,d=!1,e,g,n;var k=document.createElement("div");k.style.width="0%";
k.style.height="100%";k.style.backgroundColor="#fff";var p=document.createElement("div");p.style["float"]="right";p.style.width="14px";p.style.height="14px";p.style.transform="translate(7px, -5px)";p.style.borderRadius="50%";p.style.backgroundColor="#ddd";p.addEventListener("mousedown",a,{passive:!0});p.addEventListener("touchstart",a,{passive:!0});k.append(p);var m=this.createCustomItem({style:{"float":"left",width:"110px",display:"flex",height:"4px",marginTop:"20px",backgroundColor:"rgba(188,188,188,0.8)"},
onTap:function(a){a.preventDefault();a.stopPropagation();if(a.target!==p){var b=a.changedTouches&&0<a.changedTouches.length?(a.changedTouches[0].pageX-a.target.getBoundingClientRect().left)/this.clientWidth:a.offsetX/this.clientWidth;h.dispatchEvent({type:"panolens-viewer-handler",method:"setVideoCurrentTime",data:b});m.setProgress(a.offsetX/this.clientWidth)}},onDispose:function(){f();p=k=null}});m.append(k);m.setProgress=function(a){k.style.width="".concat(100*a,"%")};this.addEventListener("video-update",
function(a){m.setProgress(a.percentage)});m.progressElement=k;m.progressElementControl=p;return m}},{key:"createMenuItem",value:function(a){var b=this,c=document.createElement("a");c.textContent=a;c.style.display="block";c.style.padding="10px";c.style.textDecoration="none";c.style.cursor="pointer";c.style.pointerEvents="auto";c.style.transition=this.DEFAULT_TRANSITION;c.slide=function(a){this.style.transform="translateX(".concat(a?"":"-","100%)")};c.unslide=function(){this.style.transform="translateX(0)"};
c.setIcon=function(a){this.icon&&(this.icon.style.backgroundImage="url(".concat(a,")"))};c.setSelectionTitle=function(a){this.selection&&(this.selection.textContent=a)};c.addSelection=function(a){var b=document.createElement("span");b.style.fontSize="13px";b.style.fontWeight="300";b.style["float"]="right";this.selection=b;this.setSelectionTitle(a);this.append(b);return this};c.addIcon=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:L.ChevronRight,b=1<arguments.length&&void 0!==
arguments[1]?arguments[1]:!1,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1,d=document.createElement("span");d.style["float"]=b?"left":"right";d.style.width="17px";d.style.height="17px";d.style["margin".concat(b?"Right":"Left")]="12px";d.style.backgroundSize="cover";c&&(d.style.transform="rotateZ(180deg)");this.icon=d;this.setIcon(a);this.append(d);return this};c.addSubMenu=function(a,c){this.subMenu=b.createSubMenu(a,c);return this};c.addEventListener("mouseenter",function(){this.style.backgroundColor=
"#e0e0e0"},!1);c.addEventListener("mouseleave",function(){this.style.backgroundColor="#fafafa"},!1);return c}},{key:"createMenuItemHeader",value:function(a){a=this.createMenuItem(a);a.style.borderBottom="1px solid #333";a.style.paddingBottom="15px";return a}},{key:"createMainMenu",value:function(a){function b(a){a.preventDefault();a.stopPropagation();var b=c.mainMenu,f=this.subMenu;b.hide();b.slideAll();b.parentElement.append(f);c.activeMainItem=this;c.activeSubMenu=f;window.requestAnimationFrame(function(){b.changeSize(f.clientWidth);
f.show();f.unslideAll()})}var c=this,f=this.createMenu();f._width=200;f.changeSize(f._width);a=da(a);var h;try{for(a.s();!(h=a.n()).done;){var d=h.value,e=f.addItem(d.title);e.style.paddingLeft="20px";e.addIcon().addEventListener(c.TOUCH_ENABLED?"touchend":"click",b,!1);d.subMenu&&0<d.subMenu.length&&e.addSelection(d.subMenu[0].title).addSubMenu(d.title,d.subMenu)}}catch(G){a.e(G)}finally{a.f()}return f}},{key:"createSubMenu",value:function(a,b){function c(a){a.preventDefault();a.stopPropagation();
d=f.mainMenu;d.changeSize(d._width);d.unslideAll();d.show();e.slideAll(!0);e.hide();"header"!==this.type&&(e.setActiveItem(this),f.activeMainItem.setSelectionTitle(this.textContent),this.handler&&this.handler())}var f=this,d,e=this.createMenu();e.items=b;e.activeItem=null;e.addHeader(a).addIcon(void 0,!0,!0).addEventListener(f.TOUCH_ENABLED?"touchend":"click",c,!1);a=da(b);var g;try{for(a.s();!(g=a.n()).done;){var k=g.value,n=e.addItem(k.title);n.style.fontWeight=300;n.handler=k.handler;n.addIcon(" ",
!0);n.addEventListener(f.TOUCH_ENABLED?"touchend":"click",c,!1);e.activeItem||e.setActiveItem(n)}}catch(U){a.e(U)}finally{a.f()}e.slideAll(!0);return e}},{key:"createMenu",value:function(){var a=this,b=document.createElement("span"),c=b.style;c.padding="5px 0";c.position="fixed";c.bottom="100%";c.right="14px";c.backgroundColor="#fafafa";c.fontFamily="Helvetica Neue";c.fontSize="14px";c.visibility="hidden";c.opacity=0;c.boxShadow="0 0 12pt rgba(0,0,0,0.25)";c.borderRadius="2px";c.overflow="hidden";
c.willChange="width, height, opacity";c.pointerEvents="auto";c.transition=this.DEFAULT_TRANSITION;b.visible=!1;b.changeSize=function(a,b){a&&(this.style.width="".concat(a,"px"));b&&(this.style.height="".concat(b,"px"))};b.show=function(){this.style.opacity=1;this.style.visibility="visible";this.visible=!0};b.hide=function(){this.style.opacity=0;this.style.visibility="hidden";this.visible=!1};b.toggle=function(){this.visible?this.hide():this.show()};b.slideAll=function(a){for(var c=0;c<b.children.length;c++)b.children[c].slide&&
b.children[c].slide(a)};b.unslideAll=function(){for(var a=0;a<b.children.length;a++)b.children[a].unslide&&b.children[a].unslide()};b.addHeader=function(b){b=a.createMenuItemHeader(b);b.type="header";this.append(b);return b};b.addItem=function(b){b=a.createMenuItem(b);b.type="item";this.append(b);return b};b.setActiveItem=function(a){this.activeItem&&this.activeItem.setIcon(" ");a.setIcon(L.Check);this.activeItem=a};b.addEventListener("mousemove",this.PREVENT_EVENT_HANDLER,!0);b.addEventListener("mouseup",
this.PREVENT_EVENT_HANDLER,!0);b.addEventListener("mousedown",this.PREVENT_EVENT_HANDLER,!0);return b}},{key:"createCustomItem",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},b=this,c=a.element||document.createElement("span"),f=a.onDispose;c.style.cursor="pointer";c.style["float"]="right";c.style.width="44px";c.style.height="100%";c.style.backgroundSize="60%";c.style.backgroundRepeat="no-repeat";c.style.backgroundPosition="center";c.style.webkitUserSelect=c.style.MozUserSelect=
c.style.userSelect="none";c.style.position="relative";c.style.pointerEvents="auto";a.id&&c.setAttribute("id",a.id);c.addEventListener(b.TOUCH_ENABLED?"touchstart":"mouseenter",function(){c.style.filter=c.style.webkitFilter="drop-shadow(0 0 5px rgba(255,255,255,1))"},{passive:!0});c.addEventListener(b.TOUCH_ENABLED?"touchend":"mouseleave",function(){c.style.filter=c.style.webkitFilter=""},{passive:!0});this.mergeStyleOptions(c,a.style);a.onTap&&c.addEventListener(b.TOUCH_ENABLED?"touchend":"click",
a.onTap,!1);c.dispose=function(){c.removeEventListener(b.TOUCH_ENABLED?"touchend":"click",a.onTap,!1);if(f)a.onDispose()};return c}},{key:"mergeStyleOptions",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},c;for(c in b)b.hasOwnProperty(c)&&(a.style[c]=b[c]);return a}},{key:"dispose",value:function(){this.barElement&&(this.barElement.remove(),this.barElement.dispose(),this.barElement=null)}}]);return d}(e.EventDispatcher),Ka=function(g){function d(){var a=0<arguments.length&&
void 0!==arguments[0]?arguments[0]:16777215,b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1500;C(this,d);var f=window.devicePixelRatio,h=function(){var a=document.createElement("canvas"),b=a.getContext("2d");a.width=32*f;a.height=32*f;b.scale(f,f);b.shadowBlur=5;b.shadowColor="rgba(200,200,200,0.9)";return{canvas:a,context:b}}(),g=h.canvas;h=h.context;var l=new e.SpriteMaterial({color:a,map:function(a){a=new e.CanvasTexture(a);
a.minFilter=e.LinearFilter;a.magFilter=e.LinearFilter;a.generateMipmaps=!1;return a}(g)});l=k.call(this,l);l.dpr=f;l.canvasWidth=g.width;l.canvasHeight=g.height;l.context=h;l.color=a instanceof e.Color?a:new e.Color(a);l.autoSelect=b;l.dwellTime=c;l.rippleDuration=500;l.position.z=-10;l.center.set(.5,.5);l.scale.set(.5,.5,1);l.startTimestamp=null;l.timerId=null;l.callback=null;l.frustumCulled=!1;l.updateCanvasArcByProgress(0);return l}D(d,g);var k=E(d);F(d,[{key:"setColor",value:function(a){this.material.color.copy(a instanceof
e.Color?a:new e.Color(a))}},{key:"updateCanvasArcByProgress",value:function(a){var b=this.context,c=this.canvasWidth,f=this.canvasHeight,d=this.material,e=this.dpr,g=a*Math.PI*2,k=this.color.getStyle(),n=.5*c/e;e=.5*f/e;b.clearRect(0,0,c,f);b.beginPath();0===a?(b.arc(n,e,c/16,0,2*Math.PI),b.fillStyle=k,b.fill()):(b.arc(n,e,c/4-3,-Math.PI/2,-Math.PI/2+g),b.strokeStyle=k,b.lineWidth=3,b.stroke());b.closePath();d.map.needsUpdate=!0}},{key:"ripple",value:function(){var a=this,b=this.context,c=this.canvasWidth,
f=this.canvasHeight,d=this.material,e=this.rippleDuration,g=performance.now(),k=this.color,n=this.dpr,m=.5*c/n,p=.5*f/n;this.dispatchEvent({type:"reticle-ripple-start"});(function y(){var h=window.requestAnimationFrame(y),l=(performance.now()-g)/e,B=0<1-l?1-l:0,G=l*c*.5/n;b.clearRect(0,0,c,f);b.beginPath();b.arc(m,p,G,0,2*Math.PI);b.fillStyle="rgba(".concat(255*k.r,", ").concat(255*k.g,", ").concat(255*k.b,", ").concat(B,")");b.fill();b.closePath();1<=l&&(window.cancelAnimationFrame(h),a.updateCanvasArcByProgress(0),
a.dispatchEvent({type:"reticle-ripple-end"}));d.map.needsUpdate=!0})()}},{key:"show",value:function(){this.visible=!0}},{key:"hide",value:function(){this.visible=!1}},{key:"start",value:function(a){this.autoSelect&&(this.dispatchEvent({type:"reticle-start"}),this.startTimestamp=performance.now(),this.callback=a,this.update())}},{key:"end",value:function(){this.startTimestamp&&(window.cancelAnimationFrame(this.timerId),this.updateCanvasArcByProgress(0),this.startTimestamp=this.timerId=this.callback=
null,this.dispatchEvent({type:"reticle-end"}))}},{key:"update",value:function(){this.timerId=window.requestAnimationFrame(this.update.bind(this));var a=(performance.now()-this.startTimestamp)/this.dwellTime;this.updateCanvasArcByProgress(a);this.dispatchEvent({type:"reticle-update",progress:a});1<=a&&(window.cancelAnimationFrame(this.timerId),this.callback&&this.callback(),this.end(),this.ripple())}}]);return d}(e.Sprite),O=function(g){function d(){C(this,d);var a=k.call(this,d.createGeometry(),d.createMaterial());
a.subtype=V.FLOOR_PLANE;a.position.set(Z.X,Z.Y,Z.Z);a.rotateX(-Math.PI/2);return a}D(d,g);var k=E(d);F(d,[{key:"dispose",value:function(){var a=this.geometry,b=this.material,c=b.map;this.parent&&this.parent.remove(this);c&&(c.dispose(),b.map=null);a&&(a.dispose(),this.geometry=null);b&&(b.dispose(),this.material=null)}}],[{key:"createGeometry",value:function(){return new e.PlaneBufferGeometry(3E3,3E3,1,1)}},{key:"createMaterial",value:function(){return new e.MeshBasicMaterial({color:0,side:e.DoubleSide,
opacity:0,transparent:!0})}}]);return d}(e.Mesh),v=function(e,d){return d={exports:{}},e(d,d.exports),d.exports}(function(e,d){d=function(){this._tweens={};this._tweensAddedDuringUpdate={}};d.prototype={getAll:function(){return Object.keys(this._tweens).map(function(a){return this._tweens[a]}.bind(this))},removeAll:function(){this._tweens={}},add:function(a){this._tweens[a.getId()]=a;this._tweensAddedDuringUpdate[a.getId()]=a},remove:function(a){delete this._tweens[a.getId()];delete this._tweensAddedDuringUpdate[a.getId()]},
update:function(a,b){var c=Object.keys(this._tweens);if(0===c.length)return!1;for(a=void 0!==a?a:g.now();0<c.length;){this._tweensAddedDuringUpdate={};for(var f=0;f<c.length;f++){var d=this._tweens[c[f]];d&&!1===d.update(a)&&(d._isPlaying=!1,b||delete this._tweens[c[f]])}c=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var g=new d;g.Group=d;g._nextId=0;g.nextId=function(){return g._nextId++};g.now="undefined"===typeof self&&"undefined"!==typeof process&&process.hrtime?function(){var a=process.hrtime();
return 1E3*a[0]+a[1]/1E6}:"undefined"!==typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()};g.Tween=function(a,b){this._object=a;this._valuesStart={};this._valuesEnd={};this._valuesStartRepeat={};this._duration=1E3;this._repeat=0;this._repeatDelayTime=void 0;this._reversed=this._isPlaying=this._yoyo=!1;this._delayTime=0;this._startTime=null;this._easingFunction=g.Easing.Linear.None;
this._interpolationFunction=g.Interpolation.Linear;this._chainedTweens=[];this._onStartCallback=null;this._onStartCallbackFired=!1;this._onStopCallback=this._onCompleteCallback=this._onRepeatCallback=this._onUpdateCallback=null;this._group=b||g;this._id=g.nextId()};g.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(a,b){this._valuesEnd=Object.create(a);void 0!==b&&(this._duration=b);return this},duration:function(a){this._duration=a;return this},
start:function(a){this._group.add(this);this._isPlaying=!0;this._onStartCallbackFired=!1;this._startTime=void 0!==a?"string"===typeof a?g.now()+parseFloat(a):a:g.now();this._startTime+=this._delayTime;for(var b in this._valuesEnd){if(this._valuesEnd[b]instanceof Array){if(0===this._valuesEnd[b].length)continue;this._valuesEnd[b]=[this._object[b]].concat(this._valuesEnd[b])}void 0!==this._object[b]&&(this._valuesStart[b]=this._object[b],!1===this._valuesStart[b]instanceof Array&&(this._valuesStart[b]*=
1),this._valuesStartRepeat[b]=this._valuesStart[b]||0)}return this},stop:function(){if(!this._isPlaying)return this;this._group.remove(this);this._isPlaying=!1;null!==this._onStopCallback&&this._onStopCallback(this._object);this.stopChainedTweens();return this},end:function(){this.update(Infinity);return this},stopChainedTweens:function(){for(var a=0,b=this._chainedTweens.length;a<b;a++)this._chainedTweens[a].stop()},group:function(a){this._group=a;return this},delay:function(a){this._delayTime=a;
return this},repeat:function(a){this._repeat=a;return this},repeatDelay:function(a){this._repeatDelayTime=a;return this},yoyo:function(a){this._yoyo=a;return this},easing:function(a){this._easingFunction=a;return this},interpolation:function(a){this._interpolationFunction=a;return this},chain:function(){this._chainedTweens=arguments;return this},onStart:function(a){this._onStartCallback=a;return this},onUpdate:function(a){this._onUpdateCallback=a;return this},onRepeat:function(a){this._onRepeatCallback=
a;return this},onComplete:function(a){this._onCompleteCallback=a;return this},onStop:function(a){this._onStopCallback=a;return this},update:function(a){var b;if(a<this._startTime)return!0;!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0);var c=(a-this._startTime)/this._duration;c=0===this._duration||1<c?1:c;var f=this._easingFunction(c);for(b in this._valuesEnd)if(void 0!==this._valuesStart[b]){var d=this._valuesStart[b]||
0,e=this._valuesEnd[b];e instanceof Array?this._object[b]=this._interpolationFunction(e,f):("string"===typeof e&&(e="+"===e.charAt(0)||"-"===e.charAt(0)?d+parseFloat(e):parseFloat(e)),"number"===typeof e&&(this._object[b]=d+(e-d)*f))}null!==this._onUpdateCallback&&this._onUpdateCallback(this._object,c);if(1===c)if(0<this._repeat){isFinite(this._repeat)&&this._repeat--;for(b in this._valuesStartRepeat)"string"===typeof this._valuesEnd[b]&&(this._valuesStartRepeat[b]+=parseFloat(this._valuesEnd[b])),
this._yoyo&&(c=this._valuesStartRepeat[b],this._valuesStartRepeat[b]=this._valuesEnd[b],this._valuesEnd[b]=c),this._valuesStart[b]=this._valuesStartRepeat[b];this._yoyo&&(this._reversed=!this._reversed);this._startTime=void 0!==this._repeatDelayTime?a+this._repeatDelayTime:a+this._delayTime;null!==this._onRepeatCallback&&this._onRepeatCallback(this._object)}else{null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);a=0;for(b=this._chainedTweens.length;a<b;a++)this._chainedTweens[a].start(this._startTime+
this._duration);return!1}return!0}};g.Easing={Linear:{None:function(a){return a}},Quadratic:{In:function(a){return a*a},Out:function(a){return a*(2-a)},InOut:function(a){return 1>(a*=2)?.5*a*a:-.5*(--a*(a-2)-1)}},Cubic:{In:function(a){return a*a*a},Out:function(a){return--a*a*a+1},InOut:function(a){return 1>(a*=2)?.5*a*a*a:.5*((a-=2)*a*a+2)}},Quartic:{In:function(a){return a*a*a*a},Out:function(a){return 1- --a*a*a*a},InOut:function(a){return 1>(a*=2)?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)}},Quintic:{In:function(a){return a*
a*a*a*a},Out:function(a){return--a*a*a*a*a+1},InOut:function(a){return 1>(a*=2)?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)}},Sinusoidal:{In:function(a){return 1-Math.cos(a*Math.PI/2)},Out:function(a){return Math.sin(a*Math.PI/2)},InOut:function(a){return.5*(1-Math.cos(Math.PI*a))}},Exponential:{In:function(a){return 0===a?0:Math.pow(1024,a-1)},Out:function(a){return 1===a?1:1-Math.pow(2,-10*a)},InOut:function(a){return 0===a?0:1===a?1:1>(a*=2)?.5*Math.pow(1024,a-1):.5*(-Math.pow(2,-10*(a-1))+2)}},Circular:{In:function(a){return 1-
Math.sqrt(1-a*a)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return 1>(a*=2)?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)}},Elastic:{In:function(a){return 0===a?0:1===a?1:-Math.pow(2,10*(a-1))*Math.sin(5*(a-1.1)*Math.PI)},Out:function(a){return 0===a?0:1===a?1:Math.pow(2,-10*a)*Math.sin(5*(a-.1)*Math.PI)+1},InOut:function(a){if(0===a)return 0;if(1===a)return 1;a*=2;return 1>a?-.5*Math.pow(2,10*(a-1))*Math.sin(5*(a-1.1)*Math.PI):.5*Math.pow(2,-10*(a-1))*Math.sin(5*(a-1.1)*
Math.PI)+1}},Back:{In:function(a){return a*a*(2.70158*a-1.70158)},Out:function(a){return--a*a*(2.70158*a+1.70158)+1},InOut:function(a){return 1>(a*=2)?.5*a*a*(3.5949095*a-2.5949095):.5*((a-=2)*a*(3.5949095*a+2.5949095)+2)}},Bounce:{In:function(a){return 1-g.Easing.Bounce.Out(1-a)},Out:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},InOut:function(a){return.5>a?.5*g.Easing.Bounce.In(2*a):.5*g.Easing.Bounce.Out(2*
a-1)+.5}}};g.Interpolation={Linear:function(a,b){var c=a.length-1,f=c*b,d=Math.floor(f),e=g.Interpolation.Utils.Linear;return 0>b?e(a[0],a[1],f):1<b?e(a[c],a[c-1],c-f):e(a[d],a[d+1>c?c:d+1],f-d)},Bezier:function(a,b){for(var c=0,f=a.length-1,d=Math.pow,e=g.Interpolation.Utils.Bernstein,l=0;l<=f;l++)c+=d(1-b,f-l)*d(b,l)*a[l]*e(f,l);return c},CatmullRom:function(a,b){var c=a.length-1,f=c*b,d=Math.floor(f),e=g.Interpolation.Utils.CatmullRom;return a[0]===a[c]?(0>b&&(d=Math.floor(f=c*(1+b))),e(a[(d-1+
c)%c],a[d],a[(d+1)%c],a[(d+2)%c],f-d)):0>b?a[0]-(e(a[0],a[0],a[1],a[1],-f)-a[0]):1<b?a[c]-(e(a[c],a[c],a[c-1],a[c-1],f-c)-a[c]):e(a[d?d-1:0],a[d],a[c<d+1?c:d+1],a[c<d+2?c:d+2],f-d)},Utils:{Linear:function(a,b,c){return(b-a)*c+a},Bernstein:function(a,b){var c=g.Interpolation.Utils.Factorial;return c(a)/c(b)/c(a-b)},Factorial:function(){var a=[1];return function(b){var c=1;if(a[b])return a[b];for(var f=b;1<f;f--)c*=f;return a[b]=c}}(),CatmullRom:function(a,b,c,f,d){a=.5*(c-a);f=.5*(f-b);var e=d*d;return(2*
b-2*c+a+f)*d*e+(-3*b+3*c-2*a-f)*e+a*d+b}}};e.exports=g}),La=function(g){function d(){C(this,d);var a=k.call(this,d.createGeometry(),d.createMaterial(.7));a.defaultOpacity=.7;a.type=sa.FLOOR;a.enabled=!0;a.visible=!1;a.rotateX(-Math.PI/2);a.scale.set(25,25,25);a.fadeOut=(new v.Tween(a.material)).to({opacity:0});a.fadeIn=(new v.Tween(a.material)).to({opacity:a.defaultOpacity});a.fadeTimeout=null;a.onMove=function(){a.visible?a.show():a.hide()};return a}D(d,g);var k=E(d);F(d,[{key:"show",value:function(){this.visible||
(this.fadeOut.stop(),this.fadeIn.start(),this.visible=!0)}},{key:"hide",value:function(){this.visible&&(this.fadeIn.stop(),this.fadeOut.start(),this.visible=!1)}},{key:"enable",value:function(){this.enabled||(this.fadeOut.stop(),this.fadeIn.start(),this.enabled=this.visible=!0)}},{key:"disable",value:function(){this.enabled&&(this.fadeOut.stop(),this.fadeIn.start(),this.enabled=this.visible=!1)}}],[{key:"createGeometry",value:function(){return new e.RingGeometry(1.4,1,30)}},{key:"createMaterial",
value:function(a){return new e.MeshBasicMaterial({color:16777215,opacity:a,transparent:!0,side:e.DoubleSide})}}]);return d}(e.Mesh),gb=function(g){function d(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:25,b=1<arguments.length?arguments[1]:void 0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};C(this,d);var f=k.call(this);f.hoverOpacity=void 0!==c.opacity?.7*c.opacity:.7;f.defaultOpacity=void 0!==c.opacity?.4*c.opacity:.4;f.baseColor=c.baseColor?new e.Color(c.baseColor):
new e.Color(16777215);f.showTitleHotspotInfospot=void 0!==c.showTitleHotspotInfospot?c.showTitleHotspotInfospot:!1;f.isHiddenDuringTransition=!1;f.options=u({isHide:!1},c);c=new e.TextureLoader;f.type=t.FLOOR_RING_INFOSPOT;f.subtype=t.FLOOR_RING_INFOSPOT;f.animated=void 0!==b?b:!0;f.isHovering=!1;f.element=null;f.toPanorama=null;f.cursorStyle=null;f.mode=z.NORMAL;f.loaded=!1;f.scale.set(a,a,a);f.rotateX(-Math.PI/2);f.container=null;f.originalRaycast=f.raycast;f.HANDLER_FOCUS=null;f.geometry=new e.CircleGeometry(1.4,
30,1,2*Math.PI);f.material.depthTest=!1;f.material.transparent=!0;f.material.opacity=0;f.hoverEnterAnimation=new v.Tween;f.hoverLeaveAnimation=new v.Tween;a=function(a){this.material&&(this.material.color=this.baseColor,this.material.needsUpdate=!0,this.material.alphaMap=a,this.loaded=!0,this.hoverEnterAnimation=(new v.Tween(this.material)).to({opacity:this.hoverOpacity},100),this.hoverLeaveAnimation=(new v.Tween(this.material)).to({opacity:this.defaultOpacity}),this.options.isHide||this.show(100,
!0))}.bind(r(f));f.showAnimation=(new v.Tween(f.material)).to({opacity:f.defaultOpacity},100).onStart(f.enableRaycast.bind(r(f),!0)).easing(v.Easing.Quartic.Out);f.hideAnimation=(new v.Tween(f.material)).to({opacity:0},100).onStart(f.enableRaycast.bind(r(f),!1)).easing(v.Easing.Quartic.Out);f.addEventListener("click",f.onClick);f.addEventListener("hover",f.onHover);f.addEventListener("hoverenter",f.onHoverStart);f.addEventListener("hoverleave",f.onHoverEnd);f.addEventListener("panolens-dual-eye-effect",
f.onDualEyeEffect);f.addEventListener("panolens-container",f.setContainer.bind(r(f)));f.addEventListener("dismiss",f.onDismiss);f.addEventListener("panolens-infospot-focus",f.setFocusMethod);f.addEventListener("parallax-transition-start",f.onTransitionStart.bind(r(f)));f.addEventListener("parallax-transition-complete",f.onTransitionComplete.bind(r(f)));f.addEventListener("not-parallax-transition-start",f.onTransitionStart.bind(r(f)));f.addEventListener("not-parallax-transition-complete",f.onTransitionComplete.bind(r(f)));
c.load("data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiBoZWlnaHQ9IjE0MCIgdmlld0JveD0iMCAwIDE0MCAxNDAiIHdpZHRoPSIxNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0ibTAgMGgxNDB2MTQwaC0xNDB6IiBmaWxsPSIjZmZmIi8+PGNpcmNsZSBjeD0iNzAiIGN5PSI3MCIgZmlsbD0iIzAwMCIgcj0iNTAiLz48L3N2Zz4=",a);return f}D(d,g);var k=E(d);F(d,[{key:"setContainer",value:function(a){if(a instanceof HTMLElement)var b=a;else a&&a.container&&(b=a.container);b&&this.element&&b.append(this.element);this.container=b}},{key:"getContainer",
value:function(){return this.container}},{key:"onClick",value:function(a){this.element&&this.getContainer()&&(this.onHoverStart(a),this.lockHoverElement())}},{key:"onDismiss",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0;this.element&&(this.unlockHoverElement(),this.onHoverEnd(a))}},{key:"onHover",value:function(a){if(this.isVisible&&!this.isHovering)this.onHoverStart(a)}},{key:"onHoverStart",value:function(a){var b=this;if(this.loaded&&!this.isHovering&&this.isVisible&&
this.getContainer()){var c=this.cursorStyle||(this.mode===z.NORMAL?R.POINTER:R.DEFAULT),f=this.hoverEnterAnimation,d=this.hoverLeaveAnimation,e=this.element;this.isHovering=!0;this.container.style.cursor=c;setTimeout(function(){b.container.style.cursor=c},0);this.animated&&(d.stop(),f.start());e&&0<=a.mouseEvent.clientX&&0<=a.mouseEvent.clientY&&(a=e.left,f=e.right,d=e.style,this.mode===z.CARDBOARD||this.mode===z.STEREO?(d.display="none",a.style.display="block",f.style.display="block",e._width=a.clientWidth,
e._height=a.clientHeight):(d.display="block",a&&(a.style.display="none"),f&&(f.style.display="none"),e._width=e.clientWidth,e._height=e.clientHeight))}}},{key:"onHoverEnd",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0;if(this.getContainer()){var b=this.hoverLeaveAnimation,c=this.hoverEnterAnimation,f=this.element;this.isHovering=!1;a&&(this.container.style.cursor=R.GRAB);this.animated&&(c.stop(),b.start());f&&!this.element.locked&&(a=f.left,b=f.right,f.style.display=
"none",a&&(a.style.display="none"),b&&(b.style.display="none"),this.unlockHoverElement())}}},{key:"onDualEyeEffect",value:function(a){if(this.getContainer()){this.mode=a.mode;a=this.element;var b=this.container.clientWidth/2;var c=this.container.clientHeight/2;a&&(a.left||a.right||(a.left=a.cloneNode(!0),a.right=a.cloneNode(!0)),this.mode===z.CARDBOARD||this.mode===z.STEREO?(a.left.style.display=a.style.display,a.right.style.display=a.style.display,a.style.display="none"):(a.style.display=a.left.style.display,
a.left.style.display="none",a.right.style.display="none"),this.translateElement(b,c),this.container.append(a.left),this.container.append(a.right))}}},{key:"translateElement",value:function(a,b){if(this.element&&this.element._width&&this.element._height&&this.getContainer()){var c=this.container;var f=this.element;var d=f._width/2;var e=f._height/2;var g=void 0!==f.verticalDelta?f.verticalDelta:40;var k=a-d;var n=b-e-g;this.mode!==z.CARDBOARD&&this.mode!==z.STEREO||!f.left||!f.right||a===c.clientWidth/
2&&b===c.clientHeight/2?this.setElementStyle("transform",f,"translate(".concat(k,"px, ").concat(n,"px)")):(k=c.clientWidth/4-d+(a-c.clientWidth/2),n=c.clientHeight/2-e-g+(b-c.clientHeight/2),this.setElementStyle("transform",f.left,"translate(".concat(k,"px, ").concat(n,"px)")),k+=c.clientWidth/2,this.setElementStyle("transform",f.right,"translate(".concat(k,"px, ").concat(n,"px)")))}}},{key:"setElementStyle",value:function(a,b,c){b=b.style;"transform"===a&&(b.webkitTransform=b.msTransform=b.transform=
c)}},{key:"setText",value:function(a){this.element&&(this.element.textContent=a)}},{key:"setCursorHoverStyle",value:function(a){this.cursorStyle=a}},{key:"addHoverText",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:40;this.element||(this.element=document.createElement("div"),this.element.style.display="none",this.element.style.color="#fff",this.element.style.top=0,this.element.style.maxWidth="50%",this.element.style.maxHeight="50%",this.element.style.textShadow="0 0 3px #000000",
this.element.style.fontFamily='"Trebuchet MS", Helvetica, sans-serif',this.element.style.position="absolute",this.element.classList.add("panolens-infospot"),this.element.verticalDelta=b);this.setText(a)}},{key:"addHoverElement",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:40;this.element||(this.element=a.cloneNode(!0),this.element.style.display="none",this.element.style.top=0,this.element.style.position="absolute",this.element.classList.add("panolens-infospot"),this.element.verticalDelta=
b)}},{key:"removeHoverElement",value:function(){this.element&&(this.element.left&&(this.element.left.remove(),this.element.left=null),this.element.right&&(this.element.right.remove(),this.element.right=null),this.element.remove(),this.element=null)}},{key:"lockHoverElement",value:function(){this.element&&(this.element.locked=!0)}},{key:"unlockHoverElement",value:function(){this.element&&(this.element.locked=!1)}},{key:"enableRaycast",value:function(){this.raycast=(0<arguments.length&&void 0!==arguments[0]?
arguments[0]:1)?this.originalRaycast:function(){}}},{key:"show",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,b=this.hideAnimation,c=this.showAnimation,f=this.material,d=this.defaultOpacity;this.animated&&this.loaded?(b.stop(),c.delay(a).start()):(this.enableRaycast(!0),f.opacity=d);this.isVisible=!0}},{key:"hide",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,b=this.hideAnimation,c=this.showAnimation,f=this.material;this.animated&&
this.loaded?(c.stop(),b.delay(a).start()):(this.enableRaycast(!1),f.opacity=0);this.isVisible=!1}},{key:"setFocusMethod",value:function(a){a&&(this.HANDLER_FOCUS=a.method)}},{key:"focus",value:function(a,b){this.HANDLER_FOCUS&&(this.HANDLER_FOCUS(this.position,a,b),this.onDismiss())}},{key:"handleAlwaysShowTitle",value:function(a){if(this.showTitleHotspotInfospot){var b=this.element;if(b){var c=b.left,f=b.right,d=b.style;a?(a&&""!==d.transform&&!this.isHiddenDuringTransition?(d.visibility="visible",
d.display="block"):(d.display="block",d.visibility="hidden"),b._width=b.clientWidth,b._height=b.clientHeight):(d.display="none",c&&(c.style.display="none"),f&&(f.style.display="none"))}}}},{key:"onTransitionStart",value:function(){this.hide();this.isHiddenDuringTransition=!0}},{key:"onTransitionComplete",value:function(){this.show();this.isHiddenDuringTransition=!1}},{key:"dispose",value:function(){var a=this.geometry,b=this.material,c=b.map;this.removeHoverElement();this.parent&&this.parent.remove(this);
c&&(c.dispose(),b.map=null);a&&(a.dispose(),this.geometry=null);b&&(b.dispose(),this.material=null)}}]);return d}(e.Mesh),Ma=function(g){function d(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:300,b=1<arguments.length?arguments[1]:void 0,c=2<arguments.length?arguments[2]:void 0,f=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};C(this,d);b=b||L.Info;var h=k.call(this);h.type=t.INFOSPOT;h.subtype=f.isHotspot?t.HOTSPOT:t.INFOSPOT;h.animated=void 0!==c?c:!0;h.isHovering=!1;
h.showTitleHotspotInfospot=void 0!==f.showTitleHotspotInfospot?f.showTitleHotspotInfospot:!1;h.isHiddenDuringTransition=!1;h.maxOpacity=void 0!==f.opacity?1*f.opacity:1;h.minOpacity=0;h.frustumCulled=!1;h.element=null;h.toPanorama=null;h.cursorStyle=null;h.mode=z.NORMAL;h.loaded=!1;h.scale.set(a,a,1);h.rotation.y=Math.PI;h.container=null;h.originalRaycast=h.raycast;h.HANDLER_FOCUS=null;h.material.side=e.DoubleSide;h.material.depthTest=!1;h.material.transparent=!0;h.material.opacity=0;h.visible=!1;
h.shouldRender=!0;h.scaleUpAnimation=new v.Tween;h.scaleDownAnimation=new v.Tween;c=function(b){if(this.material){this.material.map=b;this.material.needsUpdate=!0;this.loaded=this.material.map.needsUpdate=!0;this._parentRatio||(this._parentRatio=1);var c=b.image.width/b.image.height,f=new e.Vector3;b.image.width=b.image.naturalWidth||64;b.image.height=b.image.naturalHeight||64;this.scale.set(c/this._parentRatio*a,a,1);this.material.needsUpdate=!0;this.material.map.needsUpdate=!0;f.copy(this.scale);
this.scaleUpAnimation=(new v.Tween(this.scale)).to({x:1.3*f.x,y:1.3*f.y},500).easing(v.Easing.Elastic.Out);this.scaleDownAnimation=(new v.Tween(this.scale)).to({x:f.x,y:f.y},500).easing(v.Easing.Elastic.Out);this.isHiddenDuringTransition||this.show(500)}}.bind(r(h));h.showAnimation=(new v.Tween(h.material)).to({opacity:h.maxOpacity},500).onStart(h.enableRaycast.bind(r(h),!0)).easing(v.Easing.Quartic.Out);h.hideAnimation=(new v.Tween(h.material)).to({opacity:0},500).onStart(h.enableRaycast.bind(r(h),
!1)).easing(v.Easing.Quartic.Out);h.addEventListener("click",h.onClick);h.addEventListener("hover",h.onHover);h.addEventListener("hoverenter",h.onHoverStart);h.addEventListener("hoverleave",h.onHoverEnd);h.addEventListener("panolens-dual-eye-effect",h.onDualEyeEffect);h.addEventListener("panolens-container",h.setContainer);h.addEventListener("dismiss",h.onDismiss);h.addEventListener("panolens-infospot-focus",h.setFocusMethod);h.addEventListener("parallax-transition-start",h.onTransitionStart.bind(r(h)));
h.addEventListener("parallax-transition-complete",h.onTransitionComplete.bind(r(h)));h.addEventListener("not-parallax-transition-start",h.onTransitionStart.bind(r(h)));h.addEventListener("not-parallax-transition-complete",h.onTransitionComplete.bind(r(h)));W.load(b,c);return h}D(d,g);var k=E(d);F(d,[{key:"setContainer",value:function(a){if(a instanceof HTMLElement)var b=a;else a&&a.container&&(b=a.container);b&&this.element&&b.append(this.element);this.container=b}},{key:"getContainer",value:function(){return this.container}},
{key:"onClick",value:function(a){this.element&&this.getContainer()&&(this.onHoverStart(a),this.lockHoverElement())}},{key:"onDismiss",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0;this.element&&(this.unlockHoverElement(),this.onHoverEnd(a))}},{key:"onHover",value:function(a){if(!this.isHovering)this.onHoverStart(a)}},{key:"onHoverStart",value:function(a){var b=this;if(this.loaded&&this.getContainer()){var c=this.cursorStyle||(this.mode===z.NORMAL?R.POINTER:R.DEFAULT),
f=this.scaleDownAnimation,d=this.scaleUpAnimation,e=this.element;this.isHovering=!0;this.container.style.cursor=c;setTimeout(function(){b.container.style.cursor=c},0);this.animated&&(f.stop(),d.start());e&&0<=a.mouseEvent.clientX&&0<=a.mouseEvent.clientY&&(a=e.left,f=e.right,d=e.style,this.mode===z.CARDBOARD||this.mode===z.STEREO?(d.display="none",a.style.display="block",f.style.display="block",e._width=a.clientWidth,e._height=a.clientHeight):(d.display="block",a&&(a.style.display="none"),f&&(f.style.display=
"none"),e._width=e.clientWidth,e._height=e.clientHeight))}}},{key:"onHoverEnd",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0;if(this.getContainer()){var b=this.scaleDownAnimation,c=this.scaleUpAnimation,f=this.element;this.isHovering=!1;a&&(this.container.style.cursor=R.GRAB);this.animated&&(c.stop(),b.start());f&&!this.element.locked&&(a=f.left,b=f.right,f.style.display="none",a&&(a.style.display="none"),b&&(b.style.display="none"),this.unlockHoverElement())}}},
{key:"onDualEyeEffect",value:function(a){if(this.getContainer()){this.mode=a.mode;a=this.element;var b=this.container.clientWidth/2;var c=this.container.clientHeight/2;a&&(a.left||a.right||(a.left=a.cloneNode(!0),a.right=a.cloneNode(!0)),this.mode===z.CARDBOARD||this.mode===z.STEREO?(a.left.style.display=a.style.display,a.right.style.display=a.style.display,a.style.display="none"):(a.style.display=a.left.style.display,a.left.style.display="none",a.right.style.display="none"),this.translateElement(b,
c),this.container.append(a.left),this.container.append(a.right))}}},{key:"translateElement",value:function(a,b){if(this.element&&this.element._width&&this.element._height&&this.getContainer()){var c=this.container;var f=this.element;var d=f._width/2;var e=f._height/2;var g=void 0!==f.verticalDelta?f.verticalDelta:40;var k=a-d;var n=b-e-g;this.mode!==z.CARDBOARD&&this.mode!==z.STEREO||!f.left||!f.right||a===c.clientWidth/2&&b===c.clientHeight/2?this.setElementStyle("transform",f,"translate(".concat(k,
"px, ").concat(n,"px)")):(k=c.clientWidth/4-d+(a-c.clientWidth/2),n=c.clientHeight/2-e-g+(b-c.clientHeight/2),this.setElementStyle("transform",f.left,"translate(".concat(k,"px, ").concat(n,"px)")),k+=c.clientWidth/2,this.setElementStyle("transform",f.right,"translate(".concat(k,"px, ").concat(n,"px)")))}}},{key:"setElementStyle",value:function(a,b,c){b=b.style;"transform"===a&&(b.webkitTransform=b.msTransform=b.transform=c)}},{key:"setText",value:function(a){this.element&&(this.element.textContent=
a)}},{key:"setCursorHoverStyle",value:function(a){this.cursorStyle=a}},{key:"addHoverText",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:40;this.element||(this.element=document.createElement("div"),this.element.style.display="none",this.element.style.color="#fff",this.element.style.top=0,this.element.style.maxWidth="50%",this.element.style.maxHeight="50%",this.element.style.textShadow="0 0 3px #000000",this.element.style.fontFamily='"Trebuchet MS", Helvetica, sans-serif',
this.element.style.position="absolute",this.element.classList.add("panolens-infospot"),this.element.verticalDelta=b);this.setText(a)}},{key:"addHoverElement",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:40;this.element||(this.element=a.cloneNode(!0),this.element.style.display="none",this.element.style.top=0,this.element.style.position="absolute",this.element.classList.add("panolens-infospot"),this.element.verticalDelta=b)}},{key:"removeHoverElement",value:function(){if(this.element){var a;
if(this.element.left){var b;null===(b=this.container)||void 0===b?void 0:b.removeChild(this.element.left);this.element.left=null}if(this.element.right){var c;null===(c=this.container)||void 0===c?void 0:c.removeChild(this.element.right);this.element.right=null}null===(a=this.container)||void 0===a?void 0:a.removeChild(this.element);this.element=null}}},{key:"lockHoverElement",value:function(){this.element&&(this.element.locked=!0)}},{key:"unlockHoverElement",value:function(){this.element&&(this.element.locked=
!1)}},{key:"enableRaycast",value:function(){this.raycast=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1)?this.originalRaycast:function(){}}},{key:"show",value:function(){var a=this,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,c=this.hideAnimation,f=this.showAnimation,d=this.material,e=this.maxOpacity;this.animated?(c.stop(),f.delay(b).onStart(function(){return a.visible=!0}).start()):(this.enableRaycast(!0),this.visible=!0,d.opacity=e)}},{key:"hide",value:function(){var a=
this,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,c=this.hideAnimation,f=this.showAnimation,d=this.material;this.animated?(f.stop(),c.delay(b).start().onStart(function(){return a.visible=!1})):(this.enableRaycast(!1),this.visible=!1,d.opacity=0)}},{key:"setFocusMethod",value:function(a){a&&(this.HANDLER_FOCUS=a.method)}},{key:"focus",value:function(a,b){this.HANDLER_FOCUS&&(this.HANDLER_FOCUS(this.position,a,b),this.onDismiss())}},{key:"handleAlwaysShowTitle",value:function(a){if(this.showTitleHotspotInfospot){var b=
this.element;if(b){var c=b.left,f=b.right,d=b.style;a?(a&&""!==d.transform&&!this.isHiddenDuringTransition?(d.visibility="visible",d.display="block"):(d.display="block",d.visibility="hidden"),b._width=b.clientWidth,b._height=b.clientHeight):(d.display="none",c&&(c.style.display="none"),f&&(f.style.display="none"))}}}},{key:"onTransitionStart",value:function(){this.hide();this.isHiddenDuringTransition=!0}},{key:"onTransitionComplete",value:function(){this.show();this.isHiddenDuringTransition=!1}},
{key:"dispose",value:function(){var a=this.geometry,b=this.material,c=b.map;this.removeHoverElement();this.parent&&this.parent.remove(this);c&&(c.dispose(),b.map=null);a&&(a.dispose(),this.geometry=null);b&&(b.dispose(),this.material=null)}}]);return d}(e.Sprite),hb=function(g){function d(a){C(this,d);a=u({url:"/public/nadir/nadir-default.png",scale:1,rotation:0,altitude:-199,defaultOpacity:.25,defaultHoverOpacity:.35,rateOfIncrease:100,isDefault:null!==a&&void 0!==a&&a.url?!1:!0},a);var b=k.call(this,
d.createGeometry(a.rateOfIncrease,a.scale),d.createMaterial());b.options=a;b.RATE_OF_INCREASE=1E3;b.DEFAULT_OPACITY=.25;b.DEFAULT_HOVER_OPACITY=.35;b.DEFAULT_NUMBER_OF_SEGMENTS=64;b.url=b.options.url;b.ordinaryScale=b.options.scale;b.defaultOpacity=b.options.defaultOpacity;b.defaultHoverOpacity=b.options.defaultHoverOpacity;b.rateOfIncrease=b.options.rateOfIncrease;b.isDefault=b.options.isDefault;b.geometry=new e.PlaneGeometry(b.rateOfIncrease*b.ordinaryScale,b.rateOfIncrease*b.ordinaryScale);b.setNadirProportions=
function(a,b){var c=b.image;b=c.width;c=c.height;b>c&&a.scale(1,c/b,1);b<c&&a.scale(b/c,1,1)};b.material=new e.MeshBasicMaterial;(new e.TextureLoader).load(b.url,function(a){b.setNadirProportions(b.geometry,a);b.material.map=a;b.material.needsUpdate=!0});b.material.transparent=!0;b.material.side=e.DoubleSide;b.rotation.x=-Math.PI/2;b.rotation.y=Math.PI;b.rotation.z=b.options.rotation/180*Math.PI;b.position.y=b.options.altitude;b.type=t.NADIR;b.addEventListener("parallax-transition-start",b.onParallaxTransitionStart.bind(r(b)));
b.addEventListener("parallax-transition-complete",b.onParallaxTransitionComplete.bind(r(b)));return b}D(d,g);var k=E(d);F(d,[{key:"setIsDefault",value:function(a){this.isDefault=!0;this.material.opacity=.25;this.changeTexture(a)}},{key:"setIsNotDefault",value:function(){this.isDefault=!1;this.material.opacity=1}},{key:"changeScale",value:function(a){this.ordinaryScale=a;this.geometry=new e.PlaneGeometry(this.rateOfIncrease*this.ordinaryScale,this.rateOfIncrease*this.ordinaryScale);this.setNadirProportions(this.geometry,
this.material.map)}},{key:"changeRotation",value:function(a){this.rotation.z=a/180*Math.PI}},{key:"changeTexture",value:function(a){var b=this;(new e.TextureLoader).load(a,function(a){b.geometry=new e.PlaneGeometry(b.rateOfIncrease*b.ordinaryScale,b.rateOfIncrease*b.ordinaryScale);b.setNadirProportions(b.geometry,a);b.material.map=a;b.material.needsUpdate=!0},function(a){console.log("".concat(a.loaded/a.total*100,"% loaded"))},function(a){console.log("An error happened".concat(a))})}},{key:"hide",
value:function(){this.material.opacity=0}},{key:"show",value:function(){this.material.opacity=this.isDefault?this.defaultOpacity:1}},{key:"onParallaxTransitionStart",value:function(){this.hide()}},{key:"onParallaxTransitionComplete",value:function(){this.show()}}],[{key:"createGeometry",value:function(a,b){return new e.PlaneGeometry(a*b,a*b)}},{key:"createMaterial",value:function(){return new e.MeshBasicMaterial}}]);return d}(e.Mesh),ib={tEquirect:{value:new e.Texture},repeat:{value:new e.Vector2(1,
1)},offset:{value:new e.Vector2(0,0)},opacity:{value:1}},S=function(g){function d(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:d.createGeometry();var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:d.createMaterial();C(this,d);a=k.call(this,a,b);a.type=m.PANORAMA;a.ImageQualityLow=1;a.ImageQualityFair=2;a.ImageQualityMedium=3;a.ImageQualityHigh=4;a.ImageQualitySuperHigh=5;a.animationDuration=1E3;a.defaultInfospotSize=350;a.container=void 0;a.loaded=!1;a.linkedSpots=[];a.isInfospotVisible=
!1;a.linkingImageURL=void 0;a.linkingImageScale=void 0;a.scale.x*=-1;a.renderOrder=-1;a.visible=!1;a.active=!1;a.infospotAnimation=(new v.Tween(r(a))).to({},a.animationDuration/2);a.addEventListener("panolens-container",a.setContainer.bind(r(a)));a.addEventListener("click",a.onClick.bind(r(a)));a.addEventListener("parallax-transition-start",a.onParallaxTransitionStart.bind(r(a)));a.addEventListener("parallax-transition-complete",a.onParallaxTransitionComplete.bind(r(a)));a.addEventListener("not-parallax-transition-start",
a.onNotParallaxTransitionStart.bind(r(a)));a.addEventListener("not-parallax-transition-complete",a.onNotParallaxTransitionComplete.bind(r(a)));a.setupTransitions();return a}D(d,g);var k=E(d);F(d,[{key:"add",value:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}a.type!==t.INFOSPOT&&a.subtype!==t.FLOOR_RING_INFOSPOT||this.dispatchInfospotListeners(a);A(w(d.prototype),"add",this).call(this,a);this.dispatchEvent({type:"addChild"})}},{key:"dispatchInfospotListeners",
value:function(a){var b=this.container;b&&a.dispatchEvent({type:"panolens-container",container:b});a.dispatchEvent({type:"panolens-infospot-focus",method:function(a,b,d){this.dispatchEvent({type:"panolens-viewer-handler",method:"tweenControlCenter",data:[a,b,d]})}})}},{key:"getTexture",value:function(){return this.material.uniforms.tEquirect.value}},{key:"load",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0;this.dispatchEvent({type:"load-start"});if(a)this.onLoad()}},
{key:"onClick",value:function(a){a.intersects&&0===a.intersects.length&&this.traverse(function(a){a.dispatchEvent({type:"dismiss"})})}},{key:"setContainer",value:function(a){if(a instanceof HTMLElement)var b=a;else a&&a.container&&(b=a.container);if(b){var c=function(a){(a.type===t.INFOSPOT&&a.dispatchEvent||a.subtype===t.FLOOR_RING_INFOSPOT&&a.dispatchEvent)&&a.dispatchEvent({type:"panolens-container",container:b})};this.children.forEach(function(a){c(a);a.subtype===t.SPOT_MODEL&&a.children.forEach(function(a){return c(a)})});
this.container=b}}},{key:"onLoad",value:function(){this.loaded=!0;this.dispatchEvent({type:"loaded"});this.dispatchEvent({type:"ready"})}},{key:"onProgress",value:function(a){this.dispatchEvent({type:"progress",progress:a})}},{key:"onError",value:function(){this.dispatchEvent({type:"error"})}},{key:"getZoomLevel",value:function(){return 800>=window.innerWidth?this.ImageQualityFair:800<window.innerWidth&&1280>=window.innerWidth?this.ImageQualityMedium:1280<window.innerWidth&&1920>=window.innerWidth?
this.ImageQualityHigh:1920<window.innerWidth?this.ImageQualitySuperHigh:this.ImageQualityLow}},{key:"updateTexture",value:function(a){var b=this.material.uniforms.tEquirect.value;b.needsUpdate=!1;a.needsUpdate=!0;this.material.uniforms.tEquirect.value=a;requestAnimationFrame(function(){return null===b||void 0===b?void 0:b.dispose()})}},{key:"toggleInfospotVisibility",value:function(a,b){var c=this;b=void 0!==b?b:0;var f=void 0!==a?a:!this.isInfospotVisible;this.traverse(function(a){if(a.type===t.INFOSPOT||
a.subtype===t.FLOOR_RING_INFOSPOT)f?a.show(b):a.hide(b)});this.isInfospotVisible=f;this.infospotAnimation.onComplete(function(){c.dispatchEvent({type:"infospot-animation-complete",visible:f})}).delay(b).start()}},{key:"reset",value:function(){this.children.length=0}},{key:"setupTransitions",value:function(){var a=this;this.fadeInAnimation=new v.Tween;this.fadeOutAnimation=new v.Tween;this.enterTransition=(new v.Tween(this)).easing(v.Easing.Quartic.Out).onComplete(function(){a.dispatchEvent({type:"enter-complete"})}).start();
this.leaveTransition=(new v.Tween(this)).easing(v.Easing.Quartic.Out)}},{key:"fadeIn",value:function(){var a,b=this,c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.animationDuration,f=(null===(a=this.material.uniforms)||void 0===a?void 0:a.opacity)||{value:0};this.fadeOutAnimation.stop();this.fadeInAnimation=(new v.Tween(f)).to({value:1},c).easing(v.Easing.Quartic.Out).onStart(function(){b.visible=!0;b.dispatchEvent({type:"enter-fade-start"})}).onComplete(function(){b.toggleInfospotVisibility(!0,
c/2);b.dispatchEvent({type:"enter-fade-complete"})}).start()}},{key:"fadeOut",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.animationDuration,b=this.material.uniforms.opacity,c=function(){this.visible=!1;this.dispatchEvent({type:"leave-complete"})}.bind(this);this.fadeInAnimation.stop();this.fadeOutAnimation=(new v.Tween(b)).to({value:0},a).easing(v.Easing.Quartic.Out).onComplete(c).start()}},{key:"onEnter",value:function(){var a=this,b=this.animationDuration;
this.dispatchEvent({type:"enter"});this.leaveTransition.stop();this.enterTransition.to({},b).onStart(function(){a.dispatchEvent({type:"enter-start"});a.loaded?a.dispatchEvent({type:"ready"}):a.load()}).start();this.children.forEach(function(a){a.dispatchEvent({type:"panorama-enter"});a.subtype===t.SPOT_MODEL&&a.children.forEach(function(a){return a.dispatchEvent({type:"panorama-enter"})})});this.active=!0}},{key:"onLeave",value:function(){var a=this,b=this.animationDuration;this.enterTransition.stop();
this.leaveTransition.to({},b).onStart(function(){a.dispatchEvent({type:"leave-start"});a.fadeOut(b);a.toggleInfospotVisibility(!1)}).start();this.dispatchEvent({type:"leave"});this.traverse(function(a){return a.dispatchEvent({type:"panorama-leave"})});this.active=!1}},{key:"onParallaxTransitionComplete",value:function(){var a;null===(a=this.children)||void 0===a?void 0:a.map(function(a){a.dispatchEvent({type:"parallax-transition-complete"})})}},{key:"onParallaxTransitionStart",value:function(){var a;
null===(a=this.children)||void 0===a?void 0:a.map(function(a){a.dispatchEvent({type:"parallax-transition-start"})})}},{key:"onNotParallaxTransitionComplete",value:function(){var a;null===(a=this.children)||void 0===a?void 0:a.map(function(a){a.dispatchEvent({type:"not-parallax-transition-complete"})})}},{key:"onNotParallaxTransitionStart",value:function(){var a;null===(a=this.children)||void 0===a?void 0:a.map(function(a){a.dispatchEvent({type:"not-parallax-transition-start"})})}},{key:"dispose",
value:function(){function a(b){for(var c=b.geometry,d=b.material,e=b.type,g=b.subtype,k=b.children.length-1;0<=k;k--)a(b.children[k]),b.remove(b.children[k]);e!==t.INFOSPOT&&g!==t.FLOOR_RING_INFOSPOT&&g!==t.SPOT_MODEL||b.dispose();null!==c&&void 0!==c&&c.dispose&&(c.dispose(),b.geometry=null);null!==d&&void 0!==d&&d.dispose&&(d.dispose(),b.material=null)}var b=this.material;b&&b.uniforms&&b.uniforms.tEquirect&&b.uniforms.tEquirect.value.dispose();this.material=this.container=this.src=null;this.infospotAnimation.stop();
this.fadeInAnimation.stop();this.fadeOutAnimation.stop();this.enterTransition.stop();this.leaveTransition.stop();this.dispatchEvent({type:"on-panorama-dispose",data:this});a(this);this.parent&&this.parent.remove(this)}}],[{key:"createGeometry",value:function(){return new e.SphereBufferGeometry(5050,100,80)}},{key:"createMaterial",value:function(){var a=e.UniformsUtils.clone(ib);a.opacity.value=0;return new e.ShaderMaterial({fragmentShader:"\n        uniform sampler2D tEquirect;\n        uniform vec2 repeat;\n        uniform vec2 offset;\n        uniform float opacity;\n        varying vec3 vWorldDirection;\n        #include <common>\n        void main() {\n            vec3 direction = normalize( vWorldDirection );\n            vec2 sampleUV;\n            sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n            sampleUV.x = atan( -direction.z, -direction.x ) * RECIPROCAL_PI2 + 0.5;\n            sampleUV *= repeat;\n            sampleUV += offset;\n            sampleUV.x = fract(sampleUV.x);\n            sampleUV.y = fract(sampleUV.y);\n            gl_FragColor = vec4(texture2D( tEquirect, sampleUV ).rgb, opacity);\n        }\n    ",
vertexShader:"\n        varying vec3 vWorldDirection;\n        #include <common>\n        void main() {\n            vWorldDirection = transformDirection( position, modelMatrix );\n            #include <begin_vertex>\n            #include <project_vertex>\n        }\n    ",uniforms:a,side:e.BackSide,transparent:!0})}}]);return d}(e.Mesh),Na={tEquirect:{type:"t",value:new e.Texture},depthTexture:{type:"t",value:null},opacity:{type:"f",value:1},displacement:{type:"f",value:3E3},offset:{type:"v2",value:new e.Vector2(0,
0)},pointSize:{type:"f",value:3},debugDepth:{type:"f",value:0},repeat:{type:"v2",value:new e.Vector2(1,1)}},ua=function(g){function d(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:d.createMaterial();var f=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};C(this,d);c=k.call(this,b,c);c.subtype=m.IMAGE;c.options=u({onInitialLoadedFinished:function(){},depthmapUrl:""},f);c.src=a;c.floorPlane=null;return c}D(d,g);var k=E(d);F(d,[{key:"load",value:function(a){var b=this;A(w(d.prototype),
"load",this).call(this,!1);(a=a||this.src)?"string"===typeof a?ja.load([a,this.options.depthmapUrl],this.onLoad.bind(this),this.onProgress.bind(this),this.onError.bind(this)):a instanceof HTMLImageElement&&ja.load([this.options.depthmapUrl],function(c){var f=ja.createAndSetupTexture({image:a,isBadUrl:!1});b.onLoad([f,c[0]])},this.onProgress.bind(this),this.onError.bind(this)):console.warn("Image source undefined")}},{key:"loadDepthmap",value:function(a){a&&"string"===typeof a&&W.load(a,this.onDepthmapLoad.bind(this),
this.onProgress.bind(this),this.onError.bind(this))}},{key:"onLoad",value:function(a){this.updateTexture(a[0]);this.onDepthmapLoad(a[1]);this.finishLoading()}},{key:"finishLoading",value:function(){var a;window.requestAnimationFrame(A(w(d.prototype),"onLoad",this).bind(this));null!==(a=this.options)&&void 0!==a&&a.onInitialLoadedFinished&&window.requestAnimationFrame(this.options.onInitialLoadedFinished)}},{key:"onDepthmapLoad",value:function(a){this.material.uniforms.depthTexture.value=a}},{key:"add",
value:function(a){if(1<arguments.length){var b=da(arguments),c;try{for(b.s();!(c=b.n()).done;)this.add(c.value)}catch(f){b.e(f)}finally{b.f()}return this}a instanceof O&&(this.floorPlane=a);A(w(d.prototype),"add",this).call(this,a)}},{key:"addFloorPlane",value:function(){this.floorPlane&&this.floorPlane instanceof O||(this.floorPlane=new O,this.add(this.floorPlane))}},{key:"removeFloorPlane",value:function(){this.floorPlane&&this.floorPlane instanceof O&&(this.floorPlane.dispose(),this.floorPlane=
null)}},{key:"dispose",value:function(){e.Cache.remove(this.src);this.floorPlane=null;A(w(d.prototype),"dispose",this).call(this)}}],[{key:"createMaterial",value:function(){var a=e.UniformsUtils.clone(Na);a.opacity.value=0;return new e.ShaderMaterial({fragmentShader:"\n        // Uniforms\n        uniform sampler2D tEquirect;\n        uniform sampler2D depthTexture;\n        uniform float debugDepth;\n        uniform float opacity;\n        uniform vec2 offset;\n\n        // Varyings from vertex program\n        varying vec2 vUv;\n\n        // Internal\n        vec3 depth;\n        vec3 color;\n\n        void main() {\n\n            vec2 uvOffset = fract(vUv + offset);\n\n            depth = texture2D(depthTexture, uvOffset).rgb;\n            color = texture2D(tEquirect, uvOffset).rgb;\n\n            // Mix the depth and color based on debugDepth value\n            vec3 depthColorMixer = mix(color, depth , debugDepth);\n\n            // Render dat fragment\n            gl_FragColor = vec4(depthColorMixer, opacity);\n        }\n    ",
vertexShader:"\n        // Uniforms\n        uniform sampler2D tEquirect;\n        uniform sampler2D depthTexture;\n        uniform float pointSize;\n        uniform float displacement;\n\n        // Varyings passed to fragment\n        varying vec2 vUv;\n\n        // Internal\n        vec3 depthRgb;\n        float depth;\n\n        void main() {\n\n            /** Transform and pass to fragment shader */\n            vUv = uv;\n\n            /** Set the GL point size for when rendering points, ignored otherwise */\n            gl_PointSize = pointSize;\n\n            depthRgb = texture2D(depthTexture, vUv).rgb;\n            depth = depthRgb.r;\n\n\n            /** \n            * Invert the normals (since they are pointing outwards) and \n            * move the position on the normal direction scaled by the \n            * displacement which is the depth for the current vertex\n            * multiplied by a 'displacement' scalaer\n            **/\n            float disp = displacement * depth;\n            vec3 offset = position + (-normal) * disp;\n\n            /** Transform */\n            gl_Position = projectionMatrix *\n                            modelViewMatrix *\n                            vec4(offset, 1.0);\n        }\n    ",
uniforms:a,side:e.BackSide,transparent:!0})}}]);return d}(S),jb=function(g){function d(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};C(this,d);var c=k.call(this,d.createGeometry(),d.createMaterial());c.options=u({},b);c.container=a;c.passThrough=!0;c.subtype=V.SPOT_SPHERE;return c}D(d,g);var k=E(d);F(d,[{key:"dispose",value:function(){var a=this.geometry,b=this.material;a&&(a.dispose(),this.geometry=null);b&&(b.dispose(),this.material=null)}}],[{key:"createGeometry",value:function(){return new e.SphereBufferGeometry(5050,
8,4)}},{key:"createMaterial",value:function(){var a=new e.MeshBasicMaterial({color:302836,transparent:!0,opacity:0});a.side=e.BackSide;return a}}]);return d}(e.Mesh),va={tilesByEdge:1,level:0,prefix:"low"},ba={tilesByEdge:2,level:1,prefix:"med"},wa={tilesByEdge:4,level:2,prefix:"high"},kb="px nx py ny pz nz".split(" "),Oa=new e.Frustum,Pa=new e.Matrix4,xa=new e.Vector3,lb=function(g){function d(a){var b=a.blob,c=a.tileSourceFolder,f=a.qualityLevel,h=a.renderer,g=a.camera;C(this,d);a=k.call(this,d.createGeometry(),
d.createMaterial());a.subtype=m.PROGRESSVIE_IMAGE;a.srcTexture=new e.Texture(b);a.tileSourceFolder=c;a.renderer=h;a.camera=g;a.spotModel=new jb(a.container);a.spotModel.position.set(0,0,0);a.add(a.spotModel);a.tilesUploadingToGPU=0;a.tilesByEdge=null;a.segmentsByTile=null;a.renderedTiles=0;a.currentQuality=f===va.level?va:ba;a.maxQualityLevel=f;a._calculateTilesAndFaces(a.currentQuality);a.queue=new Map;a.loader=new e.ImageBitmapLoader;a.loader.setOptions({imageOrientation:"flipY"});a.floorPlane=
null;a.addEventListener("fov",a._handleFovChange);return a}D(d,g);var k=E(d);F(d,[{key:"onLoad",value:function(){A(w(d.prototype),"onLoad",this).call(this);this._setTexture(this.srcTexture);this.geometry.setAttribute("uv",this.geometry.getAttribute("originaluv").clone());this.previewTextureLoaded=!0}},{key:"refresh",value:function(){if(!(3<=this.tilesUploadingToGPU)&&this.geometry&&this.previewTextureLoaded){this.camera.updateMatrixWorld();Pa.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse);
Oa.setFromProjectionMatrix(Pa);for(var a=this.geometry.getAttribute("position"),b=[],c=0;6>c;c++)for(var f=0;f<this.tilesByEdge;f++)for(var d=0;d<this.tilesByEdge;d++){var g=[],l=384*c+f*this.segmentsByTile*48+d*this.segmentsByTile*6,k=l+48*(this.segmentsByTile-1)+1;g.push(l,k,k+6*this.segmentsByTile-3,l+6*this.segmentsByTile-1);if(4<=this.segmentsByTile){var n=l+48*(this.segmentsByTile/2-1)+1;g.push(l+this.segmentsByTile/2*6-1,k+this.segmentsByTile/2*6-3,n,n+6*this.segmentsByTile-3,n+this.segmentsByTile/
2*6)}g.some(function(b){xa.set(-a.getX(b),a.getY(b),a.getZ(b));return Oa.containsPoint(xa)})&&(g=new e.Vector3(-1,0,0),g=xa.angleTo(g),b.push({face:c,col:d,row:f,angle:g,level:this.currentQuality.level}))}this._loadTiles(b)}}},{key:"_handleFovChange",value:function(){60>this.camera.fov&&this.currentQuality.level<=ba.level?this.maxQualityLevel<wa.level||(this.currentQuality=wa,this._calculateTilesAndFaces(wa)):75>this.camera.fov&&this.currentQuality.level<=va.level&&!(this.maxQualityLevel<ba.level)&&
(this.currentQuality=ba,this._calculateTilesAndFaces(ba))}},{key:"_calculateTilesAndFaces",value:function(a){this.tilesByEdge=a=a.tilesByEdge;this.segmentsByTile=8/a}},{key:"_setTexture",value:function(a){var b=this.geometry.getAttribute("uv");a?(a.needsUpdate=!0,a=new e.MeshBasicMaterial({map:a,side:e.BackSide})):a=new e.MeshBasicMaterial({opacity:0,transparent:!0});for(var c=0;384>c;c++)this.material.push(a);b.needsUpdate=!0}},{key:"_loadTiles",value:function(a){var b=this;a.forEach(function(a){setTimeout(Ua(regeneratorRuntime.mark(function h(){var c,
d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c=b._tileId(a);d=b.queue.get(c);if(null===d||void 0===d||!d.uploaded){e.next=4;break}return e.abrupt("return");case 4:if(!d){e.next=8;break}b.queue.set(c,u(u({},d),{},{priority:a.angle}));e.next=11;break;case 8:return b.queue.set(c,{priority:a.angle,uploaded:!1}),e.next=11,b._loadTile(a);case 11:case "end":return e.stop()}},h)})))})}},{key:"_tileUrl",value:function(a,b,c){var f=this.tileSourceFolder;b="00".concat(c*this.currentQuality.tilesByEdge+
b).slice(-2);return"".concat(f,"/").concat(this.currentQuality.prefix,"-").concat(a,"-").concat(b,".jpg")}},{key:"_tileId",value:function(a){return"".concat(a.level,"-").concat(a.face,":").concat(a.col,"-").concat(a.row,"111")}},{key:"_loadTile",value:function(a){var b=this;this.renderedTiles++;var c=this._tileUrl(kb[a.face],a.col,a.row);this.tilesUploadingToGPU+=1;return(new Promise(function(a,d){b.loader.load(c,a,void 0,d)})).then(function(c){setTimeout(function(){--b.tilesUploadingToGPU;var d=
new e.Texture(c);d.minFilter=d.magFilter=e.LinearFilter;b.renderer.initTexture(d);d.needsUpdate=!0;d=new e.MeshBasicMaterial({map:d,side:e.BackSide});b._swapMaterial(a.face,a.col,a.row,d);b.queue.set(b._tileId(a),{uploaded:!0})},0)})["catch"](function(){--b.tilesUploadingToGPU})}},{key:"_swapMaterial",value:function(a,b,c,d){for(var f=this,e=this.geometry.getAttribute("uv"),g=0;g<this.segmentsByTile;g++)for(var k=function(h){var k=384*a+6*(8*(c*f.segmentsByTile+g)+(b*f.segmentsByTile+h)),l=f.geometry.groups.find(function(a){return a.start===
k}).materialIndex;d.map.needsUpdate=!0;d.needsUpdate=!0;f.material[l]=d;f.material.needsUpdate=!0;l=1-g/f.segmentsByTile;var n=1-(g+1)/f.segmentsByTile,m=h/f.segmentsByTile;h=(h+1)/f.segmentsByTile;e.setXY(k,m,l);e.setXY(k+1,m,n);e.setXY(k+2,h,l);e.setXY(k+3,m,n);e.setXY(k+4,h,n);e.setXY(k+5,h,l)},n=0;n<this.segmentsByTile;n++)k(n);e.needsUpdate=!0}},{key:"handleEndOfTransition",value:function(){this.loadOtherTiles();this.removeEventListener("preview-texture-ready",this.handleEndOfTransition)}},{key:"dispose",
value:function(){delete this.srcTexture;delete this.loader;this.tilesUploadingToGPU=null;this.material.forEach(function(a){var b;null===a||void 0===a?void 0:null===(b=a.map)||void 0===b?void 0:b.dispose()});this.material.length=0;A(w(d.prototype),"dispose",this).call(this)}},{key:"addFloorPlane",value:function(){this.floorPlane&&this.floorPlane.subtype===V.FLOOR_PLANE||(this.floorPlane=new O,this.add(this.floorPlane))}},{key:"removeFloorPlane",value:function(){this.floorPlane&&this.floorPlane.subtype===
V.FLOOR_PLANE&&(this.floorPlane.dispose(),this.floorPlane=null)}}],[{key:"createMaterial",value:function(){return[]}},{key:"createGeometry",value:function(){var a=(new e.BoxBufferGeometry(12E3,12E3,12E3,8,8,8)).toNonIndexed();a.clearGroups();for(var b=0,c=0;2304>b;b+=6)a.addGroup(b,6,c++);b=a.attributes.position.array;c=a.attributes.uv.array;for(var d=0;d<b.length/3;d++){var h=b[3*d]/6E3,g=b[3*d+1]/6E3,k=b[3*d+2]/6E3,m=Math.sqrt(1/(Math.pow(h,2)+Math.pow(g,2)+Math.pow(k,2)));h*=m;g*=m;k*=m;m=Math.asin(g);
g=Math.atan2(h,k);0===h&&0>k&&(h=Math.floor(d/3),0>b[9*h]||0>b[9*(h+1)]||0>b[9*(h+2)])&&(g=-Math.PI);h=(m+Math.PI/2)/Math.PI;c[2*d]=(.5+(g+Math.PI)/(2*Math.PI))%1;c[2*d+1]=h}a.rotateY(-Math.PI/2);a.setAttribute("originaluv",a.getAttribute("uv").clone());return a}}]);return d}(S),mb={tEquirect:{value:new e.Texture},repeat:{value:new e.Vector2(1,1)},offset1:{value:new e.Vector2(0,0)},offset2:{value:new e.Vector2(0,0)},opacity:{value:1},tDiffuse1:{value:new e.Texture},tDiffuse2:{value:new e.Texture},
mixRatio:{value:0}},nb={tEquirect:{value:new e.Texture},repeat:{value:new e.Vector2(1,1)},opacity:{value:1},tDiffuse1:{value:new e.Texture},tDiffuse2:{value:new e.Texture},mixRatio:{value:0}},ka=window.navigator.userAgent||window.navigator.vendor||window.opera,ob=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(ka)||
/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(ka.substr(0,
4)),la=/(android)/i.test(ka),pb=/^((?!chrome|android).)*safari/i.test(ka),ma={xl:1200,lg:992,lgm:812,md:768,mdm:680,sm:576,smm:550,xs:450,xsm:375,xxs:320};Object.keys(ma).reduce(function(e,d){e[d]="min-width: ".concat(ma[d],"px");return e},{});Object.keys(ma).reduce(function(e,d){e[d]="max-width: ".concat(ma[d]-.02,"px");return e},{});var qb=function(e){var d=e.width;d=void 0===d?32:d;var g=e.height,a=void 0===g?32:g;e=e.color;e=void 0===e?"#A9AFBB":e;g=document.createElementNS("http://www.w3.org/2000/svg",
"svg");g.setAttributeNS(null,"viewBox","0 0 ".concat(d," ").concat(a));g.setAttributeNS(null,"width",d);g.setAttributeNS(null,"height",a);d=document.createElementNS("http://www.w3.org/2000/svg","circle");d.setAttributeNS(null,"cx","16");d.setAttributeNS(null,"cy","16");d.setAttributeNS(null,"r","15.5");d.setAttributeNS(null,"fill","white");d.setAttributeNS(null,"stroke",e);d.classList.add("resizer-svg-circle");a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttributeNS(null,"d",
"M7.44326 17.1666C6.70049 16.5662 6.70049 15.4338 7.44326 \n    14.8334L11.0571 11.9124C12.038 11.1196 13.5 11.8177 13.5 13.079V18.921C13.5 \n    20.1823 12.038 20.8804 11.0571 20.0876L7.44326 17.1666Z");a.setAttributeNS(null,"fill",e);a.classList.add("resizer-svg-left-arrow");var b=document.createElementNS("http://www.w3.org/2000/svg","path");b.setAttributeNS(null,"d","M24.5567 17.1666C25.2995 16.5662 25.2995 15.4338 24.5567 \n    14.8334L20.9429 11.9124C19.962 11.1196 18.5 11.8177 18.5 13.079V18.921C18.5 \n    20.1823 19.962 20.8804 20.9429 20.0876L24.5567 17.1666Z");
b.setAttributeNS(null,"fill",e);b.classList.add("resizer-svg-right-arrow");g.appendChild(d);g.appendChild(a);g.appendChild(b);return g},rb=function(e){var d=e.width;d=void 0===d?24:d;var g=e.height;g=void 0===g?24:g;e=e.color;e=void 0===e?"#FFFFFF":e;var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttributeNS(null,"viewBox","0 0 ".concat(d," ").concat(g));a.setAttributeNS(null,"width",d);a.setAttributeNS(null,"height",g);a.setAttributeNS(null,"fill","none");d=document.createElementNS("http://www.w3.org/2000/svg",
"path");d.setAttributeNS(null,"d","M9.27209 4.43149L9.99768 4.62126V4.62126L9.27209 4.43149ZM6.80797 5.85415L7.00642\n  5.13088H7.00642L6.80797 5.85415ZM4.08013 10.5789L4.60727 10.0454L4.08013 10.5789ZM4.08013 13.4242L4.60727\n  13.9577H4.60727L4.08013 13.4242ZM6.80797 18.149L6.60952 17.4257H6.60952L6.80797 18.149ZM9.27209 19.5716L8.54649\n  19.7614L9.27209 19.5716ZM14.7278 19.5716L15.4534 19.7614H15.4534L14.7278 19.5716ZM17.1919 18.149L17.3903\n  17.4257H17.3903L17.1919 18.149ZM19.9197 13.4242L19.3926 13.9577L19.9197 13.4242ZM19.9197 10.5789L19.3926\n  10.0454L19.3926 10.0454L19.9197 10.5789ZM17.1919 5.85415L16.9934 5.13088L17.1919 5.85415ZM14.7278\n  4.43149L15.4534 4.24171V4.24171L14.7278 4.43149ZM19.6049 6.30563L20.2049 5.85564L19.6049 6.30563ZM17.6918\n  5.71699L17.4933 4.99372L17.6918 5.71699ZM20.2904 10.2126L20.8176 10.7461L20.2904 10.2126ZM20.7367\n  8.26279L21.4261 7.9675L20.7367 8.26279ZM20.7355 15.7399L20.0462 15.4444L20.7355 15.7399ZM20.2895\n  13.7896L19.7623 14.3231L20.2895 13.7896ZM19.6025 17.6975L20.2024 18.1478L19.6025 17.6975ZM13.129\n  21.4336L13.0408 20.6888L13.129 21.4336ZM14.597 20.0716L13.8714 19.8819L14.597 20.0716ZM4.3974\n  17.6975L3.79758 18.1477L4.3974 17.6975ZM3.71047 13.7895L3.18332 13.256L3.71047 13.7895ZM6.30819\n  5.71702L6.10974 6.44029L6.30819 5.71702ZM4.39504 6.30566L4.99505 6.75565L4.39504 6.30566ZM9.40285\n  20.0716L8.67726 20.2614L9.40285 20.0716ZM9.4037 3.92827L10.1293 4.11804L9.4037 3.92827ZM3.70951\n  10.2127L3.18236 10.7462L3.70951 10.2127ZM14.5962 3.92826L15.3218 3.73849L14.5962 3.92826ZM12\n  3.25C12.3522 3.25 12.6992 3.27077 13.0399 3.31108L13.2161 1.82147C12.817 1.77425 12.4112 1.75\n  12 1.75V3.25ZM10.9599 3.3111C11.3007 3.27077 11.6478 3.25 12 3.25V1.75C11.5887 1.75 11.1828 1.77426\n  10.7837 1.82149L10.9599 3.3111ZM8.6781 3.7385L8.54649 4.24172L9.99768 4.62126L10.1293 4.11804L8.6781\n  3.7385ZM8.54649 4.24172C8.37033 4.91527 7.67782 5.31509 7.00642 5.13088L6.60952 6.57741C8.08659 6.98269\n  9.61012 6.10308 9.99768 4.62126L8.54649 4.24172ZM7.00642 5.13088L6.50664 4.99375L6.10974 6.44029L6.60952\n  6.57741L7.00642 5.13088ZM3.95269 8.55818C4.22855 7.91411 4.57963 7.30957 4.99505 6.75565L3.79504\n  5.85567C3.30872 6.50412 2.89731 7.21238 2.57384 7.96761L3.95269 8.55818ZM3.18236 10.7462L3.55298\n  11.1124L4.60727 10.0454L4.23665 9.67921L3.18236 10.7462ZM3.55298 11.1124C4.04822 11.6017 4.04822\n  12.4014 3.55298 12.8907L4.60727 13.9577C5.69679 12.8812 5.69679 11.122 4.60727 10.0454L3.55298\n  11.1124ZM3.55298 12.8907L3.18332 13.256L4.23761 14.323L4.60727 13.9577L3.55298 12.8907ZM4.99723\n  17.2472C4.58138 16.6932 4.22992 16.0886 3.95374 15.4443L2.57507 16.0353C2.89892 16.7907 3.31077\n  17.4992 3.79758 18.1477L4.99723 17.2472ZM6.50857 19.0089L7.00642 18.8723L6.60952 17.4257L6.11167\n  17.5623L6.50857 19.0089ZM7.00642 18.8723C7.67782 18.688 8.37033 19.0879 8.54649 19.7614L9.99768\n  19.3819C9.61012 17.9001 8.08659 17.0204 6.60952 17.4257L7.00642 18.8723ZM8.54649 19.7614L8.67726\n  20.2614L10.1284 19.8819L9.99768 19.3819L8.54649 19.7614ZM12 20.75C11.6474 20.75 11.3001 20.7292 10.959\n  20.6888L10.7826 22.1784C11.1821 22.2257 11.5884 22.25 12 22.25V20.75ZM13.0408 20.6888C12.6998 20.7292\n  12.3525 20.75 12 20.75V22.25C12.4116 22.25 12.8178 22.2257 13.2172 22.1784L13.0408 20.6888ZM15.3226\n  20.2614L15.4534 19.7614L14.0022 19.3819L13.8714 19.8819L15.3226 20.2614ZM15.4534 19.7614C15.6295 19.0879\n  16.322 18.688 16.9934 18.8723L17.3903 17.4257C15.9133 17.0204 14.3897 17.9001 14.0022 19.3819L15.4534\n  19.7614ZM16.9934 18.8723L17.4914 19.0089L17.8883 17.5623L17.3903 17.4257L16.9934 18.8723ZM20.0462\n  15.4444C19.77 16.0886 19.4186 16.6933 19.0027 17.2473L20.2024 18.1478C20.6892 17.4992 21.101 16.7908\n  21.4249 16.0354L20.0462 15.4444ZM20.8166 13.2561L20.4469 12.8907L19.3926 13.9577L19.7623\n  14.3231L20.8166 13.2561ZM20.4469 12.8907C19.9516 12.4014 19.9516 11.6017 20.4469 11.1124L19.3926\n  10.0454C18.3031 11.122 18.3031 12.8812 19.3926 13.9577L20.4469 12.8907ZM20.4469 11.1124L20.8176\n  10.7461L19.7633 9.67912L19.3926 10.0454L20.4469 11.1124ZM19.0049 6.75562C19.4203 7.30952 19.7714\n  7.91404 20.0472 8.55808L21.4261 7.9675C21.1026 7.2123 20.6912 6.50406 20.2049 5.85564L19.0049\n  6.75562ZM17.4933 4.99372L16.9934 5.13088L17.3903 6.57741L17.8902 6.44026L17.4933 4.99372ZM16.9934\n  5.13088C16.322 5.31509 15.6295 4.91527 15.4534 4.24171L14.0022 4.62126C14.3897 6.10308 15.9133 6.98269\n  17.3903 6.57741L16.9934 5.13088ZM15.4534 4.24171L15.3218 3.73849L13.8706 4.11803L14.0022 4.62126L15.4534\n  4.24171ZM12 16.25C14.3472 16.25 16.25 14.3472 16.25 12H14.75C14.75 13.5188 13.5187 14.75 12\n  14.75V16.25ZM7.74996 12C7.74996 14.3472 9.65275 16.25 12 16.25V14.75C10.4812 14.75 9.24996 13.5188\n  9.24996 12H7.74996ZM12 7.74999C9.65275 7.74999 7.74996 9.65278 7.74996 12H9.24996C9.24996 10.4812\n  10.4812 9.24999 12 9.24999V7.74999ZM16.25 12C16.25 9.65278 14.3472 7.74999 12 7.74999V9.24999C13.5187\n  9.24999 14.75 10.4812 14.75 12H16.25ZM20.2049 5.85564C19.5498 4.98214 18.4418 4.73349 17.4933 4.99372L17.8902\n  6.44026C18.3526 6.3134 18.7823 6.45875 19.0049 6.75562L20.2049 5.85564ZM20.8176 10.7461C21.5166 10.0554\n  21.8562 8.9716 21.4261 7.9675L20.0472 8.55808C20.1929 8.89804 20.1043 9.34213 19.7633 9.67912L20.8176\n  10.7461ZM21.4249 16.0354C21.8554 15.0311 21.5158 13.947 20.8166 13.2561L19.7623 14.3231C20.1035 14.6601\n  20.1919 15.1044 20.0462 15.4444L21.4249 16.0354ZM17.4914 19.0089C18.4395 19.269 19.5471 19.0207 20.2024\n  18.1478L19.0027 17.2473C18.78 17.544 18.3505 17.6892 17.8883 17.5623L17.4914 19.0089ZM13.2172\n  22.1784C14.3031 22.0498 15.0736 21.2135 15.3226 20.2614L13.8714 19.8819C13.75 20.3462 13.4089\n  20.6452 13.0408 20.6888L13.2172 22.1784ZM3.79758 18.1477C4.4528 19.0206 5.56044 19.269 6.50857\n  19.0089L6.11167 17.5623C5.64948 17.6891 5.21992 17.5439 4.99723 17.2472L3.79758 18.1477ZM3.18332\n  13.256C2.48412 13.9469 2.14459 15.031 2.57507 16.0353L3.95374 15.4443C3.808 15.1043 3.89647 14.6601\n  4.23761 14.323L3.18332 13.256ZM6.50664 4.99375C5.55819 4.73351 4.45014 4.98217 3.79504 5.85567L4.99505\n  6.75565C5.2177 6.45878 5.64739 6.31343 6.10974 6.44029L6.50664 4.99375ZM8.67726 20.2614C8.92627 21.2135\n  9.69675 22.0498 10.7826 22.1784L10.959 20.6888C10.5909 20.6452 10.2499 20.3462 10.1284 19.8819L8.67726\n  20.2614ZM10.7837 1.82149C9.69774 1.94998 8.92713 2.78633 8.6781 3.7385L10.1293 4.11804C10.2507 3.65367\n  10.5918 3.35465 10.9599 3.3111L10.7837 1.82149ZM2.57384 7.96761C2.14378 8.9717 2.48335 10.0555 3.18236\n  10.7462L4.23665 9.67921C3.89561 9.34222 3.80708 8.89814 3.95269 8.55818L2.57384 7.96761ZM13.0399 3.31108C13.408\n  3.35463 13.7491 3.65365 13.8706 4.11803L15.3218 3.73849C15.0727 2.78631 14.3021 1.94995 13.2161\n  1.82147L13.0399 3.31108Z");
d.setAttributeNS(null,"fill",e);d.classList.add("option-svg-path");a.appendChild(d);return a},sb=function(e){var d=e.width;d=void 0===d?24:d;var g=e.height;g=void 0===g?24:g;e=e.color;e=void 0===e?"#FFFFFF":e;var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttributeNS(null,"viewBox","0 0 ".concat(d," ").concat(g));a.setAttributeNS(null,"fill","none");a.setAttributeNS(null,"width",d);a.setAttributeNS(null,"height",g);d=document.createElementNS("http://www.w3.org/2000/svg","path");
d.setAttributeNS(null,"d","M12 3.1875C11.5858 3.1875 11.25 3.52329 11.25 \n  3.9375V5.34375H4.40625C3.43975 5.34375 2.65625 6.12725 2.65625 7.09375V16.7812C2.65625\n  17.7477 3.43975 18.5312 4.40625 18.5312H11.25V20.0625C11.25 20.4767 11.5858 20.8125\n  12 20.8125C12.4142 20.8125 12.75 20.4767 12.75 20.0625V18.5312H19.5938C20.5602\n  18.5312 21.3438 17.7477 21.3438 16.7812V7.09375C21.3438 6.12725 20.5602 5.34375\n  19.5938 5.34375H12.75V3.9375C12.75 3.52329 12.4142 3.1875 12 3.1875ZM11.25\n  6.84375H4.40625C4.26818 6.84375 4.15625 6.95568 4.15625 7.09375V16.7812C4.15625\n  16.9193 4.26818 17.0312 4.40625 17.0312H11.25V6.84375ZM12.75 17.0312V6.84375H19.5938C19.7318\n  6.84375 19.8438 6.95568 19.8438 7.09375V16.7812C19.8438 16.9193 19.7318 17.0312 19.5938\n  17.0312H12.75Z");
d.setAttributeNS(null,"fill",e);d.setAttributeNS(null,"fill-rule","evenodd");d.setAttributeNS(null,"clip-rule","evenodd");d.classList.add("svg-rotate-icon");a.appendChild(d);return a},tb=function(e){var d=e.width;d=void 0===d?24:d;var g=e.height;g=void 0===g?24:g;e=e.color;e=void 0===e?"#FFFFFF":e;var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttributeNS(null,"viewBox","0 0 ".concat(d," ").concat(g));a.setAttributeNS(null,"width",d);a.setAttributeNS(null,"height",g);d=document.createElementNS("http://www.w3.org/2000/svg",
"path");d.setAttributeNS(null,"d","M12 10.5858L17.2929 5.29289C17.6834 4.90237 18.3166 4.90237\n  18.7071 5.29289C19.0976 5.68342 19.0976 6.31658 18.7071 6.70711L13.4142 12L18.7071\n  17.2929C19.0976 17.6834 19.0976 18.3166 18.7071 18.7071C18.3166 19.0976 17.6834\n  19.0976 17.2929 18.7071L12 13.4142L6.70711 18.7071C6.31658 19.0976 5.68342 19.0976\n  5.29289 18.7071C4.90237 18.3166 4.90237 17.6834 5.29289 17.2929L10.5858 12L5.29289\n  6.70711C4.90237 6.31658 4.90237 5.68342 5.29289 5.29289C5.68342 4.90237 6.31658\n  4.90237 6.70711 5.29289L12 10.5858Z");
d.setAttributeNS(null,"fill",e);d.setAttributeNS(null,"fill-rule","evenodd");d.setAttributeNS(null,"clip-rule","evenodd");d.classList.add("svg-cross-offset");a.appendChild(d);return a},Qa=function(e){var d=e.size;e=e.color;e=void 0===e?"#FFFFFF":e;var g=void 0===d?7:d,a=11/7*g;d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.setAttributeNS(null,"viewBox","0 0 7 11");d.setAttributeNS(null,"width",g);d.setAttributeNS(null,"height",a);g=document.createElementNS("http://www.w3.org/2000/svg",
"path");g.setAttributeNS(null,"d","M1.05039 6.23607C0.619603 5.8399 0.619602 5.1601 1.05039\n  4.76394L5.13559 1.00704C5.7766 0.417533 6.8125 0.872228 6.8125 1.7431L6.8125\n  9.2569C6.8125 10.1278 5.77661 10.5825 5.13559 9.99297L1.05039 6.23607Z");g.setAttributeNS(null,"fill",e);g.classList.add("svg-left-arrow-offset");d.appendChild(g);return d},Ra=function(e,d,k){e.children[0].style.backgroundImage="url(".concat(d,")");e.children[0].style.backgroundPosition="center";e.children[0].style.backgroundSize=
k===T.COLOR?"1%":"cover"},ya=function(e,d){var g=e.offsetWidth;e=(null===e||void 0===e?void 0:e.offsetLeft)||0;var a=g+e;"number"===typeof d&&(a=Math.min(g+e,d));return Math.max(e,a)-e},za=function(g){g%=360;return{value:new e.Vector2(0===g?0:1/360*g,0)}},Sa=function(g){function d(a){var b=a.imageA,c=a.imageB;a=a.options;a=void 0===a?{}:a;C(this,d);var f=a.is2D,h=a.offsetAngle;var g=d.createGeometry(f);var l=d.createMaterial(f,h);g=k.call(this,g,l);g.offsetAngle=h;if(g.is2D=f)g.desiredWidth=null,
g.desiredHeight=null,g.desiredPosition=new e.Vector3(0,0,-2);g.subtype=g.is2D?m.SIDE_BY_SIDE_2D:m.SIDE_BY_SIDE;g.options=u({onInitialLoadedFinished:function(){}},a);g.srcA=b||"https://cdn.cloudpano.com/public/panolens/equirectangular/basic-360-image.png";g.srcB=c||"https://cdn.cloudpano.com/public/panolens/equirectangular/basic-360-image.png";g.isSrcALoaded=!1;g.isSrcBLoaded=!1;g.floorPlane=null;g.setOffsetDegreeSideB=g.setOffsetDegreeSideB.bind(r(g));return g}D(d,g);var k=E(d);F(d,[{key:"load",value:function(){this.srcA||
this.srcB?(this.onLoadSrc(this.srcA,!0),this.onLoadSrc(this.srcB,!1)):console.warn("All image sources undefined")}},{key:"onLoadSrc",value:function(a,b){a?("string"===typeof a&&W.load(a,b?this.onLoadSrcA.bind(this):this.onLoadSrcB.bind(this),this.onProgress.bind(this),this.onError.bind(this)),a instanceof HTMLImageElement&&(b=b?this.onLoadSrcA.bind(this):this.onLoadSrcB.bind(this),a=new e.Texture(a),a.format=e.RGBFormat,a.magFilter=e.LinearFilter,a.minFilter=e.LinearFilter,a.needsUpdate=!0,b(a))):
console.warn("Image source ".concat(b?"A":"B"," is not defined"))}},{key:"onLoadSrcA",value:function(a){a.needsUpdate=!0;this.isSrcBLoaded||void 0===this.srcB?(this.updateTexture(a,this.textureB),this.onBothTexturesLoaded()):this.textureA=a;this.isSrcALoaded=!0;this.is2D&&(Ra(this.container,this.srcB,T.DEFAULT),this.desiredWidth=a.image.width,this.desiredHeight=a.image.height)}},{key:"onLoadSrcB",value:function(a){a.needsUpdate=!0;this.isSrcALoaded||void 0===this.srcA?(this.updateTexture(this.textureA,
a),this.onBothTexturesLoaded()):this.textureB=a;this.isSrcBLoaded=!0}},{key:"updateTexture",value:function(a,b){var c,d,e,g,l=null===(c=this.material.uniforms.tDiffuse1)||void 0===c?void 0:null===(d=c.value)||void 0===d?void 0:d.clone(),k=null===(e=this.material.uniforms.tDiffuse2)||void 0===e?void 0:null===(g=e.value)||void 0===g?void 0:g.clone();this.material.uniforms.tDiffuse1.value=a;this.material.uniforms.tDiffuse2.value=b;requestAnimationFrame(function(){return null===l||void 0===l?void 0:l.dispose()});
requestAnimationFrame(function(){return null===k||void 0===k?void 0:k.dispose()})}},{key:"onBothTexturesLoaded",value:function(){window.requestAnimationFrame(A(w(d.prototype),"onLoad",this).bind(this));window.requestAnimationFrame(this.options.onInitialLoadedFinished)}},{key:"add",value:function(a){if(1<arguments.length){var b=da(arguments),c;try{for(b.s();!(c=b.n()).done;)this.add(c.value)}catch(f){b.e(f)}finally{b.f()}return this}a instanceof O&&(this.floorPlane=a);A(w(d.prototype),"add",this).call(this,
a)}},{key:"addFloorPlane",value:function(){this.is2D||this.floorPlane&&this.floorPlane instanceof O||(this.floorPlane=new O,this.add(this.floorPlane))}},{key:"removeFloorPlane",value:function(){this.floorPlane&&this.floorPlane instanceof O&&(this.floorPlane.dispose(),this.floorPlane=null)}},{key:"setOffsetDegreeSideA",value:function(a){var b=this.material;a=za(a);b.uniforms.offset1=a}},{key:"setOffsetDegreeSideB",value:function(a){var b=this.material;a=za(a);b.uniforms.offset2=a}},{key:"dispose",
value:function(){e.Cache.remove(this.srcA);e.Cache.remove(this.srcB);this.floorPlane=null;var a=this.material;a&&a.uniforms&&a.uniforms.tEquirect&&a.uniforms.tEquirect.value.dispose();A(w(d.prototype),"dispose",this).call(this)}}],[{key:"createGeometry",value:function(a){return a?new e.PlaneBufferGeometry(1,1):A(w(d),"createGeometry",this).call(this)}},{key:"createMaterial",value:function(a,b){if(a)b=e.UniformsUtils.clone(nb),b.repeat.value.copy(new e.Vector2(1,1)),b.opacity.value=0,a=new e.ShaderMaterial({fragmentShader:"\n        uniform sampler2D tDiffuse1;\n        uniform sampler2D tDiffuse2;\n        uniform vec2 repeat;\n        uniform float opacity;\n        uniform float mixRatio;\n\n        varying vec2 vUv;\n\n        void main() {\n            vec2 sampleUV = vUv * repeat;\n\n            vec4 texel1 = texture2D(tDiffuse1, mod(sampleUV, 1.0)) * opacity;\n            vec4 texel2 = texture2D(tDiffuse2, mod(sampleUV, 1.0)) * opacity;\n\n            gl_FragColor = mix(texel2, texel1, mixRatio);\n        }\n    ",
vertexShader:"\n        varying vec2 vUv;\n\n        void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n    ",uniforms:b,side:e.FrontSide,transparent:!0});else if(a=e.UniformsUtils.clone(mb),a.opacity.value=0,a=new e.ShaderMaterial({fragmentShader:"\n        uniform float mixRatio;\n\n        uniform sampler2D tDiffuse1;\n        uniform sampler2D tDiffuse2;\n        uniform vec2 repeat;\n        uniform vec2 offset1;\n        uniform vec2 offset2;\n        uniform float opacity;\n        varying vec3 vWorldDirection;\n        #include <common>\n        void main() {\n            vec3 direction = normalize( vWorldDirection );\n            vec2 sampleUV;\n            sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n            sampleUV.x = atan( -direction.z, -direction.x ) * RECIPROCAL_PI2 + 0.5;\n            sampleUV *= repeat;\n\n            vec4 texel1 = vec4(texture2D( tDiffuse1, mod(sampleUV + offset1, 1.0) ).rgb, opacity);\n            vec4 texel2 = vec4(texture2D( tDiffuse2, mod(sampleUV + offset2, 1.0) ).rgb, opacity);\n            gl_FragColor = mix( texel1, texel2, mixRatio );\n        }\n    ",
vertexShader:"\n        varying vec3 vWorldDirection;\n        #include <common>\n        void main() {\n            vWorldDirection = transformDirection( position, modelMatrix );\n            #include <begin_vertex>\n            #include <project_vertex>\n        }\n    ",uniforms:a,side:e.BackSide,transparent:!0}),b){var c=a;b=za(b);c.uniforms.offset2=b}return a}}]);return d}(S),ub=function(g){function d(){C(this,d);var a=new e.BufferGeometry,b=new e.MeshBasicMaterial({color:0,opacity:0,transparent:!0});
a.addAttribute("position",new e.BufferAttribute(new Float32Array,1));return k.call(this,a,b)}D(d,g);var k=E(d);return d}(S),vb=function(e){function d(){C(this,d);var a=[];for(var b=0;6>b;b++)a.push(L.WhiteTile);a=g.call(this,a);a.type=m.BASIC;return a}D(d,e);var g=E(d);return d}(function(g){function d(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];C(this,d);var b=k.call(this,null,d.createMaterial());b.images=a;b.type=m.CUBE;return b}D(d,g);var k=E(d);F(d,[{key:"load",value:function(){A(w(d.prototype),
"load",this).call(this,!1);Ia.load(this.images,this.onLoad.bind(this),this.onProgress.bind(this),this.onError.bind(this))}},{key:"onLoad",value:function(a){this.material.uniforms.tCube.value=a;A(w(d.prototype),"onLoad",this).call(this)}},{key:"getTexture",value:function(){return this.material.uniforms.tCube.value}},{key:"dispose",value:function(){var a=this.material.uniforms.tCube.value;this.images.forEach(function(a){e.Cache.remove(a)});a instanceof e.CubeTexture&&a.dispose();A(w(d.prototype),"dispose",
this).call(this)}}],[{key:"createMaterial",value:function(){var a=e.ShaderLib.cube,b=a.fragmentShader,c=a.vertexShader;a=e.UniformsUtils.clone(a.uniforms);a.opacity.value=0;return new e.ShaderMaterial({fragmentShader:b,vertexShader:c,uniforms:a,side:e.BackSide,transparent:!0,opacity:0})}}]);return d}(S)),Aa={tEquirect:{value:new e.Texture},repeat:{value:new e.Vector2(1,1)},offset:{value:new e.Vector2(0,0)},opacity:{value:1}},wb=function(g){function d(a){C(this,d);var b=k.call(this,d.createGeometry(),
d.createMaterial());b.subtype=m.SLIDER;b.desiredWidth=null;b.desiredHeight=null;b.desiredPosition=new e.Vector3(0,0,-2);b.src=a.url;b.backgroundMode=T.DEFAULT;return b}D(d,g);var k=E(d);F(d,[{key:"hide",value:function(){}},{key:"load",value:function(a){a=a||this.src;if(!a)console.warn("Image source undefined");else if("string"===typeof a)W.load(a,this.onLoad.bind(this),this.onProgress.bind(this),this.onError.bind(this));else if(a instanceof HTMLImageElement)this.onLoad(new e.Texture(a))}},{key:"onLoad",
value:function(a){a.minFilter=e.LinearMipmapNearestFilter;a.magFilter=e.LinearFilter;a.needsUpdate=!0;this.desiredWidth=a.image.width;this.desiredHeight=a.image.height;Ra(this.container,this.src,this.backgroundMode);this.updateTexture(a);window.requestAnimationFrame(A(w(d.prototype),"onLoad",this).bind(this))}},{key:"reset",value:function(){A(w(d.prototype),"reset",this).call(this)}},{key:"dispose",value:function(){if(this.material){var a=this.material.map;a&&a.dispose()}e.Cache.remove(this.src);
A(w(d.prototype),"dispose",this).call(this)}}],[{key:"createGeometry",value:function(){return new e.PlaneBufferGeometry(1,1)}},{key:"createMaterial",value:function(){var a=e.UniformsUtils.clone(Aa);a.repeat.value.copy(new e.Vector2(1,1));a.offset.value.copy(new e.Vector2(0,0));a.opacity.value=0;return new e.ShaderMaterial({fragmentShader:"\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n\n            varying vec2 texcoord;\n            uniform sampler2D tEquirect;\n\n            void main()\n            {\n                /* Set color of the fragment */\n                gl_FragColor = texture2D(tEquirect, texcoord);}\n                \n    ",
vertexShader:"\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n\n            varying vec2 texcoord;\n\n            void main()\n            {\n                gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);\n                texcoord  = uv;\n            }\n    ",uniforms:a,side:e.FrontSide,transparent:!0})}}]);return d}(S),ca=function(g){function d(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};var c=2<arguments.length&&
void 0!==arguments[2]?arguments[2]:void 0;var e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:d.createMaterial();C(this,d);c=k.call(this,c,e);e=document.createElement("video");c.src=a;c.isHls=!1;c.safeHls=Q||window.Hls;c.TOUCH_ENABLED=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch);"m3u8"!==a.slice(-4)||pb||(c.safeHls&&c.safeHls.isSupported()?(e.title=a,c.hls=new c.safeHls({liveSyncDuration:1}),c.hls.loadSource(a),c.hls.attachMedia(e),c.setupHlsListeners(),
c.isHls=!0):!e.canPlayType("application/vnd.apple.mpegurl")&&b.originSrc&&(c.src=b.originSrc));c.options=u({videoElement:e,loop:!0,muted:!0,autoplay:!1,playsinline:!0,crossOrigin:"anonymous",onInitialLoadedFinished:function(){},depthmapUrl:null},b);c.videoElement=c.options.videoElement;c.videoProgress=0;c.maxDuration=b.maxDuration;c.subtype=m.VIDEO;c.floorPlane=null;c.firstToggleAudioBind=null;c.firstClickOnAudioButton=null;c.addEventListener("leave",c.pauseVideo.bind(r(c)));c.addEventListener("enter-fade-start",
c.resumeVideoProgress.bind(r(c)));c.addEventListener("video-toggle",c.toggleVideo.bind(r(c)));c.addEventListener("video-time",c.setVideoCurrentTime.bind(r(c)));return c}D(d,g);var k=E(d);F(d,[{key:"setupHlsListeners",value:function(){var a=this;this.hls.on(this.safeHls.Events.LEVEL_UPDATED,function(b){a.qualityLevel=b.data.level})}},{key:"loadDepthmap",value:function(a){a&&"string"===typeof a&&W.load(a,this.onDepthmapLoad.bind(this),function(){return null},function(a){console.error(a)})}},{key:"onDepthmapLoad",
value:function(a){this.material.uniforms.depthTexture.value=a}},{key:"load",value:function(){var a=this;A(w(d.prototype),"load",this).call(this,!1);var b=this.options,c=b.muted,e=b.loop,h=b.autoplay,g=b.playsinline,l=b.crossOrigin,k=b.maxDuration,n=this.videoElement,m=this.onProgress.bind(this),p=this.onLoad.bind(this);this.maxDuration=k||60;n.loop=e;n.autoplay=h;n.playsinline=g;n.crossOrigin=l;n.muted=c;g&&(n.setAttribute("playsinline",""),n.setAttribute("webkit-playsinline",""));b=function(){var a,
b=this,d=this.setVideoTexture(n);this.loadDepthmap(this.options.depthmapUrl);h&&this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1});c||this.dispatchEvent({type:"panolens-viewer-handler",method:"toggleVideoSound"});ob&&(n.pause(),h&&c?this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1}):this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!0}));window.requestAnimationFrame(function(){setTimeout(function(){m({loaded:1,
total:1});p(d)},1E3)});window.requestAnimationFrame(this.options.onInitialLoadedFinished);var e=(null===(a=this.videoElement.audioTracks)||void 0===a?void 0:a.length)||0<this.videoElement.webkitAudioDecodedByteCount,f=document.getElementById(ta.VIDEO_SOUND_BUTTON);e?(this.firstToggleAudioBind=this.firstToggleAudio.bind(this),this.firstClickOnAudioButton=function(a){return b.firstToggleAudioBind(a,!0)},f.addEventListener("click",this.firstClickOnAudioButton,{once:!0}),f.addEventListener("touchend",
this.firstClickOnAudioButton,{once:!0}),document.addEventListener("click",this.firstToggleAudioBind,{once:!0}),document.addEventListener("keydown",this.firstToggleAudioBind,{once:!0}),document.addEventListener("touchend",this.firstToggleAudioBind,{once:!0})):(f.isDisabled=!0,f.style.cursor="not-allowed",f.addEventListener(this.TOUCH_ENABLED?"touchstart":"mouseenter",function(){f.style.filter=f.style.webkitFilter="unset"},{passive:!0}))};2<n.readyState?b.call(this):(0===n.querySelectorAll("source").length&&
(g=document.createElement("source"),g.src=this.src,n.append(g)),n.load());n.addEventListener("loadeddata",b.bind(this));n.addEventListener("timeupdate",function(){a.isBuffering=!1;a.videoProgress=0<=n.duration?n.currentTime/a.maxDuration||n.duration:0;k&&n.currentTime>=a.maxDuration&&(n.currentTime=0);a.dispatchEvent({type:"panolens-viewer-handler",method:"onVideoUpdate",data:{percentage:a.videoProgress,quality:a.qualityLevel}})});n.addEventListener("ended",function(){e||(a.resetVideo(),a.dispatchEvent({type:"panolens-viewer-handler",
method:"updateVideoPlayButton",data:!0}))},!1)}},{key:"firstToggleAudio",value:function(a,b){}},{key:"onLoad",value:function(){A(w(d.prototype),"onLoad",this).call(this);this.maxDuration=Math.min(this.maxDuration,this.videoElement.duration)}},{key:"setVideoTexture",value:function(a){if(a)return a=new e.VideoTexture(a),a.minFilter=e.LinearFilter,a.magFilter=e.LinearFilter,a.format=e.RGBFormat,this.updateTexture(a),a}},{key:"reset",value:function(){this.videoElement=void 0;A(w(d.prototype),"reset",
this).call(this)}},{key:"isVideoPaused",value:function(){return this.videoElement.paused}},{key:"toggleVideo",value:function(a){var b=this.videoElement;if(b)if(a.toggleMute)b&&this.isVideoMuted()?this.unmuteVideo():this.muteVideo();else b[b.paused?"play":"pause"]()}},{key:"setVideoCurrentTime",value:function(a){a=a.percentage;var b=this.videoElement;b&&!Number.isNaN(a)&&1!==a&&(b.currentTime=this.maxDuration*a,this.dispatchEvent({type:"panolens-viewer-handler",method:"onVideoUpdate",data:a}))}},{key:"playVideo",
value:function(){var a=this.videoElement,b=this.playVideo.bind(this),c=this.dispatchEvent.bind(this),d=function(){c({type:"play"})},e=function(a){window.requestAnimationFrame(b);c({type:"play-error",error:a})};if(a&&a.paused)a.play().then(d)["catch"](e)}},{key:"pauseVideo",value:function(){var a=this.videoElement;a&&!a.paused&&a.pause();this.hls&&this.hls.stopLoad();this.dispatchEvent({type:"pause"});this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!0})}},{key:"resumeVideoProgress",
value:function(){var a=this.videoElement;4<=a.readyState&&a.autoplay&&!this.isMobile?(this.playVideo(),this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1})):(this.pauseVideo(),this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!0}));this.setVideoCurrentTime({percentage:this.videoProgress})}},{key:"resetVideo",value:function(){this.videoElement&&this.setVideoCurrentTime({percentage:0})}},{key:"isVideoMuted",value:function(){return this.videoElement.muted}},
{key:"muteVideo",value:function(){this.videoElement.muted=!0;this.dispatchEvent({type:"volumechange"})}},{key:"unmuteVideo",value:function(){this.videoElement.muted=!1;this.dispatchEvent({type:"volumechange"})}},{key:"getVideoElement",value:function(){return this.videoElement}},{key:"add",value:function(a){a instanceof O&&(this.floorPlane=a);A(w(d.prototype),"add",this).call(this,a)}},{key:"addFloorPlane",value:function(){this.floorPlane&&this.floorPlane instanceof O||(this.floorPlane=new O,this.add(this.floorPlane))}},
{key:"removeFloorPlane",value:function(){this.floorPlane&&this.floorPlane instanceof O&&(this.floorPlane.dispose(),this.floorPlane=null)}},{key:"dispose",value:function(){this.pauseVideo();this.removeEventListener("leave",this.pauseVideo);this.removeEventListener("enter-fade-start",this.resumeVideoProgress);this.removeEventListener("video-toggle",this.toggleVideo);this.removeEventListener("video-time",this.setVideoCurrentTime);this.floorPlane=null;A(w(d.prototype),"dispose",this).call(this)}}],[{key:"createMaterial",
value:function(){var a=e.UniformsUtils.clone(Na);a.opacity.value=0;return new e.ShaderMaterial({fragmentShader:"\n        // Uniforms\n        uniform sampler2D tEquirect;\n        uniform sampler2D depthTexture;\n        uniform float debugDepth;\n        uniform float opacity;\n        uniform vec2 offset;\n\n        // Varyings from vertex program\n        varying vec2 vUv;\n\n        // Internal\n        vec3 depth;\n        vec3 color;\n\n        void main() {\n\n            vec2 uvOffset = fract(vUv + offset);\n\n            depth = texture2D(depthTexture, uvOffset).rgb;\n            color = texture2D(tEquirect, uvOffset).rgb;\n\n            // Mix the depth and color based on debugDepth value\n            vec3 depthColorMixer = mix(color, depth , debugDepth);\n\n            // Render dat fragment\n            gl_FragColor = vec4(depthColorMixer, opacity);\n        }\n    ",
vertexShader:"\n        // Uniforms\n        uniform sampler2D tEquirect;\n        uniform sampler2D depthTexture;\n        uniform float pointSize;\n        uniform float displacement;\n\n        // Varyings passed to fragment\n        varying vec2 vUv;\n\n        // Internal\n        vec3 depthRgb;\n        float depth;\n\n        void main() {\n\n            /** Transform and pass to fragment shader */\n            vUv = uv;\n\n            /** Set the GL point size for when rendering points, ignored otherwise */\n            gl_PointSize = pointSize;\n\n            depthRgb = texture2D(depthTexture, vUv).rgb;\n            depth = depthRgb.r;\n\n\n            /** \n            * Invert the normals (since they are pointing outwards) and \n            * move the position on the normal direction scaled by the \n            * displacement which is the depth for the current vertex\n            * multiplied by a 'displacement' scalaer\n            **/\n            float disp = displacement * depth;\n            vec3 offset = position + (-normal) * disp;\n\n            /** Transform */\n            gl_Position = projectionMatrix *\n                            modelViewMatrix *\n                            vec4(offset, 1.0);\n        }\n    ",
uniforms:a,side:e.BackSide,transparent:!0})}}]);return d}(S),xb=function(g){function d(a){var b,c,f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};C(this,d);var h=k.call(this,a,f,d.createGeometry(),d.createMaterial());h.thumbUrl=f.thumbUrl;h.subtype=m.VIDEO_2D;h.desiredWidth=null===(b=f.dimensions)||void 0===b?void 0:b.width;h.desiredHeight=null===(c=f.dimensions)||void 0===c?void 0:c.height;h.desiredPosition=new e.Vector3(0,0,-2);h.backgroundMode=T.DEFAULT;return h}D(d,g);var k=E(d);F(d,
[{key:"onLoad",value:function(){window.requestAnimationFrame(A(w(d.prototype),"onLoad",this).bind(this));this.container.children[0].style.backgroundImage="url(".concat(this.thumbUrl,")");this.container.children[0].style.backgroundPosition="center";this.container.children[0].style.backgroundSize=this.backgroundMode===T.COLOR?"1%":"cover"}},{key:"updateBackgroundImage",value:function(a){this.container.children[0].style.backgroundImage="url(".concat(a,")")}}],[{key:"createGeometry",value:function(){return new e.PlaneBufferGeometry(1,
1)}},{key:"createMaterial",value:function(){var a=e.UniformsUtils.clone(Aa);a.repeat.value.copy(new e.Vector2(1,1));a.offset.value.copy(new e.Vector2(0,0));a.opacity.value=0;return new e.ShaderMaterial({fragmentShader:"\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n\n            varying vec2 texcoord;\n            uniform sampler2D tEquirect;\n\n            void main()\n            {\n                /* Set color of the fragment */\n                gl_FragColor = texture2D(tEquirect, texcoord);}\n                \n    ",
vertexShader:"\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n\n            varying vec2 texcoord;\n\n            void main()\n            {\n                gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);\n                texcoord  = uv;\n            }\n    ",uniforms:a,side:e.FrontSide,transparent:!0})}}]);return d}(ca),ea={uniforms:{tDiffuse1:{value:null},tDiffuse2:{value:null},mixRatio:{value:0},threshold:{value:.3},useTexture:{value:0},
tMixTexture:{value:null}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float mixRatio;\nuniform sampler2D tDiffuse1;\nuniform sampler2D tDiffuse2;\nuniform sampler2D tMixTexture;\nuniform int useTexture;\nuniform float threshold;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texel1 = texture2D( tDiffuse1, vUv );\n\tvec4 texel2 = texture2D( tDiffuse2, vUv );\n\tif (useTexture==1) {\n\t\tvec4 transitionTexel = texture2D( tMixTexture, vUv );\n\t\tfloat r = mixRatio * (1.0 + threshold * 2.0) - threshold;\n\t\tfloat mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);\n\t\tgl_FragColor = mix( texel1, texel2, mixf );\n\t} else {\n\t\tgl_FragColor = mix( texel2, texel1, mixRatio );\n\t}\n}"};
oa.prototype={constructor:oa};var J={CROSSFADE:{id:0,label:"Crossfade",value:"crossfade",settings:{useTexture:!1,texture:3,transitionSpeed:-3,smoothstep:{start:.3,end:.7}}},PERLIN:{id:1,label:"Perlin",value:"perlin",settings:{useTexture:!0,texture:1,transitionSpeed:-2,smoothstep:{start:.3,end:.7}}},SQUARES:{id:2,label:"Squares",value:"squares",settings:{useTexture:!0,texture:2,transitionSpeed:-2,smoothstep:{start:.3,end:.7}}},CELLS:{id:3,label:"Cells",value:"cells",settings:{useTexture:!0,texture:3,
transitionSpeed:-2,smoothstep:{start:.3,end:.7}}},DISTORT:{id:4,label:"Distort",value:"distort",settings:{useTexture:!0,texture:4,transitionSpeed:-2,smoothstep:{start:.3,end:.7}}},GRADIENT:{id:5,label:"Gradient",value:"gradient",settings:{useTexture:!0,texture:5,transitionSpeed:-2,smoothstep:{start:.3,end:.7}}},RADIAL:{id:6,label:"Radial",value:"radial",settings:{useTexture:!0,texture:6,transitionSpeed:-2,smoothstep:{start:.3,end:.7}}},PARALLAX:{id:7,label:"Parallax",value:"parallax",settings:{useTexture:!1,
texture:3,transitionSpeed:-3,smoothstep:{start:.45,end:.99}}},NONE:{id:8,label:"None",value:"none",settings:{useTexture:!1,texture:0,transitionSpeed:-1E4,smoothstep:{start:.3,end:.7}}}},Ta=function(g){function d(a,b,c,f){var h,g,l=4<arguments.length&&void 0!==arguments[4]?arguments[4]:!1;C(this,d);var m=k.call(this);m.renderCount=0;m.fromScene=a;m.toScene=b;m.renderer=c;m.transitionParams=f;m.isInitiatorInfospot=l;m.clock=new e.Clock;m.transition=1;m.transitionScene=new e.Scene;m.cameraOrtho=new e.OrthographicCamera(window.innerWidth/
-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,-10,10);m.updateParams(f);l=new e.TextureLoader;m.texture=l.load("/public/panolens/textures/transition/transition".concat(m.transitionParams.texture,".png"));m.texture.magFilter=e.LinearFilter;m.texture.minFilter=e.LinearFilter;m.texture.needsUpdate=!0;m.quadmaterial=new oa(m.transitionParams,m.texture);l=new e.PlaneBufferGeometry(window.innerWidth,window.innerHeight);m.quad=new e.Mesh(l,m.quadmaterial);m.transitionScene.add(m.quad);
l=function(){m.quadmaterial.uniforms.tDiffuse1.value=a.fbo.texture};var n=function(){m.quadmaterial.uniforms.tDiffuse2.value=b.fbo.texture};if(null!==a&&void 0!==a&&null!==(h=a.panorama)&&void 0!==h&&h.loaded)l();else{var q;null===a||void 0===a?void 0:null===(q=a.panorama)||void 0===q?void 0:q.addEventListener("ready",l)}if(null!==b&&void 0!==b&&null!==(g=b.panorama)&&void 0!==g&&g.loaded)n();else{var p;null===b||void 0===b?void 0:null===(p=b.panorama)||void 0===p?void 0:p.addEventListener("ready",
n)}return m}D(d,g);var k=E(d);F(d,[{key:"getTypeList",value:function(){return Object.keys(J).map(function(a){return u({},J[a])}).sort(function(a,b){return a.id-b.id})}},{key:"getTypeRelatedParameters",value:function(a){switch(a){case J.PERLIN.value:return u({},J.PERLIN.settings);case J.SQUARES.value:return u({},J.SQUARES.settings);case J.CELLS.value:return u({},J.CELLS.settings);case J.DISTORT.value:return u({},J.DISTORT.settings);case J.GRADIENT.value:return u({},J.GRADIENT.settings);case J.RADIAL.value:return u({},
J.RADIAL.settings);case J.PARALLAX.value:return u({},J.PARALLAX.settings);case J.NONE.value:return u({},J.NONE.settings);default:return u({},J.CROSSFADE.settings)}}},{key:"updateParams",value:function(a){var b=this.getTypeRelatedParameters((null===a||void 0===a?void 0:a.type)||J.CROSSFADE.value);this.transitionParams=u(u(u({textureThreshold:.3},J.CROSSFADE.settings),a),b)}},{key:"execute",value:function(){this.transitionParams.animateTransition=!0;var a="parallax"===this.transitionParams.type;if(!a&&
this.fromScene){var b,c,d=this.fromScene,e=this.toScene;null===d||void 0===d?void 0:null===(b=d.panorama)||void 0===b?void 0:b.dispatchEvent({type:"not-parallax-transition-start"});null===e||void 0===e?void 0:null===(c=e.panorama)||void 0===c?void 0:c.dispatchEvent({type:"not-parallax-transition-start"})}a&&this.isInitiatorInfospot&&this.toScene.panorama.subtype!==m.SLIDER&&this.toScene.panorama.subtype!==m.SPIN&&this.toScene.panorama.subtype!==m.SIDE_BY_SIDE_2D&&this.toScene.panorama.subtype!==m.VIDEO_2D&&
(!this.fromScene||this.fromScene.panorama.subtype!==m.SLIDER&&this.fromScene.panorama.subtype!==m.SPIN&&this.fromScene.panorama.subtype!==m.SIDE_BY_SIDE_2D&&this.fromScene.panorama.subtype!==m.VIDEO_2D)&&this.parallax()}},{key:"destroy",value:function(){this.toScene.destroy();this.fromScene.destroy()}},{key:"parallax",value:function(){console.log("paralax");var a=this.fromScene,b=this.toScene;if(a){var c=a.lastTouch.scene||{x:0,y:0,z:0},d=a.camera.position,h=new e.Vector3;h.subVectors(d,c).normalize();
d=new e.Vector3;a.camera.getWorldDirection(d);(new e.Vector3).subVectors(d,c.clone().normalize());c=h.multiply(new e.Vector3(-1,0,1));d=new e.Vector3;d=b.control.getRotations().h-a.control.getRotations().h;d=h.clone().applyAxisAngle(new e.Vector3(0,1,0),d).normalize();h=d.clone();d=b.panorama.position.clone();c=(new v.Tween(a.panorama.position)).to({x:2E3*c.x,y:2E3*c.y,z:2E3*c.z},1500).easing(v.Easing.Cubic.Out);b.panorama.position.set(-2E3*h.x,h.y,-2E3*h.z);b.panorama.position.needsUpdate=!0;h=(new v.Tween(b.panorama.position)).to({x:d.x,
y:d.y,z:d.z},1500).easing(v.Easing.Cubic.Out);c.start().onStart(function(){var b;null===a||void 0===a?void 0:null===(b=a.panorama)||void 0===b?void 0:b.dispatchEvent({type:"parallax-transition-start"})}).onComplete(function(){var b;null===a||void 0===a?void 0:null===(b=a.panorama)||void 0===b?void 0:b.dispatchEvent({type:"parallax-transition-complete"})});h.start().onStart(function(){var a;null===b||void 0===b?void 0:null===(a=b.panorama)||void 0===a?void 0:a.dispatchEvent({type:"parallax-transition-start"})}).onComplete(function(){var a;
null===b||void 0===b?void 0:null===(a=b.panorama)||void 0===a?void 0:a.dispatchEvent({type:"parallax-transition-complete"})})}}},{key:"render",value:function(){var a=this.cameraOrtho,b=this.clock,c=this.quadmaterial,d=this.renderer,h=this.transitionParams,g=this.transitionScene;if(null===this.fromScene){var l,k;a=null!==(l=h.controlEnabled)&&void 0!==l?l:!0;this.toScene.render(!1);null!==(k=this.toScene)&&void 0!==k&&k.control&&(this.toScene.control.enabled=a);h.animateTransition=!1}else if(h.animateTransition&&
(l=1+Math.sin(h.transitionSpeed*b.getElapsedTime()/Math.PI),this.transition=e.Math.smoothstep(l,h.smoothstep.start,h.smoothstep.end)),c.uniforms.mixRatio.value=this.transition,0===this.transition){var n,m,p;a=h&&(h.controlEnabled||!1===h.controlEnabled)?h.controlEnabled:!0;this.toScene.render(!1);null!==(n=this.toScene)&&void 0!==n&&n.control&&(this.toScene.control.enabled=a);null!==(m=this.fromScene)&&void 0!==m&&m.control&&(this.fromScene.control.enabled=!1);h.animateTransition=!1;if("parallax"!==
this.transitionParams.type&&this.fromScene){var q,r;null===(q=this.toScene)||void 0===q?void 0:null===(r=q.panorama)||void 0===r?void 0:r.dispatchEvent({type:"not-parallax-transition-complete"})}null===(p=this.fromScene)||void 0===p?void 0:p.destroy();this.fromScene=null;this.dispatchEvent({type:"transition-complete"})}else if(1===this.transition){var t,H;h=h&&(h.controlEnabled||!1===h.controlEnabled)?h.controlEnabled:!0;this.fromScene.render(!1);null!==(t=this.toScene)&&void 0!==t&&t.control&&(this.toScene.control.enabled=
h);null!==(H=this.fromScene)&&void 0!==H&&H.control&&(this.fromScene.control.enabled=h)}else{var u,v;h=h&&(h.controlEnabled||!1===h.controlEnabled)?h.controlEnabled:!0;this.fromScene.render(!0);this.toScene.render(!0);null!==(u=this.toScene)&&void 0!==u&&u.control&&(this.toScene.control.enabled=h);null!==(v=this.fromScene)&&void 0!==v&&v.control&&(this.fromScene.control.enabled=h);d.setRenderTarget(null);d.clear();d.clearDepth();d.render(g,a)}}}]);return d}(e.EventDispatcher),yb=Array(21).fill(0).map(function(e,
d){return d+1}),zb="\n  .sbs-widget {\n    display: none;\n    align-items: center;\n    flex-wrap: nowrap;\n    gap: 9px;\n    position: absolute;\n    top: calc(50% - 16px);\n    z-index: 2;\n  }\n\n  .sbs-resizer {\n    cursor: ew-resize;\n    width: 32px;\n    height: 32px;\n  }\n\n  .sbs-controls-bar {\n    display: flex;\n    box-sizing: border-box;\n    padding: 4px 10px;\n    align-items: center;\n    gap: 10px;\n    border-radius: 36px;\n    background: rgba(0, 0, 0, 0.50);\n  }\n\n  .sbs-options-btn {\n    cursor: pointer;\n    appearance: none;\n    border: none;\n    background: none;\n    width: 24px;\n    height: 24px;\n    padding: 0;\n  }\n\n  .sbs-rotation-offset-btn {\n    cursor: pointer;\n    appearance: none;\n    border: none;\n    background: none;\n    width: 24px;\n    height: 24px;\n    padding: 0;\n  }\n\n  .sbs-rotation-offset-bar {\n    display: flex;\n    box-sizing: border-box;\n    align-items: center;\n    gap: 10px;\n  }\n\n  .sbs-rotation-offset-close-btn {\n    display: flex;\n    cursor: pointer;\n    width: 32px;\n    height: 32px;\n    padding: 6px 4px;\n    justify-content: center;\n    align-items: center;\n    gap: 2px;\n    border: none;\n    border-radius: 24px;\n    background: rgba(0, 0, 0, 0.50);\n\n  }\n\n  .rotationOffsetControl__cross-button:hover {\n    background-color: #000;\n  }\n  \n  .sbs-rotation-offset-controls {\n    display: flex;\n    height: 31px;\n    padding: 6px 3px;\n    justify-content: center;\n    align-items: center;\n    gap: 4px;\n    border-radius: 41px;\n    background: rgba(0, 0, 0, 0.50);\n  }\n\n  .sbs-rotation-offset-range__increase-btn,\n  .sbs-rotation-offset-range__decrease-btn {\n    align-items: center;\n    justify-content: center;\n    border: none;\n    width: 25px;\n    height: 25px;\n    padding: 5px;\n    padding-right: 8px;\n    border-radius: 56px;\n    background: transparent;\n    cursor: pointer;\n  }\n\n  .sbs-rotation-offset-range__increase-btn:disabled,\n  .sbs-rotation-offset-range__decrease-btn:disabled {\n    .sbs-rotation-offset-range__increase-btn:hover,\n    .sbs-rotation-offset-range__decrease-btn:hover {\n      background-color: #000;\n    }\n  }\n\n  .sbs-rotation-offset-range__increase-btn:hover,\n  .sbs-rotation-offset-range__decrease-btn:hover {\n    background-color: #000;\n  }\n\n  .sbs-rotation-offset-range__increase-btn {\n    transform: rotate(180deg);\n  }\n\n  .sbs-rotation-offset-range {\n    position: relative;\n    display: flex;\n    width: ".concat(132,
"px;\n    height: 19px;\n  }\n\n  .sbs-rotation-offset-range::before {\n    display: block;\n    content: '';\n    position: absolute;\n    top: -6px;\n    left: calc(50% - 1px);\n    background-color: #59C1C9;\n    width: 2px;\n    height: 31px;\n  }\n\n  .sbs-rotation-offset-range__wrapper {\n    display: flex;\n    flex-wrap: wrap;\n    width: 100%;\n    position: relative;\n    overflow: hidden;\n  }\n\n  .sbs-rotation-offset-range__wrapper::before {\n    content: '';\n    display: block;\n    width: 100%;\n    height: 100%;\n    z-index: 3;\n    top: 0;\n    position: absolute;\n    border-radius: none;\n    pointer-events: none;\n  }\n\n  @supports selector(::-moz-range-progress) {\n    .sbs-rotation-offset-range__wrapper::before {\n      display: none;\n    }\n  }\n\n  .sbs-rotation-offset-range__scale {\n    position: absolute;\n    top: 0;\n    left: 0;\n    display: flex;\n    align-items: center;\n    width: 200%;\n    height: 100%;\n    gap: 12px;\n    pointer-events: none;\n  }\n\n  .sbs-rotation-offset-range__notch {\n    width: 1px;\n    height: 9px;\n    background-color: #fff;\n  }\n\n  .sbs-rotation-offset-range__notch:nth-child(").concat(11,
") {\n    width: 2px;\n    height: 15px;\n  }\n\n  .sbs-rotation-offset-range__input {\n    position: relative;\n    margin: 0;\n    width: 100%;\n    height: 100%;\n    background-color: transparent;\n    appearance: none;\n    border-radius: none;\n    z-index: 4;\n    cursor: grab;\n  }\n\n  .sbs-rotation-offset-range__input:disabled {\n    cursor: not-allowed;\n  }\n\n  .sbs-rotation-offset-range__input:focus {\n    outline: none;\n  }\n\n  .sbs-rotation-offset-range__input::-webkit-slider-runnable-track {\n    background: transparent;\n    color: #59c1c9;\n    border: 0;\n    cursor: grab;\n    height: 1px;\n  }\n\n  .sbs-rotation-offset-range__input::-webkit-slider-runnable-track:disabled {\n    color: #CBD9DB;\n    cursor: default;\n  }\n\n  .sbs-rotation-offset-range__input::-webkit-slider-thumb {\n    width: 2px;\n    height: 15px;\n    background: transparent;\n    position: relative;\n    z-index: 4;\n    border: 0;\n    cursor: grab;\n    margin-top: -6px;\n    -webkit-appearance: none;\n  }\n\n  .sbs-rotation-offset-range__input::-webkit-slider-thumb:disabled {\n    cursor: not-allowed;\n  }\n\n  .sbs-rotation-offset-range__input::-moz-range-track {\n    background: transparent;\n    border: 0;\n    width: 100%;\n    height: 1px;\n    cursor: grab;\n  }\n\n  .sbs-rotation-offset-range__input::-moz-range-track:disabled {\n    cursor: default;\n  }\n\n  .sbs-rotation-offset-range__input::-moz-range-thumb {\n    width: 2px;\n    height: 15px;\n    background: #fff;\n    position: relative;\n    z-index: 4;\n    border: 0;\n    cursor: grab;\n  }\n\n  .sbs-rotation-offset-range__input::-moz-range-thumb:disabled {\n    cursor: not-allowed;\n  }\n\n  .sbs-rotation-offset-range__input::-moz-range-progress {\n    background-color: transparent; \n    height: 1px;\n  }\n"),
Ab=function(e){function d(a){C(this,d);var b=g.call(this);b.options=a;b.container=a.container;b.closeRotationControls=a.closeRotationControls;b.limitedValue=null;b.leftPosition=null;b.sceneOffsetAngle=null;b.onOptionsClick=a.onOptionsClick;b.handleChangeOffsetSceneB=a.handleChangeOffsetSceneB;b.onCloseRotationControl=b.onCloseRotationControl.bind(r(b));b.handleChangeOffset=b.handleChangeOffset.bind(r(b));b.turnLeft=b.turnLeft.bind(r(b));b.turnRight=b.turnRight.bind(r(b));b.stopPropagation=b.stopPropagation.bind(r(b));
b.rotationOffsetWrapperElement=document.createElement("div");b.rotationOffsetWrapperElement.id="sbs-rotation-offset-bar";b.rotationOffsetWrapperElement.className="sbs-rotation-offset-bar";b.rotationOffsetWrapperElement.style.display="none";b.rotationOffsetControl=document.createElement("div");b.rotationOffsetControl.id="sbs-rotation-offset-controls";b.rotationOffsetControl.className="sbs-rotation-offset-controls";b.svgToCross=document.createElement("button");b.svgToCross.id="sbs-rotation-offset-close-btn";
b.svgToCross.className="sbs-rotation-offset-close-btn";b.svgToCross.addEventListener("click",b.onCloseRotationControl);b.svgToCross.appendChild(tb({width:24,height:24}));b.svgToLeftArrow=document.createElement("button");b.svgToLeftArrow.addEventListener("click",b.turnLeft);b.svgToLeftArrow.id="sbs-rotation-offset-range__decrease-btn";b.svgToLeftArrow.className="sbs-rotation-offset-range__decrease-btn";b.svgToLeftArrow.style.cssText="\n      \n    ";b.svgToLeftArrow.appendChild(Qa({width:25,height:25}));
b.range=document.createElement("div");b.range.className="sbs-rotation-offset-range";b.rangeWrapper=document.createElement("div");b.rangeWrapper.className="sbs-rotation-offset-range__wrapper";b.rangeScale=document.createElement("div");b.rangeScale.className="sbs-rotation-offset-range__scale";b.elementsWithNotches=yb.map(function(){var a=document.createElement("div");a.className="sbs-rotation-offset-range__notch";b.rangeScale.appendChild(a)});b.inputRange=document.createElement("input");b.inputRange.className=
"sbs-rotation-offset-range__input";b.inputRange.type="range";b.inputRange.min=-180;b.inputRange.max=180;b.inputRange.value="0";b.inputRange.addEventListener("input",b.handleChangeOffset);b.inputRange.step=1;b.inputRange.disabled=!1;b.svgToRightArrow=document.createElement("button");b.svgToRightArrow.addEventListener("click",b.turnRight);b.svgToRightArrow.id="sbs-rotation-offset-range__increase-btn";b.svgToRightArrow.className="sbs-rotation-offset-range__increase-btn";b.svgToRightArrow.appendChild(Qa({width:25,
height:25}));b.rangeWrapper.appendChild(b.rangeScale);b.rangeWrapper.appendChild(b.inputRange);b.range.appendChild(b.rangeWrapper);b.rotationOffsetControl.appendChild(b.svgToLeftArrow);b.rotationOffsetControl.appendChild(b.range);b.rotationOffsetControl.appendChild(b.svgToRightArrow);b.rotationOffsetWrapperElement.appendChild(b.svgToCross);b.rotationOffsetWrapperElement.appendChild(b.rotationOffsetControl);b.container.appendChild(b.rotationOffsetWrapperElement);b.container.addEventListener("mousemove",
b.stopPropagation);b.container.addEventListener("mousedown",b.stopPropagation);b.container.addEventListener("mouseup",b.stopPropagation);return b}D(d,e);var g=E(d);F(d,[{key:"onCloseRotationControl",value:function(){this.closeRotationControls(this.sceneOffsetAngle)}},{key:"calcLimitedValue",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,b=1<arguments.length?arguments[1]:void 0,c=2<arguments.length?arguments[2]:void 0;return a>c?c:a<b?b:Number.isNaN(a)?0:a}},{key:"stopPropagation",
value:function(a){a.stopPropagation()}},{key:"turnLeft",value:function(){this.handleChangeByStep(this.sceneOffsetAngle-1)}},{key:"turnRight",value:function(){this.handleChangeByStep(this.sceneOffsetAngle+1)}},{key:"calcRangeScaleLeftPosition",value:function(a,b,c){var d=(a-b)/(c-b)*132-131;return a===b?d+1:a===c?d-1:d}},{key:"initialize",value:function(a){var b;this.sceneOffsetAngle=a;this.limitedValue=this.calcLimitedValue(a,-180,180);this.leftPosition=this.calcRangeScaleLeftPosition(this.limitedValue,
-180,180);this.rangeScale.style.left="".concat(this.leftPosition,"px");this.inputRange.value=null===(b=this.limitedValue)||void 0===b?void 0:b.toString()}},{key:"handleChangeByStep",value:function(a){void 0!==a&&(this.sceneOffsetAngle=a=this.calcLimitedValue(a,-180,180),this.leftPosition=this.calcRangeScaleLeftPosition(a,-180,180),this.rangeScale.style.left="".concat(this.leftPosition,"px"),this.inputRange.value=null===a||void 0===a?void 0:a.toString(),this.handleChangeOffsetSceneB(a))}},{key:"handleChangeOffset",
value:function(a){var b;this.sceneOffsetAngle=a=Number.parseInt(null===(b=a.target)||void 0===b?void 0:b.value,10);this.leftPosition=this.calcRangeScaleLeftPosition(a,-180,180);this.rangeScale.style.left="".concat(this.leftPosition,"px");this.inputRange.value=null===a||void 0===a?void 0:a.toString();this.handleChangeOffsetSceneB(a)}},{key:"hide",value:function(){this.rotationOffsetWrapperElement.style.display="none"}},{key:"show",value:function(){this.rotationOffsetWrapperElement.style.display="flex"}},
{key:"dispose",value:function(){this.rotationOffsetWrapperElement.remove();this.inputRange.removeEventListener("change",this.handleChangeOffset);this.svgToCross.removeEventListener("click",this.onCloseRotationControl);this.svgToLeftArrow.removeEventListener("click",this.turnLeft);this.svgToRightArrow.removeEventListener("click",this.turnRight);this.container.removeEventListener("mousemove",this.stopPropagation);this.container.removeEventListener("mousedown",this.stopPropagation);this.container.removeEventListener("mouseup",
this.stopPropagation)}}]);return d}(e.EventDispatcher),Bb=function(e){function d(a){C(this,d);var b=g.call(this);b.options=a;b.container=a.container;b.onOptionsClick=a.onOptionsClick;b.openRotationControls=a.openRotationControls;b.settingsWrapperElement=document.createElement("div");b.settingsWrapperElement.id="sbs-controls-bar";b.settingsWrapperElement.className="sbs-controls-bar";b.settingsWrapperElement.style.display="none";b.svgToOptions=document.createElement("button");b.svgToOptions.className=
"sbs-options-btn";b.svgToOptions.appendChild(rb({width:24,height:24}));b.svgToRotate=document.createElement("button");b.svgToRotate.className="sbs-rotation-offset-btn";b.svgToRotate.appendChild(sb({width:24,height:24}));b.onOptionsClick&&(b.svgToOptions.addEventListener("click",b.onOptionsClick),b.svgToRotate.addEventListener("click",b.openRotationControls));b.settingsWrapperElement.appendChild(b.svgToOptions);b.settingsWrapperElement.appendChild(b.svgToRotate);b.container.appendChild(b.settingsWrapperElement);
return b}D(d,e);var g=E(d);F(d,[{key:"hide",value:function(){this.settingsWrapperElement.style.display="none"}},{key:"show",value:function(){this.settingsWrapperElement.style.display="flex"}},{key:"dispose",value:function(){this.onOptionsClick&&(this.svgToRotate.removeEventListener("click",this.openRotationControls),this.svgToOptions.removeEventListener("click",this.onOptionsClick),this.svgToOptions.remove(),this.svgToRotate.remove());this.settingsWrapperElement.remove()}}]);return d}(e.EventDispatcher),
Cb=function(e){function d(a){C(this,d);var b=g.call(this);b.options=a;b.container=a.container;b.renderer=a.renderer;b.onSaveOffsetSceneB=a.onSaveOffsetSceneB;b.isShowSbsOptionsButton=a.isShowSbsOptionsButton;b.setOffsetDegreeSideB=null;b.dividerPos=a.initialDividerPosition;b.sliderEl=document.createElement("div");var c=document.createElement("style");c.type="text/css";c.textContent=zb;document.head.append(c);b.sliderEl.id="sbs-widget";b.sliderEl.className="sbs-widget";b.svgToResizer=document.createElement("div");
b.svgToResizer.className="sbs-resizer";b.svgToResizer.appendChild(qb({width:32,height:32}));b.onPointerDown=b.onPointerDown.bind(r(b));b.onPointerMove=b.onPointerMove.bind(r(b));b.onPointerUp=b.onPointerUp.bind(r(b));b.sliderEl.style.left="".concat(b.dividerPos-16,"px");b.sliderEl.appendChild(b.svgToResizer);b.renderer.domElement.parentElement.appendChild(b.sliderEl);b.sliderEl.style.touchAction="none";b.svgToResizer.addEventListener("pointerdown",b.onPointerDown);b.isShowSbsOptionsButton&&(b.sideBySideControlsBar=
new Bb({container:b.sliderEl,onOptionsClick:a.onOptionsClick,isShowSbsOptionsButton:a.isShowSbsOptionsButton,openRotationControls:b.openRotationControls.bind(r(b))}),b.rotationOffsetControls=new Ab({container:b.sliderEl,onOptionsClick:b.options.onOptionsClick,isShowRotationOffset:b.isShowSbsOptionsButton,handleChangeOffsetSceneB:b.onChangeOffsetSceneB.bind(r(b)),closeRotationControls:b.closeRotationControls.bind(r(b))}));return b}D(d,e);var g=E(d);F(d,[{key:"onPointerDown",value:function(a){!1!==
a.isPrimary&&(this.dispatchEvent({type:"side-by-side-divider-down",data:{dividerPosition:this.dividerPos}}),a.preventDefault(),window.addEventListener("pointermove",this.onPointerMove),window.addEventListener("pointerup",this.onPointerUp))}},{key:"onPointerUp",value:function(){this.dispatchEvent({type:"side-by-side-divider-up",data:{dividerPosition:this.dividerPos}});window.removeEventListener("pointermove",this.onPointerMove);window.removeEventListener("pointerup",this.onPointerUp)}},{key:"onPointerMove",
value:function(a){!1!==a.isPrimary&&(this.dividerPos=ya(this.container,a.pageX),this.sliderEl.style.left=this.dividerPos-this.svgToResizer.offsetWidth/2+"px",this.dispatchEvent({type:"side-by-side-divider-move",data:{dividerPosition:this.dividerPos}}))}},{key:"onChangeOffsetSceneB",value:function(a){this.setOffsetDegreeSideB&&this.setOffsetDegreeSideB(a)}},{key:"openRotationControls",value:function(){this.isShowSbsOptionsButton&&(this.sideBySideControlsBar.hide(),this.rotationOffsetControls.show())}},
{key:"closeRotationControls",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this.isShowSbsOptionsButton&&(this.setOffsetDegreeSideB(a),this.onSaveOffsetSceneB(a),this.rotationOffsetControls.hide(),this.sideBySideControlsBar.show())}},{key:"setDividerPos",value:function(a){this.dividerPos=a;this.sliderEl.style.left=this.dividerPos-16+"px"}},{key:"initialize",value:function(a){var b=a.offsetAngle;this.setOffsetDegreeSideB=a.setOffsetDegreeSideB;this.isShowSbsOptionsButton&&
(this.rotationOffsetControls.initialize(b),this.rotationOffsetControls.hide(),this.sideBySideControlsBar.show())}},{key:"getDividerPos",value:function(){return this.dividerPos}},{key:"hide",value:function(){this.sliderEl.style.display="none"}},{key:"show",value:function(){this.sliderEl.style.display="flex"}},{key:"dispose",value:function(){this.sideBySideControlsBar.dispose();this.rotationOffsetControls.dispose();this.svgToResizer.removeEventListener("pointerdown",this.onPointerDown);window.removeEventListener("pointermove",
this.onPointerMove);window.removeEventListener("pointerup",this.onPointerUp);this.sliderEl.remove()}}]);return d}(e.EventDispatcher),Db=function(g){function d(a){var b,c,f;C(this,d);var h=k.call(this);var g="100%",l="100%";a&&a.container&&a.container.style&&(g=a.container.style.width||"100%",l=a.container.style.height||"100%");var m=a&&a.container?a.container:document.createElement("div");m.classList.add("panolens-container");m.style.width=g;m.style.height=l;m._width=window.innerWidth;m._height=window.innerHeight;
a&&a.container||document.body.append(m);h.container=m;g=ya(h.container)/2;h.scissorX=g;h.options=u({container:h.container,autoHideInfospot:!0,horizontalView:!1,controlBar:!1,controlButtons:[],autoHideControlBar:!0,clickTolerance:10,cameraFov:60,reverseDragging:!1,enableReticle:!1,dwellTime:1500,autoReticleSelect:!0,viewIndicator:!1,indicatorSize:30,output:null,autoRotate:!1,disableZoomInIframe:!1,autoRotateSpeed:2,autoRotateActivationDuration:5E3,initialLookAt:new e.Vector3(0,0,-Number.MAX_SAFE_INTEGER),
cameraInitialLookAt:null,momentum:!0,rotateSpeed:-1,dampingFactor:.1,defaultFov:60,controlEnabled:!0,horizontalViewLimit:!1,horizontalViewDownLimitDegrees:0,horizontalViewUpLimitDegrees:180,scissorX:g},a);a=window.devicePixelRatio;g=!0;1<a&&(g=!1);h.renderer=new e.WebGLRenderer({antialias:g,alpha:!0,powerPreference:"high-performance"});h.renderer.setPixelRatio(a);h.renderer.setSize(window.innerWidth,window.innerHeight);h.renderer.autoClear=!1;h.renderer.setClearColor(0,0);h.renderer.setAnimationLoop(function(){return h.animate()});
h.renderer.domElement.classList.add("panolens-canvas");h.renderer.domElement.style.display="block";h.renderer.domElement.style.position="absolute";h.container.style.backgroundColor="#000";h.container.append(h.renderer.domElement);a=document.createElement("div");a.style.transition="background-image 1.5s cubic-bezier( 1, 0, 0, 1 ) ";a.style.filter="blur(20px)";a.style.position="absolute";a.style.height="100%";a.style.width="100%";h.container.prepend(a);h.options.renderer=h.renderer;h.options.container=
h.container;h.mode=null;h.controlIndex=null;a={renderer:h.options.renderer,container:h.options.container,onOptionsClick:null===(b=h.options.sideBySideDividerOptions)||void 0===b?void 0:b.onOptionsClick,initialDividerPosition:h.options.initialDividerPosition||h.scissorX,isShowSbsOptionsButton:!(null===(c=h.options.sideBySideDividerOptions)||void 0===c||!c.onOptionsClick),onSaveOffsetSceneB:null===(f=h.options.sideBySideDividerOptions)||void 0===f?void 0:f.onSaveOffsetSceneB};h.sideBySideDivider=new Cb(a);
h.sideBySideDivider.addEventListener("side-by-side-divider-down",function(){return h.setControlEnabled(!1)});h.sideBySideDivider.addEventListener("side-by-side-divider-up",function(){return h.handleDividerUp()});h.sideBySideDivider.addEventListener("side-by-side-divider-move",function(a){return h.handleDividerMove(a)});h.autoRotate=h.options.autoRotate;h.disableZoomInIframe=h.options.disableZoomInIframe;h.viewer=null;h.targetViewer=null;h.viewersQueue=[];h.composer=null;h.animate();h.inIframe=function(){try{return window.self!==
window.top}catch(n){return!0}};return h}D(d,g);var k=E(d);F(d,[{key:"add",value:function(a){this.viewer&&this.viewer.panorama instanceof ca&&this.viewer.removeWidget();this.viewer?this.targetViewer=a:this.viewer=a;this.viewersQueue.push(a);a.panorama instanceof ca||this.removeVideoWidget();a.panorama instanceof Sa?(this.mode=z.SIDE_BY_SIDE,a.mode=this.mode,a.sideBySideDivider=this.sideBySideDivider,a.sideBySideDivider.initialize({offsetAngle:a.panorama.offsetAngle,setOffsetDegreeSideB:a.panorama.setOffsetDegreeSideB}),
this.sideBySideDivider.show()):(this.sideBySideDivider.hide(),this.scissorX=ya(this.container)/2,this.sideBySideDivider.setDividerPos(this.scissorX),a.sideBySideDivider=null);this.shareStateBetweenViewers()}},{key:"handleDividerMove",value:function(a){this.scissorX=a=a.data.dividerPosition;this.viewer.scissorX=a}},{key:"handleDividerUp",value:function(){var a,b;this.setControlEnabled(!0);null===(a=this.viewer)||void 0===a?void 0:null===(b=a.panorama)||void 0===b?void 0:b.dispatchEvent({type:"side-by-side-divider-up-end"})}},
{key:"removeVideoWidget",value:function(){document.querySelectorAll(".videoWidgetBar").forEach(function(a){return a.remove()});document.querySelectorAll(".videoWidgetMask").forEach(function(a){return a.remove()})}},{key:"updateTransitionType",value:function(a){a={type:a};this.options.transitionParams=u(u({},this.options.transitionParams),a);this.viewer.options.transitionParams=u(u({},this.viewer.options.transitionParams),a)}},{key:"setControlEnabled",value:function(){var a={controlEnabled:0<arguments.length&&
void 0!==arguments[0]?arguments[0]:!0};this.options.transitionParams=u(u({},this.options.transitionParams),a);this.viewer.options.transitionParams=u(u({},this.viewer.options.transitionParams),a);this.updateTransition()}},{key:"updateTransition",value:function(){var a=this;this.transition=new Ta(null,this.viewer,this.renderer,this.options.transitionParams);this.transition.addEventListener("transition-complete",function(){return a.disposePreviousViewer()});this.transition.execute()}},{key:"shareStateBetweenViewers",
value:function(){this.options=this.viewer.options;this.mode=this.viewer.mode;this.controlIndex=this.viewer.getControlIndex();this.viewer.OrbitControls.noZoom=this.inIframe()?this.disableZoomInIframe:!1;this.targetViewer&&(this.targetViewer.OrbitControls.noZoom=this.inIframe()?this.disableZoomInIframe:!1,this.mode!=z.SIDE_BY_SIDE&&this.targetViewer.mode!=z.SIDE_BY_SIDE&&this.mode!==this.targetViewer.mode&&this.targetViewer.enableEffect(this.mode),this.scissorX!==this.targetViewer.scissorX&&(this.targetViewer.scissorX=
this.scissorX),this.controlIndex!==this.targetViewer.getControlIndex()&&this.targetViewer.enableControl(this.controlIndex,!1),this.targetViewer.OrbitControls.minPolarAngle=this.viewer.OrbitControls.minPolarAngle,this.targetViewer.OrbitControls.maxPolarAngle=this.viewer.OrbitControls.maxPolarAngle,this.targetViewer.panorama.subtype===m.SLIDER||this.targetViewer.panorama.subtype===m.SIDE_BY_SIDE_2D||this.targetViewer.panorama.subtype===m.SPIN?(this.targetViewer.OrbitControls.enableDamping=!1,this.targetViewer.OrbitControls.autoRotate=
!1):(this.targetViewer.OrbitControls.enableDamping=!1,this.viewer.panorama.subtype===m.SLIDER||this.viewer.panorama.subtype===m.SIDE_BY_SIDE_2D||this.viewer.panorama.subtype===m.SPIN?this.targetViewer.OrbitControls.autoRotate=this.autoRotate:(this.targetViewer.OrbitControls.autoRotate=this.viewer.OrbitControls.autoRotate,this.autoRotate&&(this.targetViewer.autoRotateRequestId=window.setTimeout(this.targetViewer.enableAutoRate.bind(this.targetViewer),this.options.autoRotateActivationDuration)))),this.targetViewer.OrbitControls.update(),
this.targetViewer.OrbitControls.enableDamping=!0)}},{key:"setScene",value:function(a){var b=this,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1;a.render(!0);this.transition=new Ta(this.viewer,a,this.renderer,this.options.transitionParams,c);this.transition.toScene.panorama.subtype===m.PROGRESSVIE_IMAGE?this.renderer.initTexture(this.transition.toScene.panorama.srcTexture):this.transition.toScene.panorama.subtype===m.SIDE_BY_SIDE?(this.renderer.initTexture(this.transition.toScene.panorama.material.uniforms.tDiffuse1.value),
this.renderer.initTexture(this.transition.toScene.panorama.material.uniforms.tDiffuse2.value)):this.transition.toScene.panorama.subtype===m.IMAGE_LITTLE_PLANET?this.renderer.initTexture(this.transition.toScene.panorama.material.uniforms.tDiffuse.value):this.renderer.initTexture(this.transition.toScene.panorama.material.uniforms.tEquirect.value);a===this.targetViewer&&requestAnimationFrame(function(){b.transition.addEventListener("transition-complete",b.disposePreviousViewer.bind(b));b.transition.execute();
b.viewer=a;b.targetViewer=null})}},{key:"disposePreviousViewer",value:function(){for(this.transition.removeEventListener("transition-complete",this.disposePreviousViewer);2<=this.viewersQueue.length;){var a=this.viewersQueue.shift();a.dispose();a.destroy()}}},{key:"getRenderer",value:function(){return this.renderer}},{key:"getContainer",value:function(){return this.container}},{key:"render",value:function(){var a,b;this.isRenderingDisabled||(this.transition&&this.transition.render(),null===(a=this.viewer)||
void 0===a?void 0:null===(b=a.panorama)||void 0===b?void 0:b.dispatchEvent({type:"render"}))}},{key:"disableRendering",value:function(a){this.isRenderingDisabled=a}},{key:"animate",value:function(){this.render()}},{key:"destroy",value:function(){this.render();window.cancelAnimationFrame(this.requestAnimationId)}}]);return d}(e.EventDispatcher),Eb={tDiffuse:{value:new e.Texture},resolution:{value:1},transform:{value:new e.Matrix4},zoom:{value:1},opacity:{value:1}},Fb=function(g){function d(a){C(this,
d);a=k.call(this,a,d.createGeometry(1E4),d.createMaterial(1E4));a.subtype=m.IMAGE_LITTLE_PLANET;a.scale.x*=-1;a.EPS=1E-6;a.frameId=null;a.dragging=!1;a.userMouse=new e.Vector2;a.quatA=new e.Quaternion;a.quatB=new e.Quaternion;a.quatCur=new e.Quaternion;a.quatSlerp=new e.Quaternion;a.vectorX=new e.Vector3(1,0,0);a.vectorY=new e.Vector3(0,1,0);a.handlerMouseDown=a.onMouseDown.bind(r(a));a.handlerMouseMove=a.onMouseMove.bind(r(a));a.handlerMouseUp=a.onMouseUp.bind(r(a));a.handlerMouseWheel=a.onMouseWheel.bind(r(a));
a.handlerContextMenu=a.onContextMenu.bind(r(a));a.addEventListener("window-resize",a.onWindowResize);return a}D(d,g);var k=E(d);F(d,[{key:"add",value:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}a instanceof Ma&&(a.material.depthTest=!1);A(w(d.prototype),"add",this).call(this,a)}},{key:"registerMouseEvents",value:function(){this.container.addEventListener("mousedown",this.handlerMouseDown,{passive:!0});this.container.addEventListener("mousemove",
this.handlerMouseMove,{passive:!0});this.container.addEventListener("mouseup",this.handlerMouseUp,{passive:!0});this.container.addEventListener("touchstart",this.handlerMouseDown,{passive:!0});this.container.addEventListener("touchmove",this.handlerMouseMove,{passive:!0});this.container.addEventListener("touchend",this.handlerMouseUp,{passive:!0});this.container.addEventListener("mousewheel",this.handlerMouseWheel,{passive:!1});this.container.addEventListener("DOMMouseScroll",this.handlerMouseWheel,
{passive:!1});this.container.addEventListener("contextmenu",this.handlerContextMenu,{passive:!0})}},{key:"unregisterMouseEvents",value:function(){this.container.removeEventListener("mousedown",this.handlerMouseDown,!1);this.container.removeEventListener("mousemove",this.handlerMouseMove,!1);this.container.removeEventListener("mouseup",this.handlerMouseUp,!1);this.container.removeEventListener("touchstart",this.handlerMouseDown,!1);this.container.removeEventListener("touchmove",this.handlerMouseMove,
!1);this.container.removeEventListener("touchend",this.handlerMouseUp,!1);this.container.removeEventListener("mousewheel",this.handlerMouseWheel,!1);this.container.removeEventListener("DOMMouseScroll",this.handlerMouseWheel,!1);this.container.removeEventListener("contextmenu",this.handlerContextMenu,!1)}},{key:"onMouseDown",value:function(a){switch(a.touches&&0<a.touches.length||1){case 1:var b=0<=a.clientX?a.clientX:a.touches[0].clientX;a=0<=a.clientY?a.clientY:a.touches[0].clientY;this.dragging=
!0;this.userMouse.set(b,a);break;case 2:b=a.touches[0].pageX-a.touches[1].pageX,a=a.touches[0].pageY-a.touches[1].pageY,this.userMouse.pinchDistance=Math.sqrt(b*b+a*a)}this.onUpdateCallback()}},{key:"onMouseMove",value:function(a){switch(a.touches&&a.touches.length||1){case 1:var b=0<=a.clientX?a.clientX:a.touches[0].clientX;a=0<=a.clientY?a.clientY:a.touches[0].clientY;var c=.4*e.Math.degToRad(b-this.userMouse.x),d=.4*e.Math.degToRad(a-this.userMouse.y);this.dragging&&(this.quatA.setFromAxisAngle(this.vectorY,
c),this.quatB.setFromAxisAngle(this.vectorX,d),this.quatCur.multiply(this.quatA).multiply(this.quatB),this.userMouse.set(b,a));break;case 2:b=a.touches[0].pageX-a.touches[1].pageX,a=a.touches[0].pageY-a.touches[1].pageY,this.addZoomDelta(this.userMouse.pinchDistance-Math.sqrt(b*b+a*a))}}},{key:"onMouseUp",value:function(){this.dragging=!1}},{key:"onMouseWheel",value:function(a){a.preventDefault();a.stopPropagation();var b=0;void 0!==a.wheelDelta?b=a.wheelDelta:void 0!==a.detail&&(b=-a.detail);this.addZoomDelta(b);
this.onUpdateCallback()}},{key:"addZoomDelta",value:function(a){var b=this.material.uniforms,c=.1*this.size,d=10*this.size;b.zoom.value+=a;b.zoom.value<=c?b.zoom.value=c:b.zoom.value>=d&&(b.zoom.value=d)}},{key:"onUpdateCallback",value:function(){this.frameId=window.requestAnimationFrame(this.onUpdateCallback.bind(this));this.quatSlerp.slerp(this.quatCur,.1);this.material&&this.material.uniforms.transform.value.makeRotationFromQuaternion(this.quatSlerp);!this.dragging&&1-this.quatSlerp.clone().dot(this.quatCur)<
this.EPS&&window.cancelAnimationFrame(this.frameId)}},{key:"reset",value:function(){this.quatCur.set(0,0,0,1);this.quatSlerp.set(0,0,0,1);this.onUpdateCallback()}},{key:"updateTexture",value:function(a){a.minFilter=e.LinearFilter;a.magFilter=e.LinearFilter;this.material.uniforms.tDiffuse.value=a}},{key:"getTexture",value:function(){return this.material.uniforms.tDiffuse.value}},{key:"onLoad",value:function(a){this.updateTexture(a[0]);this.material.uniforms.resolution.value=this.container.clientWidth/
this.container.clientHeight;this.registerMouseEvents();this.onUpdateCallback();this.dispatchEvent({type:"panolens-viewer-handler",method:"disableControl"});A(w(d.prototype),"finishLoading",this).call(this)}},{key:"onLeave",value:function(){this.unregisterMouseEvents();this.dispatchEvent({type:"panolens-viewer-handler",method:"enableControl",data:N.ORBIT});window.cancelAnimationFrame(this.frameId);A(w(d.prototype),"onLeave",this).call(this)}},{key:"onWindowResize",value:function(){this.material.uniforms.resolution.value=
this.container.clientWidth/this.container.clientHeight}},{key:"onContextMenu",value:function(){this.dragging=!1}},{key:"dispose",value:function(){var a=this.material.uniforms.tDiffuse;a&&a.value&&a.value.dispose();this.unregisterMouseEvents();A(w(d.prototype),"dispose",this).call(this)}}],[{key:"createGeometry",value:function(){return new e.PlaneBufferGeometry(1E4,5E3)}},{key:"createMaterial",value:function(){var a=e.UniformsUtils.clone(Eb);a.zoom.value=1E4;a.opacity.value=0;return new e.ShaderMaterial({vertexShader:"\n\n        varying vec2 vUv;\n\n        void main() {\n\n            vUv = uv;\n            gl_Position = vec4( position, 1.0 );\n\n        }\n\n    ",
fragmentShader:"\n\n        uniform sampler2D tDiffuse;\n        uniform float resolution;\n        uniform mat4 transform;\n        uniform float zoom;\n        uniform float opacity;\n\n        varying vec2 vUv;\n\n        const float PI = 3.141592653589793;\n\n        void main(){\n\n            vec2 position = -1.0 +  2.0 * vUv;\n\n            position *= vec2( zoom * resolution, zoom * 0.5 );\n\n            float x2y2 = position.x * position.x + position.y * position.y;\n            vec3 sphere_pnt = vec3( 2. * position, x2y2 - 1. ) / ( x2y2 + 1. );\n\n            sphere_pnt = vec3( transform * vec4( sphere_pnt, 1.0 ) );\n\n            vec2 sampleUV = vec2(\n                (atan(sphere_pnt.y, sphere_pnt.x) / PI + 1.0) * 0.5,\n                (asin(sphere_pnt.z) / PI + 0.5)\n            );\n\n            gl_FragColor = texture2D( tDiffuse, sampleUV );\n            gl_FragColor.a *= opacity;\n\n        }\n    ",
uniforms:a,transparent:!0,opacity:0})}}]);return d}(ua);pa.prototype=Object.assign(Object.create(e.EventDispatcher.prototype),{constructor:pa});var Gb=function(g){function d(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};C(this,d);var c=k.call(this,d.createGeometry(),d.createMaterial());c.options=u({},b);c.container=a;c.passThrough=!0;c.subtype=t.SPOT_MODEL;return c}D(d,g);var k=E(d);F(d,[{key:"dispose",value:function(){var a=this.geometry,b=this.material;a&&(a.dispose(),this.geometry=
null);b&&(b.dispose(),this.material=null)}}],[{key:"createGeometry",value:function(){return new e.SphereGeometry(.5,30,1,0,2*Math.PI,1,1)}},{key:"createMaterial",value:function(){return new e.MeshToonMaterial({color:302836,transparent:!0,opacity:0})}}]);return d}(e.Mesh),Hb=function(g){function d(a,b,c,f){var h=4<arguments.length&&void 0!==arguments[4]?arguments[4]:function(){},g=5<arguments.length&&void 0!==arguments[5]?arguments[5]:{};C(this,d);var l=k.call(this,d.createGeometry(),d.createMaterial());
l.subtype=m.SPIN;l.options=u({onLoadOneCallback:function(){},onLoadPassCallback:function(){},onInitialAutoRotateFinished:function(){},numberOfPasses:null,preview:null},g);l.onInitialAutoRotateFinished=function(){return l.options.onInitialAutoRotateFinished()};l.initialSpinFrame=l.options.initialSpinFrame||0;l.initialSpinZoom=l.options.initialSpinZoom||75;l.currentSide=l.initialSpinFrame;l.backgroundMode=l.options.backgroundMode||T.DEFAULT;l.desiredWidth=l.options.desiredWidth||null;l.desiredHeight=
l.options.desiredHeight||null;l.desiredPosition=new e.Vector3(0,0,-2);l.position.copy(l.desiredPosition);l.src=l.options.preview||a&&a[l.initialSpinFrame];l.currentSideTexture=null;l.currentSide=null;if(!l.src)return console.error("Spin Panorama: the array of images is empty."),Ea(l);l.spotModel=new Gb(l.container);l.spotModel.scale.set(1,1,1);l.spotModel.position.set(0,0,0);l.spotModel.rotation.y+=l.initialSpinFrame/a.length*Math.PI*2;l.add(l.spotModel);var q=l.options.numberOfPasses||Math.ceil(Math.log2(a.length));
l.texturesArray=Array(a.length);var n=function(a){return a===q-1?Math.pow(2,a):Math.pow(2,a+1)},r=function(b){return b===q-1?l.initialSpinFrame:(l.initialSpinFrame+Math.pow(2,b))%a.length},p=function(){return Object.values(t).reduce(function(a,b){return a+=b.count},0)/a.length},t=Array(q).fill(0).map(function(a,b){return b}).reduce(function(b,c){var d=Math.ceil((a.length-r(c))/n(c));b[c]={total:d,count:0};return b},{});l.setUpSpinEnvironment=function(d){l.container.children[0].style.backgroundImage=
"url(".concat(a[l.initialSpinFrame],")");l.container.children[0].style.backgroundPosition="center";l.container.children[0].style.backgroundSize=l.backgroundMode===T.COLOR?"1%":"cover";l.desiredWidth=l.spotModel.desiredWidth=l.desiredWidth||d.image.width;l.desiredHeight=l.spotModel.desiredHeight=l.desiredHeight||d.image.height;for(var e=0;e<a.length;e++)l.texturesArray[e]=d;l.controls=new pa(b,c,l.spotModel,f,l.texturesArray.length,l.initialSpinFrame);l.controls.addEventListener("rotation",l.onRotation,
!1);l.controls.addEventListener("initial-auto-rotate-finished",l.onInitialAutoRotateFinished,!1);v(q-1)};l.onRotation=function(b){var c;b=b.data.currentSide;l.currentSide===b||null!==(c=l.texturesArray[b])&&void 0!==c&&c.isBadUrl||(l.currentSide=b,c=l.currentSideTexture,l.currentSideTexture=l.texturesArray[b],null===c||void 0===c?void 0:c.dispose(),l.updateTexture(l.currentSideTexture),l.material.needsUpdate=!0,l.needsUpdate=!0,l.src=a[b])};l.rotateBySide=function(b){l.onRotation(b);l.spotModel.rotation.y+=
(b.data.currentSide-l.currentSide)/a.length*Math.PI*2;l.currentSide=b.data.currentSide};var v=function(b){for(var c=r(b),d=n(b),e=function(c){var d=c%a.length;W.load(a[d],function(c){t[b].count++;for(var e=0;e<n(b)/2;e++)d+e>=a.length||(l.texturesArray[d+e]=c);c=p();c===1/a.length&&l.dispatchEvent({type:"first-image-loaded"});l.options.onLoadOneCallback(c);t[b].count===t[b].total&&(l.options.onLoadPassCallback(b),0===b?(h(),l.controls.texturesLoaded=!0,l.options.disabledAutoAnimation||l.controls.animate(!1,
l.initialSpinFrame)):v(b-1))})},f=c;f<a.length+c;f+=d)e(f)};return l}D(d,g);var k=E(d);F(d,[{key:"load",value:function(a){a=a||this.src;if(!a)console.warn("Image source undefined");else if("string"===typeof a)W.load(a,this.onLoad.bind(this),this.onProgress.bind(this),this.onError.bind(this));else if(a instanceof HTMLImageElement)this.onLoad(new e.Texture(a))}},{key:"add",value:function(a){a.type===t.INFOSPOT?(this.dispatchInfospotListeners(a),this.spotModel.add(a)):A(w(d.prototype),"add",this).call(this,
a)}},{key:"onLoad",value:function(a){a.minFilter=a.magFilter=e.LinearFilter;a.needsUpdate=!0;this.updateTexture(a);window.requestAnimationFrame(A(w(d.prototype),"onLoad",this).bind(this));this.setUpSpinEnvironment(a)}},{key:"reset",value:function(){A(w(d.prototype),"reset",this).call(this)}},{key:"dispose",value:function(){var a,b,c,f,h;if(null!==(a=this.material)&&void 0!==a&&null!==(b=a.uniforms)&&void 0!==b&&null!==(c=b.tEquirect)&&void 0!==c&&c.value){var g,l,k;null===(g=this.material)||void 0===
g?void 0:null===(l=g.uniforms)||void 0===l?void 0:null===(k=l.tEquirect)||void 0===k?void 0:k.value.dispose()}this.texturesArray.forEach(function(a){a.dispose()});null===(f=this.controls)||void 0===f?void 0:f.removeEventListener("rotation",this.onRotation,!1);null===(h=this.controls)||void 0===h?void 0:h.removeEventListener("initial-auto-rotate-finished",this.onInitialAutoRotateFinished,!1);e.Cache.remove(this.src);A(w(d.prototype),"dispose",this).call(this)}}],[{key:"createGeometry",value:function(){return new e.PlaneBufferGeometry(1,
1)}},{key:"createMaterial",value:function(){var a=e.UniformsUtils.clone(Aa);a.repeat.value.copy(new e.Vector2(1,1));a.offset.value.copy(new e.Vector2(0,0));a.opacity.value=0;return new e.ShaderMaterial({fragmentShader:"\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n\n            varying vec2 texcoord;\n            uniform sampler2D tEquirect;\n\n            void main()\n            {\n                /* Set color of the fragment */\n                gl_FragColor = texture2D(tEquirect, texcoord);}\n                \n    ",
vertexShader:"\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n\n            varying vec2 texcoord;\n\n            void main()\n            {\n                gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);\n                texcoord  = uv;\n            }\n    ",uniforms:a,side:e.FrontSide,transparent:!0})}}]);return d}(S);fa.prototype=Object.create(e.EventDispatcher.prototype);fa.prototype.constructor=fa;Y.prototype=Object.assign(Object.create(e.EventDispatcher.prototype),
{constructor:Y});ra.prototype=Object.assign(Object.create(e.EventDispatcher.prototype),{constructor:ra});Object.assign(ha.prototype,{constructor:ha,updateUniformByFormat:function(e,d){this.format=e;var g=d.repeat.value;d=d.offset.value;var a=this.loffset,b=this.roffset;switch(e){case X.TAB:g.set(1,.5);d.set(0,.5);a.set(0,.5);b.set(0,0);break;case X.SBS:g.set(.5,1),d.set(0,0),a.set(0,0),b.set(.5,0)}},updateTextureToLeft:function(e){e.copy(this.loffset)},updateTextureToRight:function(e){e.copy(this.roffset)}});
var Za=function(g){function d(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new ha;C(this,d);var c=k.call(this,a);c.type=m.STEREO_IMAGE;c.stereo=b;return c}D(d,g);var k=E(d);F(d,[{key:"onLoad",value:function(a){var b=a.image;this.stereo.updateUniformByFormat(4===b.width/b.height?X.SBS:X.TAB,this.material.uniforms);this.material.uniforms.tEquirect.value=a;A(w(d.prototype),"onLoad",this).call(this,a)}},{key:"updateTextureToLeft",value:function(){this.stereo.updateTextureToLeft(this.material.uniforms.offset.value)}},
{key:"updateTextureToRight",value:function(){this.stereo.updateTextureToRight(this.material.uniforms.offset.value)}},{key:"dispose",value:function(){var a=this.material.uniforms.tEquirect.value;a instanceof e.Texture&&a.dispose();A(w(d.prototype),"dispose",this).call(this)}}]);return d}(ua),$a=function(g){function d(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new ha;C(this,d);b=k.call(this,a,b);b.type=m.STEREO_VIDEO_PANORAMA;
b.stereo=c;return b}D(d,g);var k=E(d);F(d,[{key:"onLoad",value:function(a){var b=a.image;this.stereo.updateUniformByFormat(4===b.videoWidth/b.videoHeight?X.SBS:X.TAB,this.material.uniforms);this.material.uniforms.tEquirect.value=a;A(w(d.prototype),"onLoad",this).call(this)}},{key:"updateTextureToLeft",value:function(){this.stereo.updateTextureToLeft(this.material.uniforms.offset.value)}},{key:"updateTextureToRight",value:function(){this.stereo.updateTextureToRight(this.material.uniforms.offset.value)}},
{key:"dispose",value:function(){var a=this.material.uniforms.tEquirect.value;a instanceof e.Texture&&a.dispose();A(w(d.prototype),"dispose",this).call(this)}}]);return d}(ca),Ib=function(g){var d=new e.StereoCamera;d.aspect=.5;var k=new e.Vector2;this.setEyeSeparation=function(a){d.eyeSep=a};this.setSize=function(a,b){g.setSize(a,b)};this.render=function(a,b){a.updateMatrixWorld();null===b.parent&&b.updateMatrixWorld();d.update(b);g.getSize(k);g.autoClear&&g.clear();g.setScissorTest(!0);g.setScissor(0,
0,k.width/2,k.height);g.setViewport(0,0,k.width/2,k.height);g.render(a,d.cameraL);g.setScissor(k.width/2,0,k.width/2,k.height);g.setViewport(k.width/2,0,k.width/2,k.height);g.render(a,d.cameraR);g.setScissorTest(!1)}},Jb=function(g){function d(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};C(this,d);var b=k.call(this);b.options=u({container:b.setupContainer(a.container),controlBar:!1,controlButtons:[],autoHideControlBar:!0,autoHideInfospot:!0,horizontalView:!1,clickTolerance:10,
cameraFov:60,reverseDragging:!1,enableReticle:!1,dwellTime:1500,autoReticleSelect:!0,output:null,autoRotate:!1,autoRotateSpeed:2,autoRotateActivationDuration:5E3,initialLookAt:new e.Vector3(0,0,-Number.MAX_SAFE_INTEGER),cameraInitialLookAt:null,momentum:!0,rotateSpeed:-1,dampingFactor:.1,defaultFov:60,horizontalViewLimit:!1,horizontalViewDownLimitDegrees:0,horizontalViewUpLimitDegrees:180,objectFit:"contain"},a);b.viewerInstanceNumber=Math.floor(30*Math.random());var c=b.options;a=c.container;var f=
c.cameraFov,h=c.defaultFov,g=c.controlBar,l=c.enableReticle,m=c.reverseDragging,n=c.output,q=c.scene,p=c.camera,t=c.renderer,w=c.scissorX;c=c.objectFit;var x=a.clientWidth,H=a.clientHeight,A={minFilter:e.LinearFilter,magFilter:e.LinearFilter};b.fbo=new e.WebGLRenderTarget(x,H,A);b.reticleFbo=new e.WebGLRenderTarget(x,H,A);b.container=a;b.scene=b.setupScene(q);b.sceneReticle=new e.Scene;b.defaultFov=h;b.camera=b.setupCamera(f,x/H,p);b.aux=b.setupAuxiliaryEntities();b.renderer=b.setupRenderer(t,a);
b.reticle=b.addReticle(b.camera,b.sceneReticle);b.control=b.setupControls(b.camera,a);b.effect=b.setupEffects(b.renderer,a);b.lastTouch={plane:null,scene:null};b.containerCursor=R.GRAB;b.CURSORS=R;b.objectFit=c;b.mode=z.NORMAL;b.panorama=null;b.widget=null;b.hoverObject=null;b.infospot=null;b.pressEntityObject=null;b.pressObject=null;b.raycaster=new e.Raycaster;b.raycasterPoint=new e.Vector2;b.userMouse=new e.Vector2;b.updateCallbacks=[];b.requestAnimationId=null;b.cameraFrustum=new e.Frustum;b.cameraViewProjectionMatrix=
new e.Matrix4;b.autoRotateRequestId=null;b.outputDivElement=null;b.touchSupported="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;b.tweenLeftAnimation=new v.Tween;b.tweenUpAnimation=new v.Tween;b.tweenCanvasOpacityOut=new v.Tween;b.tweenCanvasOpacityIn=new v.Tween;b.outputEnabled=!1;b.tempEnableReticle=l;b.scissorX=w;b.setupTween();b.handlerMouseUp=b.onMouseUp.bind(r(b));b.handlerMouseDown=b.onMouseDown.bind(r(b));b.handlerMouseMove=b.onMouseMove.bind(r(b));b.handlerWindowResize=
b.onWindowResize.bind(r(b));b.handlerKeyDown=b.onKeyDown.bind(r(b));b.handlerKeyUp=b.onKeyUp.bind(r(b));b.handlerTap=b.onTap.bind(r(b),{clientX:x/2,clientY:H/2});g&&b.addDefaultControlBar(b.options.controlButtons);m&&b.reverseDraggingDirection();l?b.enableReticleControl():b.registerMouseAndTouchEvents();"overlay"===n&&b.addOutputElement();b.registerEventListeners();b.setupFloorCursor();return b}D(d,g);var k=E(d);F(d,[{key:"setupScene",value:function(){return 0<arguments.length&&void 0!==arguments[0]?
arguments[0]:new e.Scene}},{key:"setupCamera",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new e.PerspectiveCamera(a,b,1,11E3);c.position.z=1;return c}},{key:"setupRenderer",value:function(){return 0<arguments.length&&void 0!==arguments[0]?arguments[0]:new e.WebGLRenderer({alpha:!0,antialias:!1})}},{key:"setupControls",value:function(a,b){var c=this.options,d=c.autoRotate,e=c.autoRotateSpeed,g=c.horizontalView,l=c.momentum,k=c.rotateSpeed,n=c.dampingFactor,m=c.horizontalViewLimit,
p=c.horizontalViewDownLimitDegrees,q=c.horizontalViewUpLimitDegrees;c=new Y(a,b);c.id="orbit";c.index=N.ORBIT;c.minDistance=1;c.noPan=!0;c.autoRotate=d;c.autoRotateSpeed=e;c.momentum=l;c.rotateSpeed=k;c.dampingFactor=n;c.enabled=!0;c.addEventListener("fov",this.dispatchEventToChildren.bind(this));a=new ra(a,b);a.id="device-orientation";a.index=N.DEVICEORIENTATION;a.enabled=!1;g&&(c.minPolarAngle=Math.PI/2,c.maxPolarAngle=Math.PI/2);!g&&m&&(c.minPolarAngle=Math.PI/180*p,c.maxPolarAngle=Math.PI/180*
q);g={id:"drag",index:N.DRAG,enabled:!1};this.controls=[c,a,{id:"object",index:N.OBJECT,enabled:!1},g];this.OrbitControls=c;this.DeviceOrientationControls=a;this.DragControls=g;return c}},{key:"setupEffects",value:function(a,b){var c=b.clientWidth;b=b.clientHeight;var d=new Ya(a);d.setSize(c,b);var e=new Ib(a);e.setSize(c,b);a=new ab(a,this.panorama);a.setSize(c,b);this.CardboardEffect=d;this.StereoEffect=e;this.SideBySide=a;return d}},{key:"setupContainer",value:function(a){a._width=a.clientWidth;
a._height=a.clientHeight;return a}},{key:"setupTween",value:function(){this.tweenCanvasOpacityOut.to({},500).easing(v.Easing.Exponential.Out);this.tweenCanvasOpacityIn.to({},500).easing(v.Easing.Exponential.Out);this.tweenCanvasOpacityOut.chain(this.tweenCanvasOpacityIn)}},{key:"setupFloorCursor",value:function(){this.floorCursor=new La;this.add(this.floorCursor)}},{key:"setupAuxiliaryEntities",value:function(){var a=new e.Quaternion,b=new e.Matrix4;return{quaternion:a,matrix:b}}},{key:"setContainerCursor",
value:function(a){this.containerCursor=a;this.container&&(this.container.style.cursor=a)}},{key:"applyDefaultContainerCursor",value:function(){this.container&&(this.container.style.cursor=this.containerCursor)}},{key:"add",value:function(a){var b=this,c=this.container,d=this.scene,e=this.camera,g=this.controls;if(1<arguments.length){for(c=0;c<arguments.length;c++)this.add(arguments[c]);return this}d.add(a);a.addEventListener&&a.addEventListener("panolens-viewer-handler",this.eventHandler.bind(this));
a.type===sa.FLOOR&&(this.floorCursor=a);a.type===m.PANORAMA&&(a.dispatchEvent({type:"panolens-container",container:c}),a.dispatchEvent({type:"panolens-scene",scene:d}),a.dispatchEvent({type:"panolens-camera",camera:e}),a.dispatchEvent({type:"panolens-controls",controls:g}),this.addPanoramaEventListener(a),a.subtype!==m.SIDE_BY_SIDE&&a.subtype!==m.SIDE_BY_SIDE_2D||this.enableEffect(z.SIDE_BY_SIDE),this.panorama||(this.setPanorama(a),this.setControlCenter(this.options.initialLookAt)));if(a.subtype===
m.SLIDER||a.subtype===m.SIDE_BY_SIDE_2D||a.subtype===m.SPIN||a.subtype===m.VIDEO_2D){this.camera.position.set(0,0,1);d.add(a);this.controls[N.OBJECT]={};var l=!1,k=(new v.Tween(a.position)).to({x:0,y:0,z:-2},500).easing(v.Easing.Cubic.Out).onStart(function(){l=!0}).onComplete(function(){l=!1});a.addEventListener("addChild",this.fitObjectToScreenEvent.bind(this));a.addEventListener("ready",function(){b.OrbitControls.addEventListener("start",function(){b.DragControls.enabled=!1});b.OrbitControls.addEventListener("end",
function(){b.camera.fov<b.defaultFov?(b.DragControls.enabled=!0,b.panorama.subtype===m.SPIN&&(b.panorama.controls.setIsZoomed(!0),b.panorama.controls.disableHorizontalRotation())):(l||k.start(),b.panorama.subtype===m.SPIN&&(b.panorama.controls.setIsZoomed(!1),b.panorama.controls.enableHorizontalRotation()))});b.OrbitControls.addEventListener("change",function(){b.DragControls.enabled=!1});b.DragControls=Object.assign(new fa([a],b.camera,b.container),b.DragControls);b.DragControls.activate();b.camera.fov<
b.defaultFov&&(b.DragControls.enabled=!0)});a.addEventListener("ready",this.fitObjectToScreenEvent.bind(this))}}},{key:"fitObjectToScreenEvent",value:function(a){a.target.subtype!==m.SLIDER&&a.target.subtype!==m.SIDE_BY_SIDE_2D&&a.target.subtype!==m.SPIN&&a.target.subtype!==m.VIDEO_2D||this.fitObjectToScreen(a.target)}},{key:"fitObjectToScreen",value:function(a){var b;if(a){var c=a.desiredWidth/a.desiredHeight;a.position.copy(a.desiredPosition);this.camera.lookAt(a.position);var d=2*Math.tan(this.camera.fov/
360*Math.PI),g=this.camera.aspect/c*d,k=this.defaultFov||60,l;"cover"==this.objectFit?l=Math.max(d,g)*(this.camera.position.z-a.position.z):"contain"==this.objectFit&&(l=d>g?g*(this.camera.position.z-a.position.z):d*(this.camera.position.z-a.position.z));l*=k/this.camera.fov;a.scale.set(l*c,l,1);a.subtype===m.SPIN&&(a.spotModel.scale.set(1,1,1),a.spotModel.scale.set(a.spotModel.scale.x/c,a.spotModel.scale.y,a.spotModel.scale.z/c));null===(b=a.children)||void 0===b?void 0:b.forEach(function(b){if(!b.alreadyScaled&&
a.subtype!==m.SPIN&&b.type===t.INFOSPOT){b.scale.set(b.scale.x/c,b.scale.y,b.scale.z);b._parentRatio=c;var d=new e.Vector3;d.copy(b.scale);b.scaleUpAnimation=(new v.Tween(b.scale)).to({x:1.3*d.x,y:1.3*d.y},500).easing(v.Easing.Elastic.Out);b.scaleDownAnimation=(new v.Tween(b.scale)).to({x:d.x,y:d.y},500).easing(v.Easing.Elastic.Out);null!=b.map&&(b.map.needsUpdate=!0);b.needsUpdate=!0;b.updateMatrixWorld();a.updateMatrixWorld();b.alreadyScaled=!0}});this.currentScale=l;this.currentRatio=c;this.panorama.subtype===
m.SPIN&&(this.OrbitControls.maxFov=this.camera.fov,this.setCameraFov(this.panorama.initialSpinZoom||this.camera.fov))}}},{key:"remove",value:function(a){a.removeEventListener&&a.removeEventListener("panolens-viewer-handler",this.eventHandler.bind(this));this.scene.remove(a)}},{key:"addDefaultControlBar",value:function(a){if(!this.widget){var b=new Ja(this.container);b.addEventListener("panolens-viewer-handler",this.eventHandler.bind(this));b.addControlBar();a.forEach(function(a){b.addControlButton(a)});
this.widget=b}}},{key:"setPanorama",value:function(a){var b=this.panorama;a.type===m.PANORAMA&&b!==a&&(this.hideInfospot(),b&&(b._onReady&&(b.removeEventListener("ready",b._onReady),delete b._onReady),b.onLeave()),a._onLeaveComplete&&(a.removeEventListener("leave-complete",a._onLeaveComplete),delete a._onLeaveComplete),b=function f(){a.removeEventListener("ready",f);delete a._onReady;a.active&&a.fadeIn()},a.addEventListener("ready",b),a._onReady=b,this.panorama=a,this.panorama.onEnter())}},{key:"eventHandler",
value:function(a){if(a.method&&this[a.method])this[a.method](a.data)}},{key:"dispatchEventToChildren",value:function(a){this.scene.traverse(function(b){b.dispatchEvent&&b.dispatchEvent(a)})}},{key:"activateWidgetItem",value:function(a,b){var c=this.widget.mainMenu,d=c.children[0];c=c.children[1];if(void 0!==a){switch(a){case 0:a=d.subMenu.children[1];break;case 1:a=d.subMenu.children[2];break;default:a=d.subMenu.children[1]}d.subMenu.setActiveItem(a);d.setSelectionTitle(a.textContent)}if(void 0!==
b){switch(b){case z.CARDBOARD:a=c.subMenu.children[2];break;case z.STEREO:a=c.subMenu.children[3];break;default:a=c.subMenu.children[1]}c.subMenu.setActiveItem(a);c.setSelectionTitle(a.textContent)}}},{key:"enableEffect",value:function(a){var b=this;if(this.mode!==a)if(a===z.NORMAL)this.disableEffect();else{this.mode=a;var c=this.camera.fov;switch(a){case z.CARDBOARD:this.effect=this.CardboardEffect;this.enableReticleControl();break;case z.STEREO:this.effect=this.StereoEffect;this.enableReticleControl();
break;case z.SIDE_BY_SIDE:this.effect=this.SideBySide;break;default:this.effect=null,this.disableReticleControl()}this.dispatchEventToChildren({type:"panolens-dual-eye-effect",mode:this.mode});this.disableAutoRate();this.camera.fov=c+.01;setTimeout(function(){if(document.fullscreenElement){var a=window.screen.width;var c=window.screen.height}else a=b.container.clientWidth,c=b.container.clientHeight;b.effect.setSize(a,c);b.render()},50);this.camera.fov=c;this.dispatchEvent({type:"mode-change",mode:this.mode});
this.dispatchEvent({type:"viewerStateUpdate"})}}},{key:"disableEffect",value:function(){this.mode!==z.NORMAL&&(this.mode=z.NORMAL,this.disableReticleControl(),this.dispatchEventToChildren({type:"panolens-dual-eye-effect",mode:this.mode}),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.render(),this.options.autoRotate&&this.enableAutoRate(),this.dispatchEvent({type:"mode-change",mode:this.mode}),this.dispatchEvent({type:"viewerStateUpdate"}))}},{key:"enableReticleControl",
value:function(){this.reticle.visible||(this.tempEnableReticle=!0,this.unregisterMouseAndTouchEvents(),this.reticle.show(),this.registerReticleEvent(),this.updateReticleEvent())}},{key:"disableReticleControl",value:function(){this.tempEnableReticle=!1;this.options.enableReticle?this.updateReticleEvent():(this.reticle.hide(),this.unregisterReticleEvent(),this.registerMouseAndTouchEvents())}},{key:"enableAutoRate",value:function(){this.options.autoRotate=!0;this.OrbitControls.autoRotate=!0;this.dispatchEvent({type:"enableAutoRotate"})}},
{key:"disableAutoRate",value:function(){clearTimeout(this.autoRotateRequestId);this.dispatchEvent({type:"viewerStateUpdate"});this.options.autoRotate=!1;this.OrbitControls.autoRotate=!1}},{key:"toggleVideoPlay",value:function(a){this.panorama.subtype!==m.VIDEO&&this.panorama.subtype!==m.VIDEO_2D||this.panorama.dispatchEvent({type:"video-toggle",pause:a})}},{key:"toggleVideoSound",value:function(){this.panorama.subtype!==m.VIDEO&&this.panorama.subtype!==m.VIDEO_2D||this.panorama.dispatchEvent({type:"video-toggle",
toggleMute:!0})}},{key:"setVideoCurrentTime",value:function(a){this.panorama.subtype!==m.VIDEO&&this.panorama.subtype!==m.VIDEO_2D||this.panorama.dispatchEvent({type:"video-time",percentage:a})}},{key:"onVideoUpdate",value:function(a){var b=this.widget;b&&b.dispatchEvent({type:"video-update",percentage:a.percentage,quality:a.quality})}},{key:"addUpdateCallback",value:function(a){a&&this.updateCallbacks.push(a)}},{key:"removeUpdateCallback",value:function(a){var b=this.updateCallbacks.indexOf(a);a&&
0<=b&&this.updateCallbacks.splice(b,1)}},{key:"showVideoWidget",value:function(){var a=this.widget;a&&a.dispatchEvent({type:"video-control-show"})}},{key:"hideVideoWidget",value:function(){var a=this.widget;a&&a.dispatchEvent({type:"video-control-hide"})}},{key:"updateVideoPlayButton",value:function(a){var b=this.widget;b&&b.videoElement&&b.videoElement.controlButton&&b.videoElement.controlButton.update(a)}},{key:"addPanoramaEventListener",value:function(a){var b=this;if(a.subtype===m.VIDEO||a.subtype===
m.VIDEO_2D)a.addEventListener("enter-fade-start",this.showVideoWidget.bind(this)),a.addEventListener("leave-start",function(){b.panorama.subtype!==m.VIDEO&&b.pano.subtype!==m.VIDEO_2D&&b.hideVideoWidget.call(b)})}},{key:"setControl",value:function(a){this.control=this.controls[a];this.dispatchEvent({type:"viewerStateUpdate"})}},{key:"getControl",value:function(){return this.control}},{key:"getScene",value:function(){return this.scene}},{key:"getCamera",value:function(){return this.camera}},{key:"getRenderer",
value:function(){return this.renderer}},{key:"getContainer",value:function(){return this.container}},{key:"getControlId",value:function(){return this.control.id}},{key:"getNextControlId",value:function(){return this.controls[this.getNextControlIndex()].id}},{key:"getNextControlIndex",value:function(){var a=this.controls,b=a.indexOf(this.control)+1;return b>=a.length?0:b}},{key:"getControlIndex",value:function(){return this.controls.indexOf(this.control)}},{key:"setCameraFov",value:function(a){this.camera.fov=
a;this.camera.updateProjectionMatrix()}},{key:"getRaycastViewCenter",value:function(){var a=new e.Raycaster;a.setFromCamera(new e.Vector2(0,0),this.camera);a=a.intersectObject(this.panorama);return 0<a.length?a[0].point:new e.Vector3(0,0,-1)}},{key:"enableControl",value:function(){var a=this,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:N.ORBIT,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0,d=this.control.index,e=this.controls,g=this.OrbitControls,k=this.DeviceOrientationControls,
m=this.tweenCanvasOpacityOut,n=this.tweenCanvasOpacityIn,q=this.container.querySelector("canvas");if(b!==d){if(b===N.DEVICEORIENTATION)m.onStart(function(){g.enabled=!1;k.enabled=!1;c?q.style.opacity=0:null}),n.onStart(function(){g.enabled=!0;k.updateAlphaOffsetAngle(g.publicSphericalDelta.data.theta);k.connect();c?q.style.opacity=1:null});else{d=k.getRotations;d();var p=this.getRaycastViewCenter();m.onStart(function(){g.enabled=!1;k.disconnect();q.style.opacity=0});n.onStart(function(){g.enabled=
!0;a.setControlCenter(p);q.style.opacity=1})}m.start();this.control=e[b]}}},{key:"disableControl",value:function(){this.control.enabled=!1}},{key:"toggleNextControl",value:function(){this.enableControl(this.getNextControlIndex())}},{key:"getScreenVector",value:function(a){a=a.clone();var b=this.container.clientWidth/2,c=this.container.clientHeight/2;a.project(this.camera);a.x=a.x*b+b;a.y=-(a.y*c)+c;a.z=0;return a}},{key:"checkSpriteInViewport",value:function(a){this.camera.matrixWorldInverse.copy(this.camera.matrixWorld).invert();
this.cameraViewProjectionMatrix.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse);this.cameraFrustum.setFromProjectionMatrix(this.cameraViewProjectionMatrix);return a.visible&&this.cameraFrustum.intersectsSprite(a)}},{key:"reverseDraggingDirection",value:function(){console.warn("reverseDragging option is deprecated. Please use rotateSpeed to indicate strength and direction");this.OrbitControls.rotateSpeed*=-1}},{key:"addReticle",value:function(a,b){var c=new Ka(16777215,
!0,this.options.dwellTime);c.hide();a.add(c);b.add(a);return c}},{key:"rotateControlLeft",value:function(a){this.OrbitControls.rotateLeftStatic(a)}},{key:"rotateControlUp",value:function(a){this.OrbitControls.rotateUpStatic(a)}},{key:"rotateControl",value:function(a,b){this.rotateControlLeft(a);this.rotateControlUp(b)}},{key:"calculateCameraDirectionDelta",value:function(a){var b=this.camera.getWorldDirection(new e.Vector3);var c=b.clone();var d=this.panorama.getWorldPosition(new e.Vector3).sub(this.camera.getWorldPosition(new e.Vector3));
a=a.clone();a.add(d).normalize();var g=a.clone();b.y=0;a.y=0;d=Math.atan2(a.z,a.x)-Math.atan2(b.z,b.x);d=d>Math.PI?d-2*Math.PI:d;d=d<-Math.PI?d+2*Math.PI:d;b=Math.abs(c.angleTo(b)+(0>=c.y*g.y?g.angleTo(a):-g.angleTo(a)));b*=g.y<c.y?1:-1;return{left:d,up:b}}},{key:"setControlCenter",value:function(){var a=this.calculateCameraDirectionDelta(0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.options.initialLookAt);this.rotateControl(a.left,a.up)}},{key:"tweenControlCenter",value:function(a,
b,c){Array.isArray(a)&&(c=a[2],b=a[1],a=a[0]);b=void 0!==b?b:400;c=c||v.Easing.Exponential.Out;var d=this.calculateCameraDirectionDelta(a);a=d.left;d=d.up;var e=this.rotateControlLeft.bind(this),g=this.rotateControlUp.bind(this),k={left:0,up:0},m=0,n=0;this.tweenLeftAnimation.stop();this.tweenUpAnimation.stop();this.tweenLeftAnimation=(new v.Tween(k)).to({left:a},b).easing(c).onUpdate(function(a){e(a.left-m);m=a.left}).start();this.tweenUpAnimation=(new v.Tween(k)).to({up:d},b).easing(c).onUpdate(function(a){g(a.up-
n);n=a.up}).start()}},{key:"tweenControlCenterByObject",value:function(a,b,c){this.tweenControlCenter(a.getWorldPosition(new e.Vector3),b,c)}},{key:"onWindowResize",value:function(a,b){var c=this.container.classList.contains("panolens-container")||this.container.isFullscreen;if(void 0!==a&&void 0!==b){var d=a;var e=b;this.container._width=a;this.container._height=b}else a=la?Math.min(document.documentElement.clientWidth,window.innerWidth||0):Math.max(document.documentElement.clientWidth,window.innerWidth||
0),b=la?Math.min(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientHeight,window.innerHeight||0),d=c?a:this.container.clientWidth,e=c?b:this.container.clientHeight,this.container._width=d,this.container._height=e;this.camera.aspect=d/e;this.camera.updateProjectionMatrix();this.renderer.setSize(d,e);if(this.panorama&&this.panorama.subtype===m.SLIDER||this.panorama&&this.panorama.subtype===m.SPIN||this.panorama&&this.panorama.subtype===m.VIDEO_2D)this.renderer.clear(),
this.renderer.clearDepth(),this.fitObjectToScreen(this.panorama);(this.options.enableReticle||this.tempEnableReticle)&&this.updateReticleEvent();this.dispatchEvent({type:"window-resize",width:d,height:e});this.scene.traverse(function(a){a.dispatchEvent&&a.dispatchEvent({type:"window-resize",width:d,height:e})})}},{key:"addOutputElement",value:function(){var a=document.createElement("div");a.style.position="absolute";a.style.right="10px";a.style.top="10px";a.style.color="#fff";this.container.append(a);
this.outputDivElement=a}},{key:"getPlanePosition",value:function(a){var b=new e.Vector3(-1,1,1),c=a.point.clone();c.multiply(b);a=Math.round(Math.abs(a.point.y))!==Math.abs(Z.Y);if(0!==c.length()&&!a)return c}},{key:"getSliderPosition",value:function(a){a=a.point.clone();return new e.Vector3(((a.x+this.panorama.position.x)/this.currentScale/this.currentRatio).toFixed(6),((a.y-this.panorama.position.y)/this.currentScale).toFixed(6),(0).toFixed(2))}},{key:"get360Position",value:function(a){var b=new e.Vector3(-1,
1,1);a=a.point.clone();a.multiply(b);if(0!==a.length())return a}},{key:"outputPosition",value:function(){var a=this,b=this.raycaster.intersectObject(this.panorama,!0);if(0<b.length){var c={plane:null,scene:null};b.forEach(function(d){if(d.object.subtype!==m.PROGRESSVIE_IMAGE||b.some(function(a){return a.object.subtype===V.FLOOR_PLANE}))if(d.object.subtype===V.FLOOR_PLANE){if(d=a.getPlanePosition(d))d.y+=+Math.random().toFixed(2);c.plane=d}else d.object.subtype===m.SLIDER||d.object.subtype===m.SIDE_BY_SIDE_2D||
d.object.subtype===m.VIDEO_2D?c.scene=a.getSliderPosition(d):d.object.subtype===m.IMAGE||d.object.subtype===m.VIDEO||d.object.subtype===m.SIDE_BY_SIDE?c.scene=a.get360Position(d):d.object.subtype===m.PROGRESSVIE_IMAGE?c.scene=a.get360Position(d):d.object.subtype===t.SPOT_MODEL&&(d=d.point.clone(),a.panorama.spotModel.worldToLocal(d),c.scene=d);else d=b.find(function(a){return a.object.subtype===V.SPOT_SPHERE}),c.scene=a.get360Position(d)});return this.lastTouch=c}}},{key:"onMouseDown",value:function(a){a.preventDefault();
this.userMouse.x=0<=a.clientX?a.clientX:a.touches[0].clientX;this.userMouse.y=0<=a.clientY?a.clientY:a.touches[0].clientY;this.userMouse.type="mousedown";this.isProbablyDragging=!0;this.onTap(a)}},{key:"onMouseMove",value:function(a){a.preventDefault();this.userMouse.type="mousemove";this.onTap(a)}},{key:"onMouseUp",value:function(a){this.isProbablyDragging=!1;this.userMouse.type="mouseup";var b=this.userMouse.x>=a.clientX-this.options.clickTolerance&&this.userMouse.x<=a.clientX+this.options.clickTolerance&&
this.userMouse.y>=a.clientY-this.options.clickTolerance&&this.userMouse.y<=a.clientY+this.options.clickTolerance||a.changedTouches&&this.userMouse.x>=a.changedTouches[0].clientX-this.options.clickTolerance&&this.userMouse.x<=a.changedTouches[0].clientX+this.options.clickTolerance&&this.userMouse.y>=a.changedTouches[0].clientY-this.options.clickTolerance&&this.userMouse.y<=a.changedTouches[0].clientY+this.options.clickTolerance?"click":void 0;if(!a||!a.target||a.target.classList.contains("panolens-canvas"))if(a.preventDefault(),
a=a.changedTouches&&1===a.changedTouches.length?this.onTap({clientX:a.changedTouches[0].clientX,clientY:a.changedTouches[0].clientY},b):this.onTap(a,b),this.userMouse.type="none",!a&&"click"===b){b=this.options;a=b.autoHideControlBar;var c=this.panorama;b.autoHideInfospot&&c&&c.toggleInfospotVisibility();a&&this.toggleControlBar()}}},{key:"onTap",value:function(a,b){var c=this,d=this.container.getBoundingClientRect(),g=d.top,k=this.container,l=k.clientHeight;this.raycasterPoint.x=(a.clientX-d.left)/
k.clientWidth*2-1;this.raycasterPoint.y=2*-((a.clientY-g)/l)+1;this.raycaster.setFromCamera(this.raycasterPoint,this.camera);if(this.panorama){"mousedown"!==a.type&&this.outputPosition();this.floorCursor&&this.floorCursor.enabled&&(this.lastTouch&&this.lastTouch.plane&&this.floorCursor.position.set(-this.lastTouch.plane.x,this.lastTouch.plane.y+1,this.lastTouch.plane.z),this.floorCursor.onMove());d=this.raycaster.intersectObjects(this.panorama.children,!0);g=d.filter(function(a){var b;return!(null!==
(b=a.object)&&void 0!==b&&b.passThrough)});if(0<g.length){var q=g.find(function(a){var b;return(null===(b=a.object)||void 0===b?void 0:b.type)===t.INFOSPOT});k=g.find(function(a){var b;return(null===(b=a.object)||void 0===b?void 0:b.type)===t.NADIR});q=q&&k?q.object:g[0].object}"click"!==b||q&&q.type===t.NADIR||this.panorama.dispatchEvent({type:"clickOnAviablePlaceForAddSpot"});"click"===b?(this.panorama.dispatchEvent({type:"click",intersects:d,mouseEvent:a}),q&&q.dispatchEvent&&q.dispatchEvent({type:"click",
mouseEvent:a})):(this.panorama.dispatchEvent({type:"hover",intersects:d,mouseEvent:a}),this.hoverObject&&q!==this.hoverObject&&(this.hoverObject.dispatchEvent&&(this.hoverObject.dispatchEvent({type:"hoverleave",mouseEvent:a}),this.reticle.end()),this.hoverObject=void 0),q&&this.hoverObject!==q&&(this.hoverObject=q,this.hoverObject.dispatchEvent&&(this.hoverObject.dispatchEvent({type:"hoverenter",mouseEvent:a}),this.options.autoReticleSelect&&(this.options.enableReticle||this.tempEnableReticle)&&this.reticle.start(this.onTap.bind(this,
a,"click")))));if(!q||q.type!==t.INFOSPOT&&q.subtype!==t.FLOOR_RING_INFOSPOT)this.infospot&&"click"===b&&this.hideInfospot();else{this.infospot&&this.infospot!==q&&(this.infospot.unlockHoverElement(),this.hideInfospot());this.infospot=q;if("click"===b&&this.infospot.subtype!==t.HOTSPOT&&this.infospot.subtype!==t.FLOOR_RING_INFOSPOT&&this.panorama.subtype!==m.SPIN&&this.panorama.subtype!==m.SLIDER&&this.panorama.subtype!==m.VIDEO_2D&&this.panorama.subtype!==m.SIDE_BY_SIDE_2D)return this.tweenControlCenter(new e.Vector3(-q.position.x,
q.position.y,q.position.z)),!0;"click"===b&&this.infospot.subtype===t.HOTSPOT&&q.type!==t.NADIR&&setTimeout(function(){return c.setContainerCursor(R.GRAB)},10)}this.options.autoRotate&&this.isProbablyDragging&&(clearTimeout(this.autoRotateRequestId),this.control===this.OrbitControls&&(this.OrbitControls.autoRotate=!1,this.dispatchEvent({type:"pauseAutoRotate"}),this.autoRotateRequestId=window.setTimeout(this.enableAutoRate.bind(this),this.options.autoRotateActivationDuration)))}}},{key:"hideInfospot",
value:function(){this.infospot&&(this.infospot.onHoverEnd(),this.infospot=void 0)}},{key:"toggleControlBar",value:function(){this.widget&&this.widget.dispatchEvent({type:"control-bar-toggle"})}},{key:"onKeyDown",value:function(a){this.options.output&&"none"!==this.options.output&&"Control"===a.key&&(this.outputEnabled=!0)}},{key:"onKeyUp",value:function(){this.outputEnabled=!1}},{key:"convertCameraPositionToRotation",value:function(a){var b=this.camera.clone(),c=new e.Vector3(0,0,1);a=new e.Vector3(a.x,
a.y,a.z);this.aux.quaternion.setFromUnitVectors(c,a);this.aux.matrix.makeRotationFromQuaternion(this.aux.quaternion);b.applyMatrix(this.aux.matrix);b.updateMatrixWorld();b.updateProjectionMatrix();b=new Y(b,this.container);b.update(!0);return b.getRotations()}},{key:"update",value:function(){var a,b,c,d,g,k,l=this,q=this.scene,n=this.control,r=this.OrbitControls,p=this.DeviceOrientationControls,u=this.panorama;v.update();null===(a=this.updateCallbacks)||void 0===a?void 0:a.forEach(function(a){return a()});
(null===u||void 0===u?void 0:u.subtype)===m.PROGRESSVIE_IMAGE&&setTimeout(function(){return u.refresh()},0);r.enabled&&null!==(b=q.children[1])&&void 0!==b&&b.subtype&&(null===(c=q.children[1])||void 0===c?void 0:c.subtype)!==m.SPIN&&(null===(d=q.children[1])||void 0===d?void 0:d.subtype)!==m.SLIDER&&(null===(g=q.children[1])||void 0===g?void 0:g.subtype)!==m.VIDEO_2D&&(null===(k=q.children[1])||void 0===k?void 0:k.subtype)!==m.SIDE_BY_SIDE_2D&&r.update();n===p&&p.update();var w=new e.Vector3,x=function(a){var b=
l.hoverObject===a;(a.type===t.INFOSPOT||a.subtype===t.FLOOR_RING_INFOSPOT)&&a.element&&(b||a.showTitleHotspotInfospot||"none"!==a.element.style.display||a.element.left&&"none"!==a.element.left.style.display||a.element.right&&"none"!==a.element.right.style.display)&&(l.checkSpriteInViewport(a)?(b=l.getScreenVector(a.getWorldPosition(w)),a.translateElement(b.x,b.y),a.showTitleHotspotInfospot&&a.handleAlwaysShowTitle(!0)):(a.onDismiss(!1),a.handleAlwaysShowTitle(!1)))};this.camera.updateMatrixWorld();
this.camera.updateProjectionMatrix();q.traverse(function(a){x(a);a.subtype===m.SPIN&&a.spotModel.traverse(function(a){x(a);var b=new e.Vector3;a.getWorldPosition(b);if(-2>b.z&&a.hide)a.hide();else if(-2<b.z){var c;a.lookAt(0,0,1);null===(c=a.parent)||void 0===c?void 0:c.updateMatrixWorld();a.updateMatrixWorld();l.camera.updateProjectionMatrix();l.camera.updateMatrixWorld();!a.visible&&a.shouldRender&&a.show()}})})}},{key:"renderEffect",value:function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:
1)?(this.renderer.setRenderTarget(this.fbo),this.renderer.clear(),this.effect.render(this.scene,this.camera,this.panorama,!0,this.fbo,{scissorX:this.scissorX}),this.mode!=z.SIDE_BY_SIDE&&this.effect.render(this.sceneReticle,this.camera,this.panorama,!0,this.fbo)):(this.renderer.setRenderTarget(null),this.renderer.clear(),this.effect.render(this.scene,this.camera,this.panorama,!1,null,{scissorX:this.scissorX}),this.mode!=z.SIDE_BY_SIDE&&this.effect.render(this.sceneReticle,this.camera,this.panorama,
!1,null,{scissorX:this.scissorX}));this.renderer.clearDepth()}},{key:"renderNormal",value:function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:1)?this.renderer.setRenderTarget(this.fbo):this.renderer.setRenderTarget(null);this.renderer.clear();this.renderer.render(this.scene,this.camera);this.renderer.render(this.sceneReticle,this.camera);this.renderer.clearDepth()}},{key:"render",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0;this.update();this.panorama&&
(this.mode===z.NORMAL?this.renderNormal(a):this.renderEffect(a))}},{key:"animate",value:function(){this.onChange()}},{key:"onChange",value:function(){this.update();this.render()}},{key:"registerMouseAndTouchEvents",value:function(){var a={passive:!1};this.container.addEventListener("mousedown",this.handlerMouseDown,a);this.container.addEventListener("mousemove",this.handlerMouseMove,a);this.container.addEventListener("mouseup",this.handlerMouseUp,a);this.container.addEventListener("touchstart",this.handlerMouseDown,
a);this.container.addEventListener("touchend",this.handlerMouseUp,a)}},{key:"unregisterMouseAndTouchEvents",value:function(){var a={passive:!1};this.container.removeEventListener("mousedown",this.handlerMouseDown,a);this.container.removeEventListener("mousemove",this.handlerMouseMove,a);this.container.removeEventListener("mouseup",this.handlerMouseUp,a);this.container.removeEventListener("touchstart",this.handlerMouseDown,a);this.container.removeEventListener("touchend",this.handlerMouseUp,a)}},{key:"registerReticleEvent",
value:function(){this.addUpdateCallback(this.handlerTap)}},{key:"unregisterReticleEvent",value:function(){this.removeUpdateCallback(this.handlerTap)}},{key:"updateReticleEvent",value:function(){var a=this.container.clientWidth/2+this.container.offsetLeft,b=this.container.clientHeight/2;this.removeUpdateCallback(this.handlerTap);this.handlerTap=this.onTap.bind(this,{clientX:a,clientY:b});this.addUpdateCallback(this.handlerTap)}},{key:"registerEventListeners",value:function(){window.addEventListener("resize",
this.handlerWindowResize,!0);window.addEventListener("keydown",this.handlerKeyDown,!0);window.addEventListener("keyup",this.handlerKeyUp,!0)}},{key:"unregisterEventListeners",value:function(){window.removeEventListener("resize",this.handlerWindowResize,!0);window.removeEventListener("keydown",this.handlerKeyDown,!0);window.removeEventListener("keyup",this.handlerKeyUp,!0)}},{key:"dispose",value:function(){function a(b){for(var c=b.children.length-1;0<=c;c--)a(b.children[c]),b.remove(b.children[c]);
b.type===m.PANORAMA||b.type===t.INFOSPOT||b.subtype===t.FLOOR_RING_INFOSPOT?b.dispose():b.dispatchEvent&&b.dispatchEvent("dispose")}this.disableAutoRate();this.tweenLeftAnimation.stop();this.tweenUpAnimation.stop();this.unregisterEventListeners();this.unregisterMouseAndTouchEvents();this.fbo.dispose();this.reticleFbo.dispose();this.DeviceOrientationControls.dispose();this.OrbitControls.dispose();this.aux&&this.aux.control&&this.aux.control.dispose();this.aux=null;a(this.scene);this.DragControls&&
this.DragControls.dispose&&this.DragControls.dispose();this.OrbitControls&&this.OrbitControls.dispose&&this.OrbitControls.dispose();this.widget&&(this.widget.dispose(),this.widget=null);this.updateCallbacks=null;e.Cache&&e.Cache.enabled&&e.Cache.clear();this.floorCursor&&(this.floorCursor=null)}},{key:"removeWidget",value:function(){this.widget&&(this.widget.dispose(),this.widget=null)}},{key:"destroy",value:function(){this.dispose();this.render();window.cancelAnimationFrame(this.requestAnimationId)}},
{key:"onPanoramaDispose",value:function(a){this.scene.traverse(function(b){b.type===m.PANORAMA&&(b.linkedSpots=b.linkedSpots.map(function(b){return b.toPanorama!==a?b:b.dispose()}).filter(function(a){return!!a}))});a===this.panorama&&(this.panorama=null)}},{key:"loadAsyncRequest",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},c=new window.XMLHttpRequest;c.onloadend=function(a){b(a)};c.open("GET",a,!0);c.send(null)}},{key:"appendControlItem",value:function(a){var b=
this.widget.createCustomItem(a);"video"===a.group?this.widget.videoElement.append(b):this.widget.barElement.append(b);return b}},{key:"clearAllCache",value:function(){e.Cache.clear()}}]);return d}(e.EventDispatcher),Kb=function(g){function d(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};C(this,d);var b=k.call(this);b.options=u({container:b.setupContainer(a.container),clickTolerance:10,isTourViewerPage:!1},a);b.container=b.options.container;b.renderer=b.setupRenderer();b.container.append(b.renderer.domElement);
b.scene=new e.Scene;b.scene.background=new e.Color(1316891);b.camera=b.setupCamera(b.container.clientWidth/b.container.clientHeight);b.camera.updateProjectionMatrix();b.control=b.setupControls();b.dollspot=null;b.selectedDollspot=null;b.dollhouse=null;b.panorama=null;b.requestAnimationId=null;b.DOLL_VIEWER_CONTAINER_ID="floorpano";b.userMouse=new e.Vector2;b.rightmousemove=!1;b.raycaster=new e.Raycaster;b.raycasterPoint=new e.Vector2;b.handlerMouseDown=b.onMouseDown.bind(r(b));b.handlerMouseMove=
b.onMouseMove.bind(r(b));b.handlerMouseUp=b.onMouseUp.bind(r(b));b.handlerMouseWheel=b.onMouseWheel.bind(r(b));b.handlerContextmenu=b.onContextmenu.bind(r(b));b.handlerWindowResize=b.onWindowResize.bind(r(b));b.registerEventListeners();b.animate();return b}D(d,g);var k=E(d);F(d,[{key:"setupCamera",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new e.PerspectiveCamera(20,a,.1,1E4);b.updateWorldMatrix=function(a,b){e.Object3D.prototype.updateWorldMatrix.call(this,a,b)};
return b}},{key:"setupRenderer",value:function(){var a=window.devicePixelRatio,b=!0;1<a&&(b=!1);b=new e.WebGLRenderer({antialias:b,powerPreference:"high-performance"});b.setPixelRatio(a);b.setSize(this.container.clientWidth,this.container.clientHeight);b.autoClear=!1;b.setClearColor(2764856,1);b.domElement.classList.add("panolens-canvas");b.domElement.style.display="block";return b}},{key:"setupContainer",value:function(a){var b=a||document.createElement("div"),c=b.clientWidth||"100%",d=b.clientHeight||
"100%";b.classList.add("panolens-container");b.style.width=c;b.style.height=d;b._width=b.clientWidth;b._height=b.clientHeight;b.style.backgroundColor="#2A3038";a||document.body.appendChild(b);return b}},{key:"setControlCenter",value:function(a){a=(new e.Box3).setFromObject(a);this.orbitControl.target=a.getCenter(new e.Vector3);this.orbitControl.update()}},{key:"setupControls",value:function(){var a=new Y(this.camera,this.container,{panSpeed:3});a.screenSpacePanning=!0;a.noPan=!1;a.enableDamping=!1;
a.enableZoom=!0;a.rotateSpeed=10;a.minDistance=.1;a.maxDistance=200;this.orbitControl=a;a.update();return a}},{key:"add",value:function(a){var b=this;a instanceof Ha&&(a.dispatchEvent({type:"panolens-container",container:this.container}),a.addEventListener("ready",function(){b.dollhouse=a;b.panorama=a;b.scene.add(b.dollhouse);b.setControlCenter(b.dollhouse);if(b.options.camera)b.camera.position.set(b.options.camera.position.x,b.options.camera.position.y,b.options.camera.position.z),b.orbitControl.target=
new e.Vector3(b.options.camera.target.x,b.options.camera.target.y,b.options.camera.target.z);else{var c=(new e.Box3).setFromObject(a);b.camera.position.set(c.max.x+2*(c.max.x-c.min.x),c.max.y+2*(c.max.y-c.min.y),c.max.z+2*(c.max.z-c.min.z));b.orbitControl.target=c.getCenter(new e.Vector3)}b.orbitControl.update();b.camera.updateProjectionMatrix()}),a.addEventListener("dollhouse-select-dollspot",function(a){b.dollspot=a.dollspot}))}},{key:"outputPosition",value:function(){var a=this.raycaster.intersectObject(this.panorama,
!0);return 0<a.length?(a=a[0].point.clone(),0===a.length()?void 0:a):null}},{key:"onTap",value:function(a){var b=this.container.getBoundingClientRect(),c=b.top;this.raycasterPoint.x=(a.clientX-b.left)/this.container.clientWidth*2-1;this.raycasterPoint.y=2*-((a.clientY-c)/this.container.clientHeight)+1;this.raycaster.setFromCamera(this.raycasterPoint,this.camera)}},{key:"getCameraPosition",value:function(){return{position:this.camera.position,target:this.orbitControl.target}}},{key:"selectDollspot",
value:function(){this.dollspot.select();this.selectedDollspot=this.dollspot;this.orbitControl.enabled=!1}},{key:"unselectDollspot",value:function(){var a;null===(a=this.dollspot)||void 0===a?void 0:a.unselect();this.selectedDollspot=this.dollspot=null;this.orbitControl.enabled=!0}},{key:"onMouseDown",value:function(a){this.userMouse.x=0<=a.clientX?a.clientX:a.touches[0].clientX;this.userMouse.y=0<=a.clientY?a.clientY:a.touches[0].clientY;this.userMouse.type="mousedown";this.onTap(a)}},{key:"onContextmenu",
value:function(a){a.preventDefault()}},{key:"onMouseMove",value:function(a){this.rightmousemove&&a.preventDefault();this.userMouse.type="mousemove";var b=this.outputPosition();this.dollspot&&b&&!this.options.isTourViewerPage&&(this.orbitControl.enabled=!1,this.dollspot.position.set(b.x,b.y,b.z));this.onTap(a)}},{key:"onMouseUp",value:function(a){this.userMouse.type="mouseup";this.rightmousemove=!1;a.preventDefault();2===a.button&&this.setOrbitTargetToScreenCenter();var b=0===a.button&&(this.userMouse.x>=
a.clientX-this.options.clickTolerance&&this.userMouse.x<=a.clientX+this.options.clickTolerance&&this.userMouse.y>=a.clientY-this.options.clickTolerance&&this.userMouse.y<=a.clientY+this.options.clickTolerance||a.changedTouches&&this.userMouse.x>=a.changedTouches[0].clientX-this.options.clickTolerance&&this.userMouse.x<=a.changedTouches[0].clientX+this.options.clickTolerance&&this.userMouse.y>=a.changedTouches[0].clientY-this.options.clickTolerance&&this.userMouse.y<=a.changedTouches[0].clientY+this.options.clickTolerance)?
"click":void 0;"click"===b&&this.dollspot&&(this.selectDollspot(),this.dispatchEvent({type:"click-on-dollspot",shortId:this.dollspot.shortId}));if("click"===b&&!this.dollspot){this.unselectDollspot();var c=this.outputPosition();c&&this.dispatchEvent({type:"create-new-dollspot",coords:c})}"click"!==b&&this.dollspot&&this.changeDollspotPosition(this.dollspot);this.onTap(a,b);this.userMouse.type="none";this.dollspot=null;this.orbitControl.enabled=!0}},{key:"onMouseWheel",value:function(a){a.preventDefault();
var b=this.camera.position.x-this.orbitControl.target.x,c=this.camera.position.y-this.orbitControl.target.y,d=this.camera.position.z-this.orbitControl.target.z;b*=(5E3+a.deltaY)/5E3;c*=(5E3+a.deltaY)/5E3;d*=(5E3+a.deltaY)/5E3;this.camera.position.x=b+this.orbitControl.target.x;this.camera.position.y=c+this.orbitControl.target.y;this.camera.position.z=d+this.orbitControl.target.z}},{key:"setOrbitTargetToScreenCenter",value:function(){var a,b=new e.Raycaster;b.setFromCamera(new e.Vector2(0,0),this.camera);
if(b=null===(a=b.intersectObject(this.panorama,!0)[0])||void 0===a?void 0:a.point.clone())this.orbitControl.target=b,this.orbitControl.update()}},{key:"changeDollspotPosition",value:function(a){this.dispatchEvent({type:"change-dollspot-position",shortId:a.shortId,coords:this.outputPosition()})}},{key:"onWindowResize",value:function(a,b){var c=this.container.classList.contains("panolens-container")||this.container.isFullscreen,d=null;d=document.getElementById(this.DOLL_VIEWER_CONTAINER_ID);if(void 0!==
a&&void 0!==b){var e=a;var g=b;this.container._width=a;this.container._height=b}else d?(c=d.clientHeight,e=d.clientWidth,g=c):(d=la?Math.min(document.documentElement.clientWidth,window.innerWidth||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0),a=la?Math.min(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientHeight,window.innerHeight||0),e=c?d:this.container.clientWidth,g=c?a:this.container.clientHeight),this.container._width=
e,this.container._height=g;this.camera.aspect=e/g;this.camera.updateProjectionMatrix();this.renderer.setSize(e,g);this.panorama&&this.panorama.subtype===m.SLIDER&&(this.panorama.position.set(0,0,0),this.panorama.lookAt(this.camera),this.fitObjectToScreen(this.panorama));this.dispatchEvent({type:"window-resize",width:e,height:g});this.scene.traverse(function(a){a.dispatchEvent&&a.dispatchEvent({type:"window-resize",width:e,height:g})})}},{key:"getScreenVector",value:function(a){a=a.clone();var b=this.container.clientWidth/
2,c=this.container.clientHeight/2;a.project(this.camera);a.x=a.x*b+b;a.y=-(a.y*c)+c;a.z=0;return a}},{key:"registerEventListeners",value:function(){var a={passive:!1};this.container.addEventListener("mousedown",this.handlerMouseDown,a);this.container.addEventListener("mousemove",this.handlerMouseMove,a);this.container.addEventListener("mouseup",this.handlerMouseUp,a);this.container.addEventListener("wheel",this.handlerMouseWheel,a);this.container.addEventListener("contextmenu",this.handlerContextmenu,
a);window.addEventListener("resize",this.handlerWindowResize,!0)}},{key:"unRegisterEventListeners",value:function(){this.container.removeEventListener("mousedown",this.handlerMouseDown,!1);this.container.removeEventListener("mousemove",this.handlerMouseMove,!1);this.container.removeEventListener("mouseup",this.handlerMouseUp,!1);this.container.removeEventListener("wheel",this.handlerMouseWheel,!1);this.container.removeEventListener("contextmenu",this.handlerContextmenu,!1);window.removeEventListener("resize",
this.handlerWindowResize,!0)}},{key:"animate",value:function(){this.requestAnimationId=window.requestAnimationFrame(this.animate.bind(this));this.update();this.render()}},{key:"update",value:function(){var a=this;this.orbitControl.update();var b=new e.Vector3;this.scene.traverse(function(c){if(c.element&&c instanceof aa){var d=a.getScreenVector(c.getWorldPosition(b));c.translateElement(d.x,d.y)}})}},{key:"render",value:function(){this.renderer.render(this.scene,this.camera)}},{key:"destroy",value:function(){this.unRegisterEventListeners();
this.render();window.cancelAnimationFrame(this.requestAnimationId)}}]);return d}(e.EventDispatcher);"134"!=e.REVISION&&console.warn("three.js version is not matched. Please consider use the target revision ".concat("134"));window.TWEEN=v;q.BACKGROUNDS=T;q.BasicPanorama=vb;q.BulkImageLoader=Ga;q.BulkTextureLoader=ja;q.CONTROLS=N;q.CURSORS=R;q.CURSOR_TYPES=sa;q.CubeTextureLoader=Ia;q.DataImage=L;q.DollViewer=Kb;q.Dollhouse=Ha;q.Dollspot=aa;q.EXTRA_GEOMETRY=V;q.EmptyPanorama=ub;q.FLOOR_PLANE_POSITION=
Z;q.FloorCursor=La;q.FloorPlane=O;q.FloorRingInfospot=gb;q.ID_FOR_CUSTOM_BUTTON=ta;q.ImageLittlePlanet=Fb;q.ImageLoader=ia;q.ImagePanorama=ua;q.Infospot=Ma;q.MODES=z;q.Nadir=hb;q.PANORAMA_TYPES=m;q.Panorama=S;q.ProgressiveImagePanorama=lb;q.REVISION="11";q.Reticle=Ka;q.SPOT_TYPES=t;q.STEREOFORMAT=X;q.SideBySidePanorama=Sa;q.SliderPanorama=wb;q.SpinPanorama=Hb;q.THREE_REVISION="134";q.THREE_VERSION=bb;q.TextureLoader=W;q.VERSION="0.11.0";q.Video2dPanorama=xb;q.VideoPanorama=ca;q.Viewer=Jb;q.ViewerManager=
Db;q.Widget=Ja;Object.defineProperty(q,"__esModule",{value:!0})});
